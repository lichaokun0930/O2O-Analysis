# 场景识别能力对比与升级建议

## 📊 当前状态总结

### ✅ 正在使用: `scene_inference.py` (简单版)

**识别方式**: 固定关键词匹配
```python
# 第1层: 商品名称关键词 (硬编码)
SCENE_KEYWORDS = {
    '早餐': ['豆浆', '油条', '包子'...],  # 固定的10个关键词
    '午餐': ['便当', '盒饭', '套餐'...],  # 固定的7个关键词
    # ... 仅9个场景,共约70个关键词
}

# 第2层: 商品分类映射 (硬编码)
CATEGORY_SCENE_MAP = {
    '休闲食品': '休闲零食',  # 仅10个分类映射
    '饮料': '下午茶',
    # ...
}

# 第3层: 时段后备 (兜底)
所有时段 → '日常购物'

# 第4层: 默认值
return '社交娱乐'
```

**特点**:
- ❌ **无智能学习**: 只能识别预定义的70个关键词
- ❌ **单一维度**: 只有"基础场景"一个维度
- ❌ **无驱动分析**: 不知道用户为什么购买
- ❌ **无决策分析**: 不知道用户如何做决策
- ✅ **速度快**: 简单匹配,性能好
- ✅ **易维护**: 代码简单

**覆盖率估算**: 约20-30% (大量商品会被分类为"日常购物"或"社交娱乐")

---

### 🚀 可用但未启用: `商品场景智能打标引擎.py` (高级版)

**识别方式**: 多维度智能分析

```python
class ProductSceneTagger:
    def tag_product_scenes(self, df):
        # 1. 基础场景 (10个)
        df['场景'] = 基础时段场景
        
        # 2. 季节场景 (4个)
        df['季节场景'] = 春/夏/秋/冬
        
        # 3. 节假日场景 (10+个)
        df['节假日场景'] = 春节/中秋/双11/618/考试季/减肥季...
        
        # 4. 天气场景 (5个)
        df['天气场景'] = 炎热/寒冷/雨天/雾霾/晴朗
        
        # 5. 特殊场景 (8个)
        df['特殊场景'] = 深夜场景/周末场景/居家场景...
        
        # 6. 购买驱动分析 (8类)
        df['购买驱动'] = 价格/场景/品质/便利/健康/社交/尝鲜/囤货
        
        # 7. 决策因素分析
        df['决策因素'] = 分析用户决策路径
        
        return df
```

**特点**:
- ✅ **多维度分析**: 7个维度,50+个场景类型
- ✅ **智能推断**: 基于时间、商品名、分类综合判断
- ✅ **驱动分析**: 知道用户为什么买(8种购买驱动)
- ✅ **决策分析**: 知道用户怎么决策
- ✅ **营销建议**: 每种驱动都有对应营销策略
- ⚠️ **计算复杂**: 7层分析,性能开销大
- ⚠️ **字段增多**: 会新增7个字段

**覆盖率估算**: 90%+ (几乎所有商品都能精准分类)

---

## 🆚 对比示例

### 示例商品: "冰淇淋"

**简单版识别结果**:
```python
场景: '下午茶'  # 仅匹配关键词
```

**高级版识别结果**:
```python
场景: '下午茶'
季节场景: '夏季场景'  # 6-8月
节假日场景: '日常'
天气场景: '炎热天气'
特殊场景: '休闲放松'
购买驱动: '场景驱动'  # 天热想吃冰
决策因素: '即时需求,快速决策'
```

### 示例商品: "月饼礼盒"

**简单版识别结果**:
```python
场景: '日常购物'  # 未匹配到关键词
```

**高级版识别结果**:
```python
场景: '社交娱乐'  # 匹配'礼盒'
季节场景: '秋季场景'
节假日场景: '中秋场景'  # 识别节日
天气场景: '常规天气'
特殊场景: '送礼场景'
购买驱动: '社交驱动'  # 送礼需求
决策因素: '品牌导向,重包装,送礼属性'
```

---

## 💡 升级建议

### 方案A: 保持现状 (推荐给简单应用)
**适用**: 对场景精度要求不高,只需基础分类

**优点**:
- 性能好,速度快
- 维护简单
- 已稳定运行

**缺点**:
- 识别精度低 (20-30%覆盖)
- 无营销洞察
- 无法支持高级分析

---

### 方案B: 完全替换为高级引擎 (推荐给深度应用)
**适用**: 需要精准场景识别和营销分析

**实施步骤**:
1. 修改 `scene_inference.py`:
```python
from 商品场景智能打标引擎 import ProductSceneTagger

def add_scene_and_timeslot_fields(df):
    # 添加时段
    df['小时'] = df[date_col].dt.hour
    df['时段'] = df['小时'].apply(classify_timeslot)
    
    # 使用智能打标引擎
    tagger = ProductSceneTagger()
    df = tagger.tag_product_scenes(df)
    
    return df
```

2. 更新数据表显示 (增加新字段)

**优点**:
- 90%+识别覆盖率
- 深度营销洞察
- 支持高级分析 (购买驱动/决策分析)

**缺点**:
- 计算量增加 (约2-3倍)
- 需要更新界面 (新增字段)
- 需要测试兼容性

---

### 方案C: 混合模式 (推荐给渐进升级)
**适用**: 保留基础功能,选择性启用高级功能

**实施方案**:
```python
def add_scene_and_timeslot_fields(df, advanced_mode=False):
    """
    参数:
        advanced_mode: 是否启用高级场景分析
    """
    # 基础分析 (总是执行)
    df['小时'] = df[date_col].dt.hour
    df['时段'] = df['小时'].apply(classify_timeslot)
    df['场景'] = df.apply(infer_scene, axis=1)
    
    # 高级分析 (可选)
    if advanced_mode:
        tagger = ProductSceneTagger()
        df = tagger.tag_product_scenes(df)
    
    return df
```

**Tab配置**:
- Tab 1-4: 使用基础场景 (快速)
- Tab 5扩展: 使用高级场景 (深度分析)

**优点**:
- 兼容现有功能
- 按需启用高级功能
- 性能可控

**缺点**:
- 维护两套逻辑
- 数据一致性需要注意

---

## 🎯 具体实施建议

### 立即可做:
1. **在"消费场景分析"Tab中添加说明**: ✅ 已完成
   - 显示当前使用的关键词列表
   - 说明识别优先级

2. **测试高级引擎**:
```python
# 创建测试脚本
from 商品场景智能打标引擎 import ProductSceneTagger
tagger = ProductSceneTagger()
test_df = tagger.tag_product_scenes(GLOBAL_DATA.head(100))
print(test_df[['商品名称', '场景', '季节场景', '购买驱动']])
```

3. **对比分析**:
   - 统计两种方式的场景分布差异
   - 评估高级引擎的计算性能
   - 确认是否值得升级

### 中期规划:
1. **在Tab 5添加"高级场景分析"子Tab**:
   - 展示多维度场景分布
   - 展示购买驱动分析
   - 展示决策因素分析

2. **逐步扩展关键词库**:
   - 基于实际商品数据补充关键词
   - 建立商品-场景映射表

### 长期优化:
1. **机器学习增强**:
   - 基于历史数据训练场景识别模型
   - 自动发现新场景类型

2. **用户行为建模**:
   - 结合用户购买历史
   - 个性化场景推荐

---

## ❓ 您的选择

**问题1**: 您希望采用哪个方案?
- A. 保持现状 (简单快速)
- B. 完全替换 (深度分析)
- C. 混合模式 (渐进升级)

**问题2**: 当前的70个关键词是否够用?
- 如果不够,我可以帮您扩展关键词库

**问题3**: 是否需要购买驱动和决策分析?
- 这对营销策略制定很有价值

---

## 📝 总结

**当前**: 使用简单关键词匹配,70个关键词,识别率20-30%

**可升级**: 使用智能打标引擎,7维度分析,识别率90%+

**建议**: 先测试高级引擎效果,再决定是否全面升级
