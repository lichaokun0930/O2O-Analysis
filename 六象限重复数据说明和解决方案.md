# 六象限重复数据说明和解决方案

## 问题现象

在商品健康分析的六象限表格中，同一个商品名称可能出现多次。

## 原因分析

这不是bug，而是系统的设计逻辑：

### 当前分组逻辑（V6.1）

系统使用 **店内码 + 商品名称 + 渠道** 三维分组，原因是：

1. **店内码区分规格**：
   - 同一商品名称可能有不同规格
   - 例如："可乐 330ml" vs "可乐 500ml"
   - 它们有不同的店内码，应该分开统计

2. **渠道区分价格**：
   - 同一商品在不同渠道可能有不同价格
   - 例如：店内码52183在美团原价12.8元，饿了么原价9.8元
   - 不同渠道的定价策略不同，应该分开分析

### 示例

```
商品名称: 可口可乐
├─ 店内码001 + 美团 → 330ml规格，¥3.5
├─ 店内码001 + 饿了么 → 330ml规格，¥3.0
├─ 店内码002 + 美团 → 500ml规格，¥5.0
└─ 店内码002 + 饿了么 → 500ml规格，¥4.5
```

在表格中会显示4行，每行代表一个独立的"商品-渠道"组合。

## 业务价值

这种设计有其合理性：

1. **精准定价**：不同渠道的价格策略不同，需要分开优化
2. **规格区分**：避免不同规格的商品被混淆
3. **渠道对比**：可以看到同一商品在不同渠道的表现差异

## 解决方案

如果你希望表格中每个商品名称只出现一次，有以下几种方案：

### 方案1：只显示主渠道（推荐）

修改分组逻辑，对于同一商品名称，只保留销量最大的渠道。

**优点**：
- 表格简洁，每个商品只出现一次
- 保留最重要的渠道数据

**缺点**：
- 丢失其他渠道的数据
- 无法进行跨渠道对比

### 方案2：合并渠道数据

将同一商品在不同渠道的数据合并，显示总计。

**优点**：
- 表格简洁
- 数据完整（总销量、总利润）

**缺点**：
- 价格字段难以处理（不同渠道价格不同）
- 丢失渠道维度的分析价值

### 方案3：添加筛选器

保持现有逻辑，但添加"渠道筛选器"，让用户选择查看哪个渠道。

**优点**：
- 保留所有数据
- 用户可以按需查看

**缺点**：
- 需要额外的交互步骤

### 方案4：分组显示

在表格中添加商品名称的分组行，子行显示不同渠道。

**优点**：
- 数据完整
- 层次清晰

**缺点**：
- 实现复杂
- 表格可能过长

## 推荐方案

**方案1（只显示主渠道）+ 方案3（添加筛选器）**

- 默认显示主渠道（销量最大的渠道）
- 添加"显示所有渠道"开关
- 用户可以选择是否查看跨渠道数据

## 实施步骤

如果你确认要修改，我可以：

1. 修改`calculate_enhanced_product_scores`函数
2. 添加"主渠道优先"逻辑
3. 添加"显示所有渠道"开关
4. 更新表格显示逻辑

请告诉我你希望采用哪个方案，我会立即实施。

## 临时解决方法

如果你现在就想看简化的数据，可以：

1. 在表格上方的筛选器中选择单个渠道
2. 或者导出Excel后，使用数据透视表合并同名商品
