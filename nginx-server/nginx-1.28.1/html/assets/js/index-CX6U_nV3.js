const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/DataManagement-B5gBlpRv.js","assets/js/framework-DfnVWwpF.js","assets/js/vendor-DUbYPDw3.js","assets/js/utils-CB2_sajW.js","assets/css/vendor-xiMy4gMA.css","assets/js/charts-bindingecharts-DvSHEz9I.js","assets/js/StoreComparisonView-zvBTf09c.js","assets/js/ProfitChart-B36zanQP.js","assets/js/CostEfficiencyChart-ijZ2r8gP.js","assets/js/CategoryAnalysisChart-DzroCrKO.js","assets/js/MarketingCostChart-BeFf4d6u.js","assets/js/DeliveryHeatmap-DZRC1M8P.js","assets/js/MarketingTrendChart-BobABcLk.js","assets/js/ProfitSimulator-CDW3ji-D.js","assets/js/DataTable-CsLDQxOM.js","assets/js/CategoryTrendChart-DUhPJXnP.js","assets/js/TopProductsChart-DqwfP41s.js","assets/js/CategoryHealthTable-EILpD1c9.js","assets/js/DistanceAnalysisChart-WO_BHQhL.js","assets/js/Skeleton-BogUu1F4.js"])))=>i.map(i=>d[i]);
import{r as n,j as e,a as ye,u as st,L as rt,R as G,b as at,c as ne,d as nt,B as ot}from"./framework-DfnVWwpF.js";import{H as ie,I as pe,f as he,J as _e,t as lt,s as it,K as ct}from"./utils-CB2_sajW.js";import{bs as qe,bt as Ne,bu as dt,bv as ge,bw as De,bx as ut,by as ft,bz as Ce,bA as We,bB as xt,bC as pt,bD as ht,bE as Ge,bF as mt,bG as gt,bH as bt,bI as yt,bJ as vt,bK as wt,bL as jt,bM as Nt,bN as St,bO as Ct,bP as He,bQ as kt,V as de,bR as Se,bS as _t,bT as Ye,bU as Dt,bV as Rt,bW as Et,bX as zt,bY as Mt,bZ as Lt,b_ as Re,b$ as At,c0 as Ee,c1 as Tt,c2 as ze,c3 as Ke}from"./vendor-DUbYPDw3.js";import{i as Me,r as Le}from"./charts-bindingecharts-DvSHEz9I.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function a(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=a(r);fetch(r.href,o)}})();const Je="/api/v1",ke=ie.create({baseURL:Je,timeout:12e4,headers:{"Content-Type":"application/json"}});ke.interceptors.request.use(t=>(t.headers["X-Request-Time"]=Date.now().toString(),t),t=>Promise.reject(t));const ue=new Map;let ve=!1;async function $t(t){const l=t.config;if(!l)return Promise.reject(t);const a=parseInt(t.response?.headers["retry-after"]||"1",10),s=`${l.method}:${l.url}:${JSON.stringify(l.params)}`;return console.warn(`‚ö†Ô∏è 429 ÈôêÊµÅ: ${l.url}, Á≠âÂæÖ ${a}s ÂêéÈáçËØï`),new Promise((r,o)=>{ue.has(s)||ue.set(s,[]),ue.get(s).push({resolve:r,reject:o,config:l}),!ve&&(ve=!0,setTimeout(async()=>{const i=ue.get(s)||[];if(ue.delete(s),ve=!1,i.length!==0)try{const c=await ke.request(i[0].config);i.forEach(({resolve:d})=>d(c))}catch(c){i.forEach(({reject:d})=>d(c))}},a*1e3))})}ke.interceptors.response.use(t=>{const l=t.config.headers["X-Request-Time"];if(l){const a=Date.now()-parseInt(l,10);a>3e3&&console.warn(`üê¢ ÊÖ¢ËØ∑Ê±Ç: ${t.config.url}, ËÄóÊó∂ ${a}ms`)}return t},async t=>{const l=t.response?.status;return l===429?$t(t):(l&&l>=500&&console.error(`üî• ÊúçÂä°Âô®ÈîôËØØ [${l}]: ${t.config?.url}`,t.message),t.code==="ECONNABORTED"&&console.error(`‚è±Ô∏è ËØ∑Ê±ÇË∂ÖÊó∂: ${t.config?.url}`),Promise.reject(t))});const R=ie.create({baseURL:Je,timeout:12e4,headers:{"Content-Type":"application/json"}});R.interceptors.response.use(t=>t.data,async t=>{if(t.response?.status===429){const l=parseInt(t.response.headers["retry-after"]||"1",10);if(console.warn(`‚ö†Ô∏è 429 ÈôêÊµÅ: ${t.config?.url}, Á≠âÂæÖ ${l}s`),await new Promise(a=>setTimeout(a,l*1e3)),t.config)return R.request(t.config)}return console.error("API Error:",t.message,t.config?.url),Promise.reject(t)});const Ae={getStats(){return R.get("/data/stats")},getStores(){return R.get("/data/stores")},loadFromDatabase(t){return R.post("/data/database/load",null,{params:t})},uploadOrders(t,l){const a=new FormData;a.append("file",t);const s=new URLSearchParams;return l?.mode&&s.append("mode",l.mode),fetch(`/api/v1/data/upload/orders?${s.toString()}`,{method:"POST",body:a}).then(async r=>{const o=await r.json();if(!r.ok)throw new Error(o.detail||"‰∏ä‰º†Â§±Ë¥•");return o})},getStoreStats(t){return R.get(`/data/store/${encodeURIComponent(t)}/stats`)},deleteStoreData(t){return R.delete(`/data/store/${encodeURIComponent(t)}`)},clearCache(t){return R.post("/data/clear-cache",{level:t})},optimizeDatabase(){return R.post("/data/database/optimize")}},ae={getOverview(t){return R.get("/orders/overview",{params:t})},getComparison(t){return R.get("/orders/comparison",{params:t})},getChannelStats(t){return R.get("/orders/channels",{params:t})},getCostStructure(t){return R.get("/orders/cost-structure",{params:t})},getTrend(t){return R.get("/orders/trend",{params:t})},getStores(){return R.get("/orders/stores")},getChannels(t){return R.get("/orders/channel-list",{params:t})},getPriceDistribution(t){return R.get("/orders/price-distribution",{params:t})},getProfitDistribution(t){return R.get("/orders/profit-distribution",{params:t})},getChannelComparison(t){return R.get("/orders/channel-comparison",{params:t})},getAnomalyDetection(t){return R.get("/orders/anomaly-detection",{params:t})},getDateRange(t){return R.get("/orders/date-range",{params:t})},getCategoryHourlyTrend(t){return R.get("/orders/category-hourly-trend",{params:t})},getTopProductsByDate(t){return R.get("/orders/top-products-by-date",{params:t})},getHourlyProfit(t){return R.get("/orders/hourly-profit",{params:t})},getDistanceAnalysis(t){return R.get("/orders/distance-analysis",{params:t})},getDeliveryRadar(t){return R.get("/orders/delivery-radar",{params:t})},getMarketingStructure(t){return R.get("/orders/marketing-structure",{params:t})},getMarketingTrend(t){return R.get("/orders/marketing-trend",{params:t})}},Xe=n.createContext(null),It=(t,l)=>{const a=l||new Date,s=r=>r.toISOString().split("T")[0];switch(t){case"today":return{start:s(a),end:s(a)};case"yesterday":{const r=new Date(a);return r.setDate(a.getDate()-1),{start:s(r),end:s(r)}}case"7days":{const r=new Date(a);return r.setDate(a.getDate()-6),{start:s(r),end:s(a)}}case"30days":{const r=new Date(a);return r.setDate(a.getDate()-29),{start:s(r),end:s(a)}}case"thisWeek":{const r=new Date(a);return r.setDate(a.getDate()-a.getDay()),{start:s(r),end:s(a)}}case"thisMonth":{const r=new Date(a.getFullYear(),a.getMonth(),1);return{start:s(r),end:s(a)}}case"all":return{start:"",end:""};default:return{start:s(a),end:s(a)}}};function Ot(t,l){const a=n.useRef();return n.useCallback((...s)=>{a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{t(...s)},l)},[t,l])}const Pt=({children:t})=>{const[l,a]=n.useState([]),[s,r]=n.useState(""),[o,i]=n.useState(!1),[c,d]=n.useState("all"),[g,S]=n.useState([]),[h,y]=n.useState(!1),[x,A]=n.useState({type:"all",start:"",end:""}),[C,f]=n.useState(null),[v,P]=n.useState(!1),[U,V]=n.useState(null),[j,H]=n.useState(!1),[X,M]=n.useState(null),[Y,q]=n.useState(null),[Z,te]=n.useState(!1),[D,J]=n.useState({database:"checking",redis:"checking",lastCheck:null}),K=n.useRef(null),u=n.useRef(0),w=n.useCallback(()=>{K.current&&(K.current.cancel("Store changed, cancelling previous requests"),console.log("ÔøΩ Â∑≤ÂèñÊ∂àÊóßÈó®Â∫óËØ∑Ê±Ç")),K.current=ie.CancelToken.source(),u.current+=1},[]),z=n.useCallback(b=>{if(b==="all")A({type:"all",start:"",end:""});else{const _=C?.max_date?new Date(C.max_date):new Date,{start:F,end:B}=It(b,_);A({type:b,start:F,end:B}),console.log(`üìÖ Êó•ÊúüËåÉÂõ¥ËÆ°ÁÆó: ${b}, ÂèÇËÄÉÊó•Êúü: ${_.toISOString().split("T")[0]}, ÁªìÊûú: ${F} ~ ${B}`)}},[C]),k=n.useCallback(async()=>{if(!s){f(null);return}P(!0);try{const b={store_name:s},_=await ae.getDateRange(b);_.success&&(f(_.data),console.log("üìÖ Èó®Â∫óÊï∞ÊçÆÊó•ÊúüËåÉÂõ¥:",_.data))}catch(b){ie.isCancel(b)||(console.error("Ëé∑ÂèñÈó®Â∫óÊó•ÊúüËåÉÂõ¥Â§±Ë¥•:",b),f(null))}finally{P(!1)}},[s]),O=n.useCallback(async()=>{if(!s){S([]);return}y(!0);try{const b=await ae.getChannels({store_name:s});b.success&&b.data&&(S(b.data),c!=="all"&&!b.data.includes(c)&&d("all"),console.log("üì° Ê∏†ÈÅìÂàóË°®Â∑≤Êõ¥Êñ∞:",b.data.length,"‰∏™Ê∏†ÈÅì"))}catch(b){ie.isCancel(b)||(console.error("Ëé∑ÂèñÊ∏†ÈÅìÂàóË°®Â§±Ë¥•:",b),S([]))}finally{y(!1)}},[s,c]),p=n.useCallback(b=>{b!==s&&(w(),M(null),q(null),f(null),S([]),r(b),console.log(`üè™ ÂàáÊç¢Èó®Â∫ó: ${b}`))},[s,w]),T=n.useCallback(async()=>{i(!0);try{const b=await Ae.getStores();b.success&&a(b.data)}catch(b){console.error("Ëé∑ÂèñÈó®Â∫óÂàóË°®Â§±Ë¥•:",b),a([])}finally{i(!1)}},[]),N=n.useCallback(async()=>{H(!0);try{const b=await Ae.getStats();V(b),J({database:b.database_status==="Â∑≤ËøûÊé•"?"connected":"disconnected",redis:b.redis_status==="Â∑≤ËøûÊé•"?"connected":"disconnected",lastCheck:new Date})}catch(b){console.error("Ëé∑ÂèñÁªüËÆ°Êï∞ÊçÆÂ§±Ë¥•:",b),J({database:"disconnected",redis:"disconnected",lastCheck:new Date})}finally{H(!1)}},[]),L=n.useCallback(async(b=3,_=2e3)=>{let F=null;for(let B=0;B<b;B++)try{await N();return}catch(m){F=m,console.log(`ÈáçËØï ${B+1}/${b} Â§±Ë¥•Ôºå${_}ms ÂêéÂÜçÊ¨°Â∞ùËØï...`),B<b-1&&await new Promise(E=>setTimeout(E,_))}console.error("ÊâÄÊúâÈáçËØïÂùáÂ§±Ë¥•:",F)},[N]),$=n.useCallback(async()=>{if(!s){M(null),q(null),te(!1),console.log("üìä Êú™ÈÄâÊã©Èó®Â∫óÔºå‰∏çÂä†ËΩΩÊï∞ÊçÆ");return}const b=u.current;te(!0);try{const _={store_name:s};x.type!=="all"&&x.start&&x.end&&(_.start_date=x.start,_.end_date=x.end),console.log("üìä ËØ∑Ê±ÇËÆ¢ÂçïÊ¶ÇËßà, ÂèÇÊï∞:",_,"Êó•ÊúüÁ±ªÂûã:",x.type);const[F,B]=await Promise.all([ae.getOverview(_),ae.getComparison(_)]);if(b!==u.current){console.log("üìä ËØ∑Ê±ÇÂ∑≤ËøáÊúüÔºåÂøΩÁï•ÁªìÊûú");return}if(F.success?M(F.data):(console.error("‚ùå ËÆ¢ÂçïÊ¶ÇËßàËé∑ÂèñÂ§±Ë¥•:",F),M(null)),B.success&&B.data){const m=B.data.previous;m&&(m.order_count>0||m.total_sales>0||m.total_profit!==0)?(q(B.data),console.log("üìä ÁéØÊØîÊï∞ÊçÆÊúâÊïà:",B.data.period)):(q(null),console.log("üìä ‰∏ä‰∏ÄÂë®ÊúüÊó†Êï∞ÊçÆÔºå‰∏çÊòæÁ§∫ÁéØÊØî"))}else q(null)}catch(_){if(ie.isCancel(_)){console.log("üìä ËØ∑Ê±ÇÂ∑≤ÂèñÊ∂à");return}console.error("‚ùå Ëé∑ÂèñËÆ¢ÂçïÊ¶ÇËßàÂ§±Ë¥•:",_),M(null),q(null)}finally{b===u.current&&te(!1)}},[s,x.type,x.start,x.end]),I=Ot($,300),ee=n.useCallback(async()=>{await Promise.all([T(),N(),k(),O()]),await I()},[T,N,k,O,I]);n.useEffect(()=>{T(),L(5,2e3)},[]),n.useEffect(()=>{const b=setInterval(()=>{N()},3e4);return()=>clearInterval(b)},[]),n.useEffect(()=>{k(),O()},[s]),n.useEffect(()=>{I()},[s,x.type,x.start,x.end]);const ce={stores:l,selectedStore:s,setSelectedStore:p,storesLoading:o,selectedChannel:c,setSelectedChannel:d,channelList:g,channelListLoading:h,dateRange:x,setDateRange:A,setQuickDateRange:z,storeDateRange:C,storeDateRangeLoading:v,stats:U,statsLoading:j,orderOverview:X,orderComparison:Y,orderOverviewLoading:Z,systemStatus:D,refreshStores:T,refreshStats:N,refreshOrderOverview:$,refreshStoreDateRange:k,refreshChannelList:O,refreshAll:ee,cancelStoreRequests:w};return e.jsx(Xe.Provider,{value:ce,children:t})},be=()=>{const t=n.useContext(Xe);if(!t)throw new Error("useGlobalContext must be used within GlobalProvider");return t},Ft="modulepreload",Bt=function(t){return"/"+t},Te={},W=function(l,a,s){let r=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),c=i?.nonce||i?.getAttribute("nonce");r=Promise.allSettled(a.map(d=>{if(d=Bt(d),d in Te)return;Te[d]=!0;const g=d.endsWith(".css"),S=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${S}`))return;const h=document.createElement("link");if(h.rel=g?"stylesheet":Ft,g||(h.as="script"),h.crossOrigin="",h.href=d,c&&h.setAttribute("nonce",c),document.head.appendChild(h),g)return new Promise((y,x)=>{h.addEventListener("load",y),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return r.then(i=>{for(const c of i||[])c.status==="rejected"&&o(c.reason);return l().catch(o)})},$e=[{type:"all",label:"ÂÖ®ÈÉ®Êó∂Èó¥"},{type:"yesterday",label:"Êò®Êó•"},{type:"7days",label:"Ëøë7Â§©"},{type:"30days",label:"Ëøë30Â§©"},{type:"thisWeek",label:"Êú¨Âë®"},{type:"thisMonth",label:"Êú¨Êúà"}],Vt=()=>{const{stores:t,selectedStore:l,setSelectedStore:a,storesLoading:s,dateRange:r,setQuickDateRange:o,setDateRange:i,storeDateRange:c}=be(),[d,g]=n.useState(!1),[S,h]=n.useState(!1),[y,x]=n.useState(!1),[A,C]=n.useState(""),[f,v]=n.useState(),P=n.useRef(null),U=n.useRef(null),V=n.useRef(null),j=n.useRef(null),H=n.useRef(null),X=n.useRef(null),M=c?.min_date?pe(c.min_date,"yyyy-MM-dd",new Date):void 0,Y=c?.max_date?pe(c.max_date,"yyyy-MM-dd",new Date):void 0;n.useEffect(()=>{const p=T=>{const N=T.target;d&&P.current&&!P.current.contains(N)&&j.current&&!j.current.contains(N)&&g(!1),S&&U.current&&!U.current.contains(N)&&H.current&&!H.current.contains(N)&&h(!1),y&&V.current&&!V.current.contains(N)&&X.current&&!X.current.contains(N)&&x(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[d,S,y]);const q=p=>p.replace(/\s*\([0-9,]+Âçï\)\s*$/,"").trim(),Z=t.filter(p=>q(p.label).toLowerCase().includes(A.toLowerCase())),te=l?q(t.find(p=>p.value===l)?.label||l):"ÈÄâÊã©Èó®Â∫ó",D=r.type==="custom"?`${r.start} ~ ${r.end}`:$e.find(p=>p.type===r.type)?.label||"ÂÖ®ÈÉ®",J=n.useCallback(p=>{a(p),g(!1),C("")},[a]),K=n.useCallback(p=>{o(p),h(!1)},[o]),u=n.useCallback(p=>{v(p)},[]),w=n.useCallback(()=>{f?.from&&f?.to&&(i({type:"custom",start:he(f.from,"yyyy-MM-dd"),end:he(f.to,"yyyy-MM-dd")}),x(!1))},[f,i]),z=n.useCallback(()=>{if(r.type==="custom"&&r.start&&r.end){const p=pe(r.start,"yyyy-MM-dd",new Date),T=pe(r.end,"yyyy-MM-dd",new Date);_e(p)&&_e(T)&&v({from:p,to:T})}else v(void 0);x(!0)},[r]),k=n.useCallback(p=>!!(M&&lt(p,M)||Y&&it(p,Y)),[M,Y]),O=p=>{if(!p.current)return{top:0,left:0};const T=p.current.getBoundingClientRect();return{top:T.bottom+8,left:T.left}};return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{ref:P,onClick:()=>g(!d),className:"flex items-center gap-2 px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg text-sm text-white transition-all",children:[e.jsx(qe,{size:16,className:"text-indigo-400"}),e.jsx("span",{className:"max-w-[120px] truncate",children:te}),e.jsx(Ne,{size:14,className:`text-slate-400 transition-transform ${d?"rotate-180":""}`})]}),d&&ye.createPortal(e.jsxs("div",{ref:j,style:O(P),className:"fixed w-64 bg-slate-900 border border-white/10 rounded-xl shadow-2xl z-[9999] overflow-hidden animate-fade-in-up",children:[e.jsx("div",{className:"p-2 border-b border-white/10",children:e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-white/5 rounded-lg",children:[e.jsx(dt,{size:14,className:"text-slate-400"}),e.jsx("input",{type:"text",placeholder:"ÊêúÁ¥¢Èó®Â∫ó...",value:A,onChange:p=>C(p.target.value),className:"flex-1 bg-transparent text-sm text-white placeholder-slate-500 outline-none",autoFocus:!0})]})}),e.jsxs("div",{className:"max-h-64 overflow-y-auto custom-scrollbar",children:[e.jsx("div",{className:"px-4 py-2 text-xs text-slate-500 border-b border-white/5",children:"ËØ∑ÈÄâÊã©‰∏Ä‰∏™Èó®Â∫óÊü•ÁúãÊï∞ÊçÆ"}),s?e.jsx("div",{className:"px-4 py-8 text-center text-slate-500 text-sm",children:"Âä†ËΩΩ‰∏≠..."}):Z.length===0?e.jsx("div",{className:"px-4 py-8 text-center text-slate-500 text-sm",children:A?"Êú™ÊâæÂà∞ÂåπÈÖçÁöÑÈó®Â∫ó":"ÊöÇÊó†Èó®Â∫óÊï∞ÊçÆ"}):Z.map(p=>e.jsxs("button",{onClick:()=>J(p.value),className:`w-full flex items-center justify-between px-4 py-2.5 text-sm transition-colors ${l===p.value?"bg-indigo-500/20 text-indigo-300":"text-slate-300 hover:bg-white/5"}`,children:[e.jsx("span",{children:q(p.label)}),l===p.value&&e.jsx(ge,{size:14,className:"text-indigo-400"})]},p.value))]})]}),document.body)]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{ref:U,onClick:()=>h(!S),className:"flex items-center gap-2 px-4 py-2 bg-white/5 hover:bg-white/10 border border-white/10 rounded-lg text-sm text-white transition-all",children:[e.jsx(De,{size:16,className:"text-emerald-400"}),e.jsx("span",{className:"max-w-[180px] truncate",children:D}),e.jsx(Ne,{size:14,className:`text-slate-400 transition-transform ${S?"rotate-180":""}`})]}),S&&ye.createPortal(e.jsx("div",{ref:H,style:O(U),className:"fixed w-40 bg-slate-900 border border-white/10 rounded-xl shadow-2xl z-[9999] overflow-hidden animate-fade-in-up",children:$e.map(({type:p,label:T})=>e.jsxs("button",{onClick:()=>K(p),className:`w-full flex items-center justify-between px-4 py-2.5 text-sm transition-colors ${r.type===p?"bg-emerald-500/20 text-emerald-300":"text-slate-300 hover:bg-white/5"}`,children:[e.jsx("span",{children:T}),r.type===p&&e.jsx(ge,{size:14,className:"text-emerald-400"})]},p))}),document.body)]}),e.jsxs("button",{ref:V,onClick:z,className:`flex items-center gap-2 px-4 py-2 rounded-lg border transition-all ${r.type==="custom"?"bg-indigo-500/20 border-indigo-500/50 text-indigo-300":"bg-white/5 border-white/10 text-slate-400 hover:bg-white/10 hover:text-white hover:border-white/20"}`,children:[e.jsx(De,{size:16,className:r.type==="custom"?"text-indigo-400":"text-slate-400"}),e.jsx("span",{className:"text-sm",children:"Ëá™ÂÆö‰πâ"})]}),y&&ye.createPortal(e.jsxs("div",{ref:X,style:{top:V.current?.getBoundingClientRect().bottom+8,left:Math.min(V.current?.getBoundingClientRect().left||0,window.innerWidth-620)},className:"fixed z-[9999] p-5 rounded-xl border shadow-2xl bg-slate-900 border-white/10",children:[c?.min_date&&c?.max_date&&e.jsx("div",{className:"mb-4 px-3 py-2 bg-indigo-500/10 border border-indigo-500/20 rounded-lg",children:e.jsxs("p",{className:"text-xs text-indigo-300",children:["üìÖ ÂèØÈÄâÊï∞ÊçÆËåÉÂõ¥: ",c.min_date," ~ ",c.max_date]})}),e.jsx("style",{children:`
            .calendar-container .rdp-root {
              --rdp-accent-color: #6366f1;
              --rdp-accent-background-color: rgba(99, 102, 241, 0.2);
            }
            .calendar-container .rdp-months {
              display: flex;
              gap: 2rem;
            }
            .calendar-container .rdp-month_caption {
              display: flex;
              justify-content: center;
              align-items: center;
              height: 40px;
              font-weight: 600;
              font-size: 14px;
              color: #f1f5f9;
            }
            .calendar-container .rdp-nav {
              position: absolute;
              top: 0;
              left: 0;
              right: 0;
              display: flex;
              justify-content: space-between;
              padding: 0 8px;
            }
            .calendar-container .rdp-button_previous,
            .calendar-container .rdp-button_next {
              width: 32px;
              height: 32px;
              border-radius: 8px;
              background: rgba(255, 255, 255, 0.05);
              color: #94a3b8;
              display: flex;
              align-items: center;
              justify-content: center;
              border: none;
              cursor: pointer;
              transition: all 0.15s;
            }
            .calendar-container .rdp-button_previous:hover,
            .calendar-container .rdp-button_next:hover {
              background: rgba(255, 255, 255, 0.1);
              color: #f1f5f9;
            }
            .calendar-container .rdp-weekday {
              color: #64748b;
              font-size: 12px;
              font-weight: 500;
              padding: 8px 0;
            }
            .calendar-container .rdp-day {
              width: 36px;
              height: 36px;
            }
            .calendar-container .rdp-day button {
              width: 36px;
              height: 36px;
              border-radius: 8px;
              color: #cbd5e1;
              font-weight: 400;
              font-size: 13px;
              transition: all 0.15s;
              border: none;
              background: transparent;
              cursor: pointer;
            }
            .calendar-container .rdp-day button:hover:not(:disabled) {
              background: rgba(255, 255, 255, 0.08);
              color: #f1f5f9;
            }
            .calendar-container .rdp-today button {
              color: #818cf8;
              box-shadow: inset 0 0 0 1px #6366f1;
            }
            .calendar-container .rdp-selected button,
            .calendar-container .rdp-range_start button,
            .calendar-container .rdp-range_end button {
              background: #6366f1 !important;
              color: white !important;
            }
            .calendar-container .rdp-range_middle button {
              background: rgba(99, 102, 241, 0.2) !important;
              color: #a5b4fc !important;
              border-radius: 0 !important;
            }
            .calendar-container .rdp-range_start button {
              border-radius: 8px 0 0 8px !important;
            }
            .calendar-container .rdp-range_end button {
              border-radius: 0 8px 8px 0 !important;
            }
            .calendar-container .rdp-disabled button {
              color: #334155 !important;
              opacity: 0.4;
              cursor: not-allowed !important;
            }
            .calendar-container .rdp-disabled button:hover {
              background: transparent !important;
            }
            .calendar-container .rdp-outside button {
              color: #475569;
              opacity: 0.5;
            }
          `}),e.jsx("div",{className:"calendar-container",children:e.jsx(ut,{mode:"range",numberOfMonths:2,selected:f,onSelect:u,locale:ct,disabled:k,defaultMonth:Y?new Date(Y.getFullYear(),Y.getMonth()-1):new Date,startMonth:M,endMonth:Y,showOutsideDays:!1,components:{Chevron:({orientation:p})=>p==="left"?e.jsx(ft,{size:18}):e.jsx(Ce,{size:18})}})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-slate-400",children:f?.from&&f?.to?e.jsxs("span",{className:"text-emerald-400 font-medium",children:["Â∑≤ÈÄâ: ",he(f.from,"yyyy-MM-dd")," ~ ",he(f.to,"yyyy-MM-dd")]}):f?.from?e.jsx("span",{className:"text-amber-400",children:"ËØ∑ÈÄâÊã©ÁªìÊùüÊó•Êúü"}):e.jsx("span",{children:"ÁÇπÂáªÈÄâÊã©ÂºÄÂßãÊó•Êúü"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 text-sm text-slate-400 hover:text-white transition-colors",children:"ÂèñÊ∂à"}),e.jsx("button",{onClick:w,disabled:!f?.from||!f?.to,className:"px-5 py-2 bg-indigo-500 text-white rounded-lg text-sm font-medium hover:bg-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Á°ÆËÆ§ÈÄâÊã©"})]})]})]}),document.body)]})},Ie=new Set,Ut=t=>{if(!Ie.has(t))switch(Ie.add(t),t){case"/data":W(()=>import("./DataManagement-B5gBlpRv.js"),__vite__mapDeps([0,1,2,3,4,5]));break;case"/stores":W(()=>import("./StoreComparisonView-zvBTf09c.js"),__vite__mapDeps([6,1,2,3,4,5]));break}},qt=({children:t,theme:l,onToggleTheme:a})=>{const s=st(),{systemStatus:r}=be(),[o,i]=n.useState(!1),c=()=>r.database==="checking"?"CHECKING...":r.database==="disconnected"?"DB OFFLINE":r.redis==="disconnected"?"CACHE OFFLINE":"ONLINE",d=r.database==="connected";return e.jsxs("div",{className:"flex min-h-screen font-sans selection:bg-neon-purple selection:text-white relative transition-colors duration-500",children:[e.jsxs("aside",{className:"hidden md:flex flex-col glass-panel border-r border-white/5 sticky top-0 h-screen z-40",style:{width:o?"80px":"256px",transition:"width 0.35s cubic-bezier(0.4, 0, 0.2, 1)"},children:[e.jsxs("div",{className:"h-20 flex items-center border-b border-white/5 overflow-hidden",style:{paddingLeft:o?"0":"24px",justifyContent:o?"center":"flex-start",transition:"padding 0.35s cubic-bezier(0.4, 0, 0.2, 1)"},children:[e.jsxs("div",{className:"relative group cursor-pointer flex-shrink-0",children:[e.jsx("div",{className:"absolute inset-0 bg-neon-purple blur-lg opacity-20 group-hover:opacity-40 transition-opacity"}),e.jsx("div",{className:"relative bg-gradient-to-br from-indigo-600 to-purple-700 w-9 h-9 rounded-xl flex items-center justify-center shadow-lg border border-white/10 group-hover:scale-105 transition-transform",children:e.jsx(We,{size:20,className:"text-white fill-current"})})]}),e.jsxs("div",{className:"ml-3 overflow-hidden whitespace-nowrap",style:{opacity:o?0:1,width:o?0:"auto",transition:"opacity 0.25s ease, width 0.35s cubic-bezier(0.4, 0, 0.2, 1)"},children:[e.jsxs("span",{className:"font-bold text-xl tracking-tight text-white font-mono",children:["O2O",e.jsx("span",{className:"text-neon-purple",children:"Dashboard"})]}),e.jsx("div",{className:"text-[10px] text-slate-400 uppercase tracking-widest",children:"React v1.0"})]})]}),e.jsxs("nav",{className:"flex-1 py-8 space-y-2 px-3 overflow-hidden",children:[e.jsx(oe,{to:"/",icon:e.jsx(xt,{size:20}),label:"ÁªèËê•ÊÄªËßà",active:s.pathname==="/",collapsed:o}),e.jsx(oe,{to:"/stores",icon:e.jsx(qe,{size:20}),label:"ÂÖ®ÈáèÈó®Â∫óÂØπÊØî",active:s.pathname==="/stores",collapsed:o}),e.jsx(oe,{to:"/data",icon:e.jsx(pt,{size:20}),label:"Êï∞ÊçÆÁÆ°ÁêÜ",active:s.pathname==="/data",collapsed:o}),e.jsx(oe,{to:"/channels",icon:e.jsx(ht,{size:20}),label:"Ê∏†ÈÅìÂàÜÊûê",active:s.pathname==="/channels",collapsed:o}),e.jsx(oe,{to:"/trends",icon:e.jsx(Ge,{size:20}),label:"Ë∂ãÂäøÊ¥ûÂØü",active:s.pathname==="/trends",collapsed:o}),e.jsx("div",{className:"my-4 border-t border-white/5 mx-2"}),e.jsx(oe,{to:"/settings",icon:e.jsx(mt,{size:20}),label:"Á≥ªÁªüËÆæÁΩÆ",active:s.pathname==="/settings",collapsed:o})]}),e.jsxs("div",{className:"p-4 border-t border-white/5 bg-gradient-to-t from-slate-900/10 to-transparent overflow-hidden",children:[e.jsxs("button",{onClick:a,className:"w-full flex items-center gap-3 p-2 mb-4 rounded-lg bg-white/5 hover:bg-white/10 border border-white/5 transition-colors group",style:{justifyContent:o?"center":"flex-start"},children:[e.jsx("div",{className:`p-1.5 rounded-md flex-shrink-0 ${l==="dark"?"bg-indigo-500 text-white":"text-slate-400"}`,children:e.jsx(gt,{size:14})}),e.jsxs("div",{className:"flex items-center gap-3 overflow-hidden whitespace-nowrap",style:{opacity:o?0:1,width:o?0:"auto",transition:"opacity 0.25s ease, width 0.35s cubic-bezier(0.4, 0, 0.2, 1)"},children:[e.jsx("div",{className:`p-1.5 rounded-md ${l==="light"?"bg-amber-400 text-white":"text-slate-400"}`,children:e.jsx(bt,{size:14})}),e.jsx("span",{className:"text-xs font-medium text-slate-400 group-hover:text-white",children:l==="dark"?"Presentation":"Workstation"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",style:{justifyContent:o?"center":"flex-start",paddingLeft:o?0:"8px"},children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-slate-800 flex items-center justify-center border border-white/10 shadow-inner ring-1 ring-white/5 flex-shrink-0",children:e.jsx(yt,{size:16,className:"text-slate-300"})}),e.jsxs("div",{className:"overflow-hidden whitespace-nowrap",style:{opacity:o?0:1,width:o?0:"auto",transition:"opacity 0.25s ease, width 0.35s cubic-bezier(0.4, 0, 0.2, 1)"},children:[e.jsx("p",{className:"text-sm font-bold text-slate-100",children:"Admin User"}),e.jsx("p",{className:"text-xs text-neon-cyan font-mono",children:"OPERATOR_LVL_5"})]})]}),e.jsxs("button",{onClick:()=>i(!o),className:"w-full mt-4 flex items-center justify-center gap-2 p-2 rounded-lg bg-white/5 hover:bg-white/10 border border-white/5 text-slate-400 hover:text-white group",style:{transition:"all 0.2s ease"},children:[e.jsx("div",{style:{transform:o?"rotate(0deg)":"rotate(180deg)",transition:"transform 0.35s cubic-bezier(0.4, 0, 0.2, 1)"},children:e.jsx(Ce,{size:16})}),e.jsx("span",{className:"text-xs overflow-hidden whitespace-nowrap",style:{opacity:o?0:1,width:o?0:"auto",transition:"opacity 0.25s ease, width 0.35s cubic-bezier(0.4, 0, 0.2, 1)"},children:"Êî∂Ëµ∑‰æßÊ†è"})]})]})]}),e.jsxs("main",{className:"flex-1 flex flex-col min-w-0 overflow-hidden relative z-10",children:[e.jsxs("header",{className:"h-20 bg-transparent flex items-center justify-between px-6 md:px-8 sticky top-0 z-30 backdrop-blur-sm",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-white tracking-wide",children:"ÂÖ®Ê∏†ÈÅìÁªèËê•Â§çÁõòÁúãÊùø"}),e.jsxs("p",{className:`text-xs font-mono mt-0.5 opacity-70 flex items-center gap-1.5 ${d?"text-slate-400":"text-amber-400"}`,children:[d?e.jsx(vt,{size:10,className:"text-emerald-400"}):e.jsx(wt,{size:10,className:"text-amber-400"}),"SYSTEM: ",c()]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Vt,{}),e.jsxs("div",{className:`hidden sm:flex items-center gap-2 glass-panel px-4 py-1.5 rounded-full border text-xs shadow-lg ${d?"border-white/10 text-neon-cyan":"border-amber-500/30 text-amber-400"}`,children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full animate-pulse ${d?"bg-neon-cyan":"bg-amber-400"}`}),e.jsx("span",{className:"font-mono",children:d?"LIVE_DATA":"OFFLINE"})]}),e.jsxs("button",{className:"relative p-2.5 bg-white/5 hover:bg-white/10 border border-white/10 rounded-full text-slate-300 hover:text-white transition-all hover:shadow-[0_0_15px_rgba(255,255,255,0.1)] group",children:[e.jsx(jt,{size:20,className:"group-hover:rotate-12 transition-transform"}),e.jsx("span",{className:"absolute top-0 right-0 w-2.5 h-2.5 bg-neon-rose rounded-full border-2 border-slate-900"})]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4 md:p-8 z-10 custom-scrollbar",children:e.jsx("div",{className:"w-full h-full flex flex-col gap-8 pb-10",children:t})})]})]})},oe=({to:t,icon:l,label:a,active:s=!1,collapsed:r=!1})=>{const o=n.useCallback(()=>{Ut(t)},[t]);return e.jsxs(rt,{to:t,className:`relative group w-full flex items-center gap-3 px-3 py-3 rounded-xl overflow-hidden ${s?"text-white shadow-[0_0_20px_rgba(139,92,246,0.15)] bg-white/5":"text-slate-400 hover:text-white"}`,style:{justifyContent:r?"center":"flex-start",transition:"all 0.35s cubic-bezier(0.4, 0, 0.2, 1)"},title:r?a:void 0,onMouseEnter:o,children:[s&&e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-neon-purple rounded-full shadow-[0_0_10px_#a78bfa]"}),!s&&e.jsx("div",{className:"absolute inset-0 bg-white/0 group-hover:bg-white/5 transition-colors"}),e.jsx("div",{className:`relative z-10 flex-shrink-0 transition-transform group-hover:scale-110 ${s?"text-neon-purple":"group-hover:text-slate-200"}`,children:l}),e.jsx("span",{className:"relative z-10 text-sm font-medium tracking-wide whitespace-nowrap overflow-hidden",style:{opacity:r?0:1,width:r?0:"auto",transition:"opacity 0.25s ease, width 0.35s cubic-bezier(0.4, 0, 0.2, 1)"},children:a}),r&&e.jsxs("div",{className:"absolute left-full ml-2 px-3 py-1.5 bg-slate-800 text-white text-xs font-medium rounded-lg shadow-xl border border-white/10 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 whitespace-nowrap z-50",children:[a,e.jsx("div",{className:"absolute left-0 top-1/2 -translate-x-1 -translate-y-1/2 w-2 h-2 bg-slate-800 rotate-45 border-l border-b border-white/10"})]})]})},Wt=(t,l=1500)=>{const[a,s]=n.useState(t);return n.useEffect(()=>{if(t==="-"||t==="0"||!t){s(t);return}const r=parseFloat(t.replace(/[^0-9.-]/g,""));if(isNaN(r)){s(t);return}const o=t.includes("¬•")?"¬•":"",i=t.includes("k")?"k":"",c=t.includes("."),d=r<0;let g=null,S,h=!1;const y=C=>{if(h)return;g||(g=C);const f=Math.min((C-g)/l,1),v=1-Math.pow(1-f,5),P=Math.abs(r)*v,U=c?P.toFixed(1):Math.round(P).toLocaleString();s(`${o}${d?"-":""}${U}${i}`),f<1?S=requestAnimationFrame(y):s(t)},x=`${o}${d?"-":""}0${i}`;s(x);const A=setTimeout(()=>{S=requestAnimationFrame(y)},16);return()=>{h=!0,clearTimeout(A),S&&cancelAnimationFrame(S)}},[t,l]),a},Oe={emerald:"bg-emerald-500/10 text-emerald-400 border-emerald-500/20",indigo:"bg-indigo-500/10 text-indigo-400 border-indigo-500/20",violet:"bg-violet-500/10 text-violet-400 border-violet-500/20",amber:"bg-amber-500/10 text-amber-400 border-amber-500/20",cyan:"bg-cyan-500/10 text-cyan-400 border-cyan-500/20",rose:"bg-rose-500/10 text-rose-400 border-rose-500/20",orange:"bg-orange-500/10 text-orange-400 border-orange-500/20",pink:"bg-pink-500/10 text-pink-400 border-pink-500/20"},Pe={emerald:"bg-emerald-600",indigo:"bg-indigo-600",violet:"bg-violet-600",amber:"bg-amber-600",cyan:"bg-cyan-600",rose:"bg-rose-600",orange:"bg-orange-600",pink:"bg-pink-600"},re=({title:t,value:l,change:a,subtext:s,icon:r,trendColor:o="green",iconColor:i,theme:c="dark",loading:d=!1,compact:g=!1,isPercentChange:S=!1})=>{const h=a!==void 0,y=h?a>=0:!0,A=Wt(d?"-":l),C=c==="dark",f=i||(o==="red"?"rose":"emerald"),v=Oe[f]||Oe.emerald,P=Pe[f]||Pe.emerald,U=C?"text-white":"text-slate-900",V=C?"text-slate-400":"text-slate-500",j=g?"p-4":"p-6",H=g?"text-[10px]":"text-[11px]",X=g?"text-xl":"text-3xl",M=g?"p-2":"p-3",Y=()=>h?S?`${a>=0?"+":""}${a.toFixed(1)}pp`:`${a>=0?"+":""}${a.toFixed(1)}%`:"";return e.jsx("div",{className:"relative group rounded-2xl transition-all duration-500 hover:shadow-[0_10px_40px_-10px_rgba(0,0,0,0.5)]",children:e.jsxs("div",{className:`glass-panel rounded-2xl ${j} h-full relative overflow-hidden transition-colors ${C?"group-hover:border-white/10":"group-hover:border-black/5"}`,children:[e.jsx("div",{className:`absolute top-0 bottom-0 left-0 w-1/2 bg-gradient-to-r from-transparent ${C?"via-white/5":"via-black/5"} to-transparent skew-x-[-15deg] animate-shimmer pointer-events-none`}),e.jsx("div",{className:`absolute -top-10 -right-10 w-32 h-32 rounded-full blur-[60px] opacity-0 transition-all duration-700 group-hover:opacity-15 group-hover:scale-110 ${P}`}),e.jsxs("div",{className:"flex justify-between items-start mb-3 relative z-10",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`${H} font-bold uppercase tracking-widest mb-1 font-mono ${V} truncate`,children:t}),d?e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(Nt,{size:g?16:24,className:`animate-spin ${V}`})}):e.jsx("h3",{className:`${X} font-bold font-mono tracking-tight drop-shadow-lg tabular-nums ${U} truncate`,children:A})]}),e.jsx("div",{className:`${M} rounded-xl border backdrop-blur-md transition-transform duration-300 group-hover:rotate-6 ${v} flex-shrink-0`,children:r})]}),e.jsxs("div",{className:"flex items-center justify-between relative z-10 mt-2",children:[h?e.jsxs("div",{className:`flex items-center text-[10px] font-bold px-2 py-0.5 rounded-md border backdrop-blur-sm ${y?"bg-emerald-500/5 text-emerald-400 border-emerald-500/20":"bg-rose-500/5 text-rose-400 border-rose-500/20"}`,children:[y?e.jsx(St,{size:12,className:"mr-0.5"}):e.jsx(Ct,{size:12,className:"mr-0.5"}),e.jsx("span",{className:"font-mono",children:Y()})]}):e.jsx("div",{className:`flex items-center text-[10px] font-medium px-2 py-0.5 rounded-md border backdrop-blur-sm ${C?"bg-slate-500/5 text-slate-400 border-slate-500/20":"bg-slate-100 text-slate-500 border-slate-200"}`,children:e.jsx("span",{className:"font-mono",children:"Êó†Êï∞ÊçÆ"})}),e.jsxs("div",{className:`flex items-center gap-1 text-[10px] font-medium tracking-wide ${V}`,children:[e.jsx(He,{size:10,className:"opacity-50"}),s]})]})]})})};function Gt(t,l=100,a="date"){if(!t||t.length<=l)return t;const s=Math.ceil(t.length/l),r=[];for(let o=0;o<t.length;o+=s){const i=t.slice(o,Math.min(o+s,t.length)),c=Math.floor(i.length/2);r.push(i[c])}return r[0]!==t[0]&&r.unshift(t[0]),r[r.length-1]!==t[t.length-1]&&r.push(t[t.length-1]),console.log(`üìä Êï∞ÊçÆÈááÊ†∑: ${t.length} -> ${r.length} ÁÇπ (${((1-r.length/t.length)*100).toFixed(1)}% ÂáèÂ∞ë)`),r}function Ht(t,l=1e3){if(!t||t.length<=l)return t;const a=[],s=t.length/l;for(let r=0;r<l;r++){const o=Math.floor(r*s);a.push(t[o])}return console.log(`üìä Êï£ÁÇπÂõæÈááÊ†∑: ${t.length} -> ${a.length} ÁÇπ`),a}function Fe(t,l=100){return t>l}let Be=!1;const Ve=()=>{Be||(Le("neon-cyber",{backgroundColor:"transparent",textStyle:{fontFamily:"JetBrains Mono, Inter, sans-serif"},title:{textStyle:{color:"#f8fafc"},subtextStyle:{color:"#94a3b8"}},line:{itemStyle:{borderWidth:2},lineStyle:{width:3},symbolSize:8,symbol:"circle",smooth:!0},categoryAxis:{axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#94a3b8",fontSize:11},splitLine:{show:!1}},valueAxis:{axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#64748b",fontSize:10},splitLine:{show:!0,lineStyle:{color:"rgba(255,255,255,0.05)",type:"dashed"}}},tooltip:{backgroundColor:"rgba(15, 23, 42, 0.95)",borderColor:"rgba(255, 255, 255, 0.1)",textStyle:{color:"#f8fafc"},padding:12,extraCssText:"backdrop-filter: blur(10px); border-radius: 8px; box-shadow: 0 10px 30px rgba(0,0,0,0.5);"}}),Le("clean-light",{backgroundColor:"transparent",textStyle:{fontFamily:"JetBrains Mono, Inter, sans-serif"},title:{textStyle:{color:"#0f172a"},subtextStyle:{color:"#64748b"}},line:{itemStyle:{borderWidth:2},lineStyle:{width:3},symbolSize:8,symbol:"circle",smooth:!0},categoryAxis:{axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#64748b",fontSize:11},splitLine:{show:!1}},valueAxis:{axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#64748b",fontSize:10},splitLine:{show:!0,lineStyle:{color:"rgba(0,0,0,0.06)",type:"dashed"}}},tooltip:{backgroundColor:"rgba(255, 255, 255, 0.95)",borderColor:"rgba(0, 0, 0, 0.1)",textStyle:{color:"#0f172a"},padding:12,extraCssText:"backdrop-filter: blur(10px); border-radius: 8px; box-shadow: 0 10px 20px rgba(0,0,0,0.1);"}}),Be=!0)};function Ue(t,l){let a=null;return(...s)=>{a&&clearTimeout(a),a=setTimeout(()=>t(...s),l)}}const Yt=(t,l,a="dark",s,r=!0)=>{const o=n.useRef(null),i=n.useRef(null),c=n.useRef(!1),d=n.useRef(null),g=n.useRef(null),S=n.useCallback(y=>{if(!r)return y;const x={...y},A=x.series;return Array.isArray(A)&&(x.series=A.map(C=>{if(!Array.isArray(C.data)||C.data.length===0)return C;const f=C.data.length;return C.type==="line"&&Fe(f,100)?{...C,data:Gt(C.data,100)}:C.type==="scatter"&&Fe(f,1e3)?{...C,data:Ht(C.data,1e3)}:C})),x},[r]),h=n.useCallback(()=>{if(!(c.current||!i.current))try{if(!o.current||!document.body.contains(o.current))return;i.current.resize({animation:{duration:200,easing:"cubicOut"}})}catch(y){console.debug("[useChart] Resize skipped:",y)}},[]);return n.useEffect(()=>{if(!o.current)return;Ve();const y=a==="light"?"clean-light":"neon-cyber";if(i.current){try{i.current.dispose()}catch(x){console.debug("[useChart] Dispose error:",x)}i.current=null}return c.current=!1,i.current=Me(o.current,y,{renderer:"canvas",useDirtyRect:!0}),s&&i.current.on("click",s),g.current=Ue(h,100),d.current=new ResizeObserver(()=>{g.current?.()}),d.current.observe(o.current),()=>{if(c.current=!0,d.current&&(d.current.disconnect(),d.current=null),i.current){try{i.current.off("click"),i.current.dispose()}catch(x){console.debug("[useChart] Cleanup error:",x)}i.current=null}}},[a,h]),n.useEffect(()=>{if(console.log("[useChart] Êõ¥Êñ∞ effect Ëß¶Âèë, chartRef:",!!o.current,"chartInstance:",!!i.current),o.current&&!i.current&&!c.current){console.log("[useChart] Âª∂ËøüÂàõÂª∫ÂõæË°®ÂÆû‰æã"),Ve();const f=a==="light"?"clean-light":"neon-cyber";i.current=Me(o.current,f,{renderer:"canvas",useDirtyRect:!0}),d.current||(g.current=Ue(h,100),d.current=new ResizeObserver(()=>{g.current?.()}),d.current.observe(o.current)),s&&i.current.on("click",s)}if(c.current||!i.current){console.log("[useChart] Ë∑≥ËøáÊõ¥Êñ∞: isDisposed=",c.current,"chartInstance=",!!i.current);return}const y=Object.keys(t||{});if(y.length===0){console.log("[useChart] Ë∑≥ËøáÊõ¥Êñ∞: Á©∫ÂØπË±°");return}const x=t?.series;if(Array.isArray(x)&&x.length===0){console.log("[useChart] Ë∑≥ËøáÊõ¥Êñ∞: Á©∫ series Êï∞ÁªÑ");return}const A=y.some(f=>f!=="series"&&t[f]!==void 0);if(!Array.isArray(x)&&!A){console.log("[useChart] Ë∑≥ËøáÊõ¥Êñ∞: Êó† series ‰∏îÊó†ÂÖ∂‰ªñÈÖçÁΩÆ");return}const C=Array.isArray(x)&&x.some(f=>{if(!Array.isArray(f.data)||f.data.length===0)return!1;const v=f.data[0];return v==null?!1:typeof v=="object"&&"value"in v?v.value!==void 0&&v.value!==null:!0});if(console.log("[useChart] Êï∞ÊçÆÊ£ÄÊü•: seriesCount=",x?.length,"hasData=",C),Array.isArray(x)&&x.length>0&&!C){console.log("[useChart] Ë∑≥ËøáÊõ¥Êñ∞: Êúâ series ‰ΩÜÊó†Êï∞ÊçÆ");return}try{console.log("[useChart] ÊâßË°å setOption, seriesCount:",x?.length);const f=S(t);i.current.setOption(f,{notMerge:!0,lazyUpdate:!1,silent:!1}),console.log("[useChart] setOption ÂÆåÊàê")}catch(f){console.error("[useChart] setOption error:",f)}requestAnimationFrame(()=>{if(!c.current&&i.current)try{i.current.resize()}catch(f){console.debug("[useChart] resize error:",f)}})},[t,a,h,S,...l]),n.useEffect(()=>{if(!(c.current||!i.current))return i.current.off("click"),s&&i.current.on("click",s),()=>{i.current&&i.current.off("click")}},[s]),o},Kt={indigo:{bg:"bg-indigo-500/20",text:"text-indigo-300",icon:"text-indigo-400"},pink:{bg:"bg-pink-500/20",text:"text-pink-300",icon:"text-pink-400"},cyan:{bg:"bg-cyan-500/20",text:"text-cyan-300",icon:"text-cyan-400"},emerald:{bg:"bg-emerald-500/20",text:"text-emerald-300",icon:"text-emerald-400"}},Jt=({selectedChannel:t,channelList:l,onSelect:a,isDark:s,accentColor:r="indigo"})=>{const[o,i]=n.useState(!1),c=n.useRef(null),d=n.useRef(null),g=Kt[r];n.useEffect(()=>{const h=y=>{const x=y.target;o&&c.current&&!c.current.contains(x)&&d.current&&!d.current.contains(x)&&i(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[o]);const S=t==="all"?"ÂÖ®ÈÉ®Ê∏†ÈÅì":t;return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{ref:c,onClick:()=>i(!o),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg border text-xs font-medium transition-all duration-200 ${s?"bg-white/5 hover:bg-white/10 border-white/10 text-slate-300":"bg-black/5 hover:bg-black/10 border-black/10 text-slate-600"}`,children:[e.jsx(kt,{size:12,className:g.icon}),e.jsx("span",{className:"max-w-[80px] truncate",children:S}),e.jsx(Ne,{size:12,className:`text-slate-400 transition-transform ${o?"rotate-180":""}`})]}),o&&e.jsx("div",{ref:d,className:`absolute top-full right-0 mt-2 w-40 rounded-xl border shadow-2xl z-50 overflow-hidden animate-fade-in-up ${s?"bg-slate-900 border-white/10":"bg-white border-black/10"}`,children:e.jsxs("div",{className:"max-h-64 overflow-y-auto custom-scrollbar",children:[e.jsxs("button",{onClick:()=>{a("all"),i(!1)},className:`w-full flex items-center justify-between px-4 py-2.5 text-xs transition-colors ${t==="all"?`${g.bg} ${g.text}`:s?"text-slate-300 hover:bg-white/5":"text-slate-600 hover:bg-black/5"}`,children:[e.jsx("span",{children:"ÂÖ®ÈÉ®Ê∏†ÈÅì"}),t==="all"&&e.jsx(ge,{size:12,className:g.icon})]}),l.map(h=>e.jsxs("button",{onClick:()=>{a(h),i(!1)},className:`w-full flex items-center justify-between px-4 py-2.5 text-xs transition-colors ${t===h?`${g.bg} ${g.text}`:s?"text-slate-300 hover:bg-white/5":"text-slate-600 hover:bg-black/5"}`,children:[e.jsx("span",{children:h}),t===h&&e.jsx(ge,{size:12,className:g.icon})]},h))]})})]})},Xt=({data:t,theme:l,onDateSelect:a,selectedDate:s,selectedDateRange:r})=>{const[o,i]=n.useState(!1),[c,d]=n.useState(null),[g,S]=n.useState(!1),{selectedStore:h,dateRange:y,selectedChannel:x,setSelectedChannel:A,channelList:C}=be(),f=l==="dark",v=f?"#64748b":"#94a3b8",P=f?"#fff":"#0f172a",U=f?"#94a3b8":"#64748b",V=f?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.05)";n.useEffect(()=>{(async()=>{if(!h){d(null);return}S(!0);try{const w={store_name:h,channel:x==="all"?void 0:x,granularity:"day"};y.type!=="all"&&y.start&&y.end?(w.start_date=y.start,w.end_date=y.end):w.days=30;const z=await ae.getTrend(w);z.success&&z.data&&d(z.data)}catch(w){console.error("Ëé∑ÂèñË∂ãÂäøÊï∞ÊçÆÂ§±Ë¥•:",w)}finally{S(!1)}})()},[h,x,y.type,y.start,y.end]);const j=(u,w,z)=>{if(u.length===0)return[];const k=u.filter($=>$>0);if(k.length===0)return[];const O=k.reduce(($,I)=>$+I,0)/k.length,p=k.reduce(($,I)=>$+Math.pow(I-O,2),0)/k.length,T=Math.sqrt(p),N=O-T,L=[];return u.forEach(($,I)=>{$<N&&$>0&&L.push({name:"Profit Rate Low",xAxis:w[I],yAxis:z[I],value:`${$.toFixed(1)}%`,itemStyle:{color:"#f43f5e"}})}),L},{categories:H,fullDates:X,values:M,anomalies:Y,profitRates:q,avgValues:Z}=n.useMemo(()=>{if(c&&c.dates.length>0){const N=c.dates.map((_,F)=>({date:_.slice(5),fullDate:_,revenue:c.amounts[F]||0,profit:c.profits[F]||0,orders:c.order_counts[F]||0,profitRate:c.profit_rates?.[F]||0,avgValue:c.avg_values?.[F]||0})),L=N.map(_=>_.profitRate),$=N.map(_=>_.avgValue),I=N.map(_=>_.date),ee=N.map(_=>_.fullDate),ce=N.map(_=>_.revenue),b=j(L,I,ce);return{categories:I,fullDates:ee,values:N,anomalies:b,profitRates:L,avgValues:$}}let u=[];t.length>0&&(u=t[0].dailyTrend.map(L=>({date:L.date,fullDate:L.date,revenue:0,profit:0,orders:0,profitRate:0,avgValue:0})),t.forEach(L=>{L.dailyTrend.forEach(($,I)=>{u[I]&&(u[I].revenue+=$.revenue,u[I].profit+=$.profit,u[I].orders+=$.orders)})}),u.forEach(L=>{L.profitRate=L.revenue>0?L.profit/L.revenue*100:0,L.avgValue=L.orders>0?L.revenue/L.orders:0}));const w=u.map(N=>N.profitRate),z=u.map(N=>N.avgValue),k=u.map(N=>N.date),O=u.map(N=>N.fullDate),p=u.map(N=>N.revenue),T=j(w,k,p);return{categories:k,fullDates:O,values:u,anomalies:T,profitRates:w,avgValues:z}},[t,c]),te=n.useCallback(u=>{if(a&&u.dataIndex!==void 0){const w=H.length,z=X[u.dataIndex];s===z?a(null,void 0,w):a(z,u.dataIndex,w)}},[a,s,H.length,X]);n.useMemo(()=>Math.max(...M.map(u=>u.revenue),1e3),[M]);const D=n.useMemo(()=>{const u=M.map(ee=>ee.revenue),w=M.map(ee=>ee.profit),z=M.map(ee=>ee.orders),k=q,O=Math.max(...u,1e3),p=Math.max(...w,100),T=Math.ceil(p*3/100)*100,N=Math.max(...z,10),L=Math.ceil(N*1.3/10)*10,$=Math.max(...k,10),I=Math.ceil($*2.2/10)*10;return{revenueMax:O,profitMax:T,ordersMax:L,rateMax:Math.max(I,100)}},[M,q]),J={grid:{top:30,right:50,bottom:40,left:50,containLabel:!1},tooltip:{trigger:"axis",backgroundColor:f?"rgba(15, 23, 42, 0.9)":"rgba(255, 255, 255, 0.9)",borderColor:f?"rgba(255, 255, 255, 0.1)":"rgba(0,0,0,0.1)",padding:16,textStyle:{fontFamily:"JetBrains Mono",color:f?"#fff":"#0f172a"},axisPointer:{type:"cross",label:{backgroundColor:"#6366f1"},lineStyle:{type:"dashed",color:"#6366f1"}},formatter:u=>{if(!Array.isArray(u))return"";const w=u.filter(k=>k.seriesName!=="HitBox");if(w.length===0)return"";let z=`<div style="font-weight:bold;margin-bottom:8px">${w[0]?.axisValue}</div>`;return w.forEach(k=>{let O="";k.seriesName==="Âà©Ê∂¶Áéá"?O=`${k.value?.toFixed(1)}%`:k.seriesName==="ËÆ¢ÂçïÊï∞"?O=`${k.value}`:O=`¬•${(k.value||0).toLocaleString()}`,z+=`<div style="display:flex;justify-content:space-between;gap:16px">
            <span>${k.marker}${k.seriesName}</span>
            <span style="font-weight:bold">${O}</span>
          </div>`}),z}},legend:{data:["ÈîÄÂîÆÈ¢ù","ÊÄªÂà©Ê∂¶","Âà©Ê∂¶Áéá","ËÆ¢ÂçïÊï∞"],bottom:0,textStyle:{color:v,fontSize:10},itemGap:16,icon:"circle",itemWidth:10,itemHeight:10},xAxis:{type:"category",data:H,boundaryGap:!0,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:v,fontSize:10,fontFamily:"JetBrains Mono"}},yAxis:[{type:"value",name:"",splitLine:{lineStyle:{color:V,type:"dashed"}},axisLabel:{color:v,fontSize:10,formatter:u=>`¬•${u/1e3}k`}},{type:"value",name:"",position:"right",min:0,max:D.rateMax,splitLine:{show:!1},axisLabel:{color:v,fontSize:10,formatter:"{value}%"}},{type:"value",name:"",position:"left",show:!1,splitLine:{show:!1},min:0,max:100},{type:"value",name:"",position:"left",show:!1,splitLine:{show:!1},min:0,max:D.profitMax},{type:"value",name:"",position:"left",show:!1,splitLine:{show:!1},min:0,max:D.ordersMax}],series:[{name:"HitBox",type:"bar",yAxisIndex:2,data:M.map(()=>100),barWidth:"80%",barGap:"-100%",z:10,itemStyle:{color:"transparent"},tooltip:{show:!1},silent:!1},{name:"ËÆ¢ÂçïÊï∞",type:"bar",yAxisIndex:4,data:M.map(u=>{const w=r?u.fullDate>=r.start&&u.fullDate<=r.end:!1,z=s&&u.fullDate===s,k=w||z;return{value:u.orders,itemStyle:s||r?{borderRadius:[2,2,0,0],color:k?new de(0,0,0,1,[{offset:0,color:w?"#34d399":"#818cf8"},{offset:1,color:w?"#059669":"#6366f1"}]):new de(0,0,0,1,[{offset:0,color:f?"rgba(71, 85, 105, 0.2)":"rgba(71, 85, 105, 0.15)"},{offset:1,color:f?"rgba(51, 65, 85, 0.05)":"rgba(71, 85, 105, 0.02)"}]),shadowBlur:k?15:0,shadowColor:k?w?"rgba(52, 211, 153, 0.5)":"rgba(99, 102, 241, 0.5)":"transparent"}:{borderRadius:[2,2,0,0],color:new de(0,0,0,1,[{offset:0,color:f?"rgba(71, 85, 105, 0.55)":"rgba(71, 85, 105, 0.35)"},{offset:1,color:f?"rgba(51, 65, 85, 0.15)":"rgba(71, 85, 105, 0.05)"}])}}}),emphasis:{itemStyle:{color:new de(0,0,0,1,[{offset:0,color:f?"rgba(148, 163, 184, 0.95)":"rgba(100, 116, 139, 0.7)"},{offset:1,color:f?"rgba(100, 116, 139, 0.4)":"rgba(100, 116, 139, 0.2)"}]),shadowColor:f?"rgba(148, 163, 184, 0.4)":"rgba(100, 116, 139, 0.3)",shadowBlur:12}},barWidth:"60%",barGap:"-100%",z:1},{name:"ÊÄªÂà©Ê∂¶",type:"line",smooth:.4,symbol:"none",showSymbol:!1,yAxisIndex:3,itemStyle:{color:"#22c55e"},lineStyle:{width:2.5,color:"#22c55e",opacity:s?.3:1,shadowColor:"rgba(34, 197, 94, 0.7)",shadowBlur:10,shadowOffsetY:-4},emphasis:{focus:"series",itemStyle:{color:"#22c55e",borderColor:"#fff",borderWidth:2},lineStyle:{width:3,shadowBlur:14,shadowOffsetY:-5}},data:M.map(u=>u.profit),z:2},{name:"Âà©Ê∂¶Áéá",type:"line",smooth:.4,symbol:"none",showSymbol:!1,yAxisIndex:1,itemStyle:{color:"#fbbf24"},lineStyle:{width:2,color:"#fbbf24",type:[5,5],opacity:s?.3:1},emphasis:{focus:"series",itemStyle:{color:"#fbbf24",borderColor:"#fff",borderWidth:2},lineStyle:{width:2.5,type:"solid"}},data:q,z:3},{name:"ÈîÄÂîÆÈ¢ù",type:"line",smooth:.4,symbol:"none",showSymbol:!1,yAxisIndex:0,itemStyle:{color:f?"#f8fafc":"#334155"},lineStyle:{width:3,color:f?"#f8fafc":"#334155",opacity:s?.3:1,shadowColor:f?"rgba(255, 255, 255, 0.8)":"rgba(51, 65, 85, 0.5)",shadowBlur:20,shadowOffsetY:0},areaStyle:{opacity:s?.05:.2,color:new de(0,0,0,1,[{offset:0,color:"rgba(74, 144, 226, 0.3)"},{offset:1,color:"rgba(74, 144, 226, 0.05)"}])},emphasis:{focus:"series",itemStyle:{color:"#fff",borderColor:"#818cf8",borderWidth:2,shadowColor:"rgba(129, 140, 248, 0.5)",shadowBlur:10},lineStyle:{width:4}},data:M.map(u=>u.revenue),markPoint:o&&Y.length>0?{data:Y.filter(u=>u.xAxis!==void 0&&u.yAxis!==void 0&&!isNaN(u.yAxis)).map(u=>({name:u.name,coord:[u.xAxis,u.yAxis],itemStyle:u.itemStyle})),symbol:"pin",symbolSize:40,label:{show:!0,fontSize:8,formatter:"!"},animation:!0,animationDuration:800,animationEasing:"elasticOut"}:void 0,z:3}]},K=Yt(J,[t,o,l,c,x,s,r,D],l,te);return e.jsxs("div",{className:`glass-panel rounded-2xl p-6 h-full flex flex-col relative overflow-hidden group transition-all duration-300 ${s?"border-indigo-500/50 shadow-[0_0_30px_rgba(99,102,241,0.15)]":""}`,children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-24 bg-gradient-to-b from-indigo-500/5 to-transparent pointer-events-none"}),e.jsxs("div",{className:"mb-2 flex justify-between items-start relative z-10",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2",style:{color:P},children:[e.jsx("span",{className:"w-1 h-5 bg-gradient-to-b from-indigo-400 to-indigo-600 rounded-full shadow-[0_0_10px_#818cf8]"}),"ÈîÄÂîÆË∂ãÂäøÂàÜÊûê",s&&e.jsx("span",{className:"text-xs bg-indigo-500 text-white px-2 py-0.5 rounded-md font-mono ml-2",children:s.slice(5)})]}),e.jsxs("p",{className:"text-xs mt-1 font-mono uppercase tracking-widest opacity-70 flex items-center gap-1",style:{color:U},children:[x==="all"?"ÂÖ®ÈÉ®Ê∏†ÈÅì":x," ¬∑ Âê´Âà©Ê∂¶Áéá",a&&e.jsx("span",{className:"ml-2 text-indigo-400",children:"| ÁÇπÂáªÊü±Â≠ê‰∏ãÈíª"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Jt,{selectedChannel:x,channelList:C,onSelect:A,isDark:f}),e.jsxs("button",{onClick:()=>i(!o),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg border text-xs font-medium transition-all duration-300 ${o?"bg-rose-500/10 border-rose-500/30 text-rose-300 shadow-[0_0_15px_rgba(244,63,94,0.2)]":f?"bg-slate-800/50 border-white/5 text-slate-400 hover:text-white":"bg-white/50 border-black/5 text-slate-600 hover:text-slate-900"}`,children:[o?e.jsx(Se,{size:14,className:"animate-pulse"}):e.jsx(Se,{size:14}),o?"ÂºÇÂ∏∏ ON":"ÂºÇÂ∏∏ OFF"]})]})]}),g&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/10 z-20 rounded-2xl",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"})}),e.jsx("div",{className:"flex-1 w-full min-h-[350px] relative cursor-pointer",children:e.jsx("div",{ref:K,className:"absolute inset-0 w-full h-full"})})]})},Qt=({data:t,onLocate:l,activeFocus:a})=>{const[s,r]=n.useState(null),[o,i]=n.useState(!1);return n.useEffect(()=>{i(!0);const c=setTimeout(()=>{r({summary:"Ê£ÄÊµãÂà∞Â§ñÂçñÊ∏†ÈÅìËê•ÈîÄÊàêÊú¨ËøáÈ´òÔºåÊãñÁ¥ØÊï¥‰ΩìÂà©Ê∂¶„ÄÇÂª∫ËÆÆ‰ºòÂåñÊª°ÂáèÁ≠ñÁï•„ÄÇ",costProblem:"È•ø‰∫Ü‰πàÊ∏†ÈÅìËê•ÈîÄË°•Ë¥¥Âç†ÊØîËææ 20%ÔºåÂª∫ËÆÆÁº©ÂáèÊª°ÂáèÂäõÂ∫¶„ÄÇ",timeOpportunity:"ÂçàÈ´òÂ≥∞ (11:00-13:00) ËÆ¢ÂçïÂØÜÈõÜ‰ΩÜË∂ÖÊó∂‰∏•ÈáçÔºåÂª∫ËÆÆÂ¢ûÂä†ËøêÂäõË∞ÉÂ∫¶„ÄÇ",actionSuggestion:"Á´ãÂç≥Â§çÁõòË∑ùÁ¶ªÂú® 3km+ ÁöÑËÆ¢ÂçïÊØõÂà©ÔºåËÄÉËôëÁº©Â∞èÈÖçÈÄÅËåÉÂõ¥„ÄÇ"}),i(!1)},1e3);return()=>clearTimeout(c)},[t.lastUpdated]),o?e.jsxs("div",{className:"w-full h-full glass-panel border-neon-purple/30 rounded-2xl flex flex-col items-center justify-center animate-pulse gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-12 h-12 rounded-full border-4 border-neon-purple/30 border-t-neon-purple animate-spin"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(_t,{size:20,className:"text-neon-purple animate-pulse"})})]}),e.jsx("p",{className:"text-neon-purple font-mono text-xs tracking-widest",children:"AI NEURAL ENGINE PROCESSING..."})]}):s?e.jsxs("div",{className:"w-full h-full glass-panel rounded-2xl p-[1px] relative overflow-hidden group flex flex-col shadow-[0_0_30px_rgba(124,58,237,0.1)]",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-neon-purple via-neon-cyan to-transparent opacity-30 group-hover:opacity-60 transition-opacity duration-1000 blur-lg"}),e.jsxs("div",{className:"bg-slate-950/90 backdrop-blur-xl rounded-xl p-6 relative z-10 flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 border-b border-white/10 pb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-1.5 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-lg shadow-lg shadow-purple-500/20",children:e.jsx(Ye,{size:18,className:"text-white fill-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-bold text-white tracking-wide leading-tight",children:"AI ÂÜ≥Á≠ñÂ§ßËÑë"}),e.jsx("p",{className:"text-[11px] text-slate-400 font-mono",children:"CLICK TO LOCATE ISSUES"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] text-neon-green font-mono",children:"ACTIVE"}),e.jsx("div",{className:"h-2 w-2 bg-neon-green rounded-full shadow-[0_0_10px_#4ade80] animate-pulse"})]})]}),e.jsxs("div",{className:"mb-6 relative",children:[e.jsx("div",{className:"absolute -left-2 top-0 bottom-0 w-1 bg-gradient-to-b from-neon-purple to-transparent rounded-full opacity-50"}),e.jsxs("p",{className:"pl-4 text-lg font-medium text-white leading-relaxed italic",children:['"',s.summary,'"']})]}),e.jsxs("div",{className:"flex-1 flex flex-col gap-3 overflow-y-auto pr-1 custom-scrollbar",children:[e.jsx(we,{icon:e.jsx(Dt,{size:14,className:a==="cost"?"text-white":"text-neon-rose"}),tag:"ÊàêÊú¨Ê£ÄÊµã",value:s.costProblem,color:"rose",onClick:()=>l&&l("cost"),isActive:a==="cost"}),e.jsx(we,{icon:e.jsx(Rt,{size:14,className:a==="efficiency"?"text-white":"text-neon-yellow"}),tag:"ÊïàÁéáËØäÊñ≠",value:s.timeOpportunity,color:"yellow",onClick:()=>l&&l("efficiency"),isActive:a==="efficiency"}),e.jsx(we,{icon:e.jsx(He,{size:14,className:a==="profit"?"text-white":"text-neon-green"}),tag:"Â¢ûÈïøÂª∫ËÆÆ",value:s.actionSuggestion,color:"green",onClick:()=>l&&l("profit"),isActive:a==="profit"})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-white/5 flex justify-between items-center text-xs text-slate-400 group/btn cursor-pointer hover:text-white transition-colors",children:[e.jsx("span",{className:"font-mono",children:"GENERATE_REPORT.PDF"}),e.jsx(Ce,{size:14,className:"group-hover/btn:translate-x-1 transition-transform"})]})]})]}):null},we=({icon:t,tag:l,value:a,color:s,onClick:r,isActive:o})=>{const i={rose:"hover:bg-rose-500/10 hover:border-rose-500/40",yellow:"hover:bg-yellow-500/10 hover:border-yellow-500/40",green:"hover:bg-emerald-500/10 hover:border-emerald-500/40"},c={rose:"text-rose-400 bg-rose-500/10 border-rose-500/20",yellow:"text-yellow-400 bg-yellow-500/10 border-yellow-500/20",green:"text-emerald-400 bg-emerald-500/10 border-emerald-500/20"},d={rose:"bg-rose-500 border-rose-400 shadow-[0_0_20px_rgba(244,63,94,0.3)]",yellow:"bg-yellow-500 border-yellow-400 shadow-[0_0_20px_rgba(250,204,21,0.3)]",green:"bg-emerald-500 border-emerald-400 shadow-[0_0_20px_rgba(16,185,129,0.3)]"};return e.jsxs("button",{onClick:r,className:`relative p-3.5 rounded-xl border text-left transition-all duration-300 group/item flex flex-col gap-2 outline-none
        ${o?`${d[s]} scale-[1.02] z-10 border-transparent`:`border-white/5 bg-white/[0.02] ${i[s]} hover:scale-[1.01]`}
      `,children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:`flex items-center gap-2 px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider border ${o?"bg-white/20 text-white border-transparent":c[s]}`,children:[t,l]}),o?e.jsx(Se,{size:14,className:"text-white animate-pulse"}):e.jsx(Et,{size:14,className:"text-slate-600 group-hover/item:text-white transition-colors opacity-0 group-hover/item:opacity-100"})]}),e.jsx("p",{className:`text-xs leading-relaxed transition-colors ${o?"text-white/95 font-medium":"text-slate-400 group-hover/item:text-slate-200"}`,children:a})]})},Zt=({onCommand:t,isProcessing:l})=>{const[a,s]=n.useState(""),[r,o]=n.useState(!1),i=c=>{c.preventDefault(),a.trim()&&(t(a),s(""))};return e.jsxs("div",{className:`relative w-full max-w-2xl mx-auto transition-all duration-300 z-50 ${r?"scale-105":"scale-100"}`,children:[e.jsx("div",{className:`absolute -inset-1 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 rounded-2xl blur opacity-25 transition-opacity duration-500 ${r?"opacity-75":"opacity-25"}`}),e.jsxs("form",{onSubmit:i,className:"relative glass-panel rounded-xl p-1 flex items-center gap-2 shadow-2xl",children:[e.jsx("div",{className:"pl-3 text-neon-purple",children:e.jsx(Ye,{size:20,className:l?"animate-spin":""})}),e.jsx("input",{type:"text",value:a,onChange:c=>s(c.target.value),onFocus:()=>o(!0),onBlur:()=>o(!1),placeholder:l?"AI Ê≠£Âú®ÂàÜÊûêÊï∞ÊçÆ...":"Ask AI: 'Show me coffee sales from last weekend'...",className:"flex-1 bg-transparent border-none outline-none text-white placeholder-slate-400 h-10 px-2 font-mono text-sm",disabled:l}),e.jsxs("div",{className:"hidden md:flex items-center gap-1.5 px-2 py-1 bg-white/5 rounded text-[10px] text-slate-500 font-mono border border-white/5",children:[e.jsx(zt,{size:10}),e.jsx("span",{children:"K"})]}),e.jsx("button",{type:"submit",disabled:!a.trim()||l,className:"p-2 rounded-lg bg-indigo-600 hover:bg-indigo-500 text-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(Mt,{size:16})})]})]})},es=()=>{const[t,l]=n.useState(!1);return n.useEffect(()=>{let a=0,s=performance.now(),r=0,o;const i=()=>{const c=performance.now();if(a++,c-s>=1e3){if(a<35?r++:r=0,r>=3){l(!0);return}a=0,s=c}o=requestAnimationFrame(i)};return o=requestAnimationFrame(i),()=>cancelAnimationFrame(o)},[]),t};var le=(t=>(t.MEITUAN="ÁæéÂõ¢Â§ñÂçñ",t.ELEME="È•ø‰∫Ü‰πà",t.DOUYIN="ÊäñÈü≥Âõ¢Ë¥≠",t.OFFLINE="Á∫ø‰∏ãÈó®Â∫ó",t.PRIVATE_DOMAIN="ÁßÅÂüüÂ∞èÁ®ãÂ∫è",t))(le||{});const ts=(t,l)=>Array.from({length:24},(s,r)=>`${r.toString().padStart(2,"0")}:00`).map((s,r)=>{let o=.5;r>=11&&r<=13&&(o=2.5),r>=17&&r<=19&&(o=2);const i=Math.floor(t/30*o*(.8+Math.random()*.4));return{hour:s,orders:i,revenue:i*45,deliveryCost:i*l*(r>=11&&r<=13?1.2:1)}}),ss=t=>[{range:"0-1km",orders:Math.floor(t*.4),avgDeliveryCost:3.5},{range:"1-3km",orders:Math.floor(t*.45),avgDeliveryCost:5.8},{range:"3km+",orders:Math.floor(t*.15),avgDeliveryCost:9.2}],rs=(t,l,a)=>{const s=[],r=new Date,o=t/30,i=l/30;for(let c=29;c>=0;c--){const d=new Date(r);d.setDate(d.getDate()-c);const S=d.getDay()===0||d.getDay()===6?1.2:.9,h=.8+Math.random()*.4,y=Math.floor(o*S*h),x=Math.floor(y*(a+(Math.random()-.5)*.1));s.push({date:d.toISOString().split("T")[0].slice(5),revenue:y,profit:x,orders:Math.floor(i*S*h)})}return s},as=t=>{const l=[{name:"Áé∞Á£®ÂíñÂï°",items:["ÁîüÊ§∞ÊãøÈìÅ","ÂÜ∞ÁæéÂºè","ÁÑ¶Á≥ñÁéõÂ•áÊúµ","ÁáïÈ∫¶ÊãøÈìÅ","DirtyËÑèÂíñ","Âç°Â∏ÉÂ•áËØ∫","Êæ≥ÁôΩ","ÊÑèÂºèÊµìÁº©"],baseMargin:.65},{name:"‰∫∫Ê∞îÁÉ≠È£ü",items:["ËÄÅÂùõÈÖ∏ËèúÈ±º","Â∞èÁÇíÈªÑÁâõËÇâ","È∫ªÂ©ÜË±ÜËÖê","Á∫¢ÁÉßËÇâ","ÂÆ´‰øùÈ∏°‰∏Å","È±ºÈ¶ôËÇâ‰∏ù","Áï™ËåÑÁÇíËõã","Ê¢ÖËèúÊâ£ËÇâ","Â§ßÁõòÈ∏°"],baseMargin:.35},{name:"Ë∂ÖÂÄºÂ•óÈ§ê",items:["Âçï‰∫∫Â∑•‰ΩúÈ§ê","Âèå‰∫∫ÂàÜ‰∫´Ê°∂","ÂÖ®ÂÆ∂Á¶èÂ•óÈ§ê","ÂïÜÂä°‰ºöËÆÆÈ§ê","ÊÉÖ‰æ£Á∫¶‰ºöÈ§ê"],baseMargin:.25},{name:"ÁÉòÁÑôÁîúÁÇπ",items:["ÊèêÊãâÁ±≥Ëãè","Á∫ΩÁ∫¶ËäùÂ£´","Á∫¢‰∏ùÁªí","ÈªëÊ£ÆÊûó","Ê¶¥Ëé≤ÂçÉÂ±Ç","ËõãÊåû(3Âè™)","Ëè†ËêùÂåÖ"],baseMargin:.55}];let a=[];return l.forEach(s=>{s.items.forEach(r=>{const o=Math.random()*.1+.01,i=Math.floor(t*.25*o),c=s.baseMargin+(Math.random()*.2-.1),d=Math.floor(i*c),g=Math.floor(i/(30+Math.random()*20));a.push({name:`${s.name}|${r}`,revenue:i,cost:i-d,profit:d,grossMargin:c,orderCount:g,soldOutCount:0,slowMovingCount:0,inventoryTurnover:0})})}),a.sort((s,r)=>r.revenue-s.revenue).slice(0,50)},ns=(t,l)=>["0-20","20-40","40-60","60-80","80-100","100+"].map(s=>{let r=.1;return l<30&&s==="20-40"&&(r=.5),l>=30&&s==="40-60"&&(r=.4),{range:s,count:Math.floor(t*r*(.8+Math.random()*.4))}}),os=t=>({itemDiscount:t*.3,thresholdDiscount:t*.4,vouchers:t*.2,other:t*.1}),ls=t=>{const l=t/30,a=[],s=new Date;for(let r=6;r>=0;r--){const o=new Date(s);o.setDate(o.getDate()-r);const c=o.getDay()===0||o.getDay()===6?1.3:.9,d=l*c*(.9+Math.random()*.2);a.push({date:o.toISOString().split("T")[0].slice(5),itemDiscount:Math.floor(d*.3),thresholdDiscount:Math.floor(d*.4),vouchers:Math.floor(d*.2),other:Math.floor(d*.1)})}return a},fe=(t,l,a,s,r,o,i,c)=>{const d=a*r,g=a*o,S=a*i,h=s*c,y=d+g+S+h,x=a-y,A=x/a;return{id:t,name:l,revenue:a,costs:{cogs:d,marketing:g,delivery:h,commission:S},marketingDetails:os(g),marketingTrend:ls(g),totalCost:y,profit:x,marketingRate:g/a,profitMargin:A,orderCount:s,avgOrderValue:a/s,avgDeliveryCost:h/s,hourlyData:ts(s,c),distanceData:ss(s),dailyTrend:rs(a,s,A),categoryPerformance:as(a),aovDistribution:ns(s,a/s)}},is=()=>{const t=[fe("1",le.MEITUAN,45e4,11250,.35,.15,.18,6.5),fe("2",le.ELEME,38e4,9500,.35,.2,.16,6.2),fe("3",le.DOUYIN,6e5,15e3,.35,.25,.05,1.5),fe("4",le.OFFLINE,55e4,13750,.35,.02,.01,0),fe("5",le.PRIVATE_DOMAIN,2e5,4e3,.35,.05,.02,5)],l=t.reduce((r,o)=>r+o.revenue,0),a=t.reduce((r,o)=>r+o.profit,0),s=t.reduce((r,o)=>r+o.orderCount,0);return{totalRevenue:l,totalProfit:a,totalOrders:s,channels:t,lastUpdated:new Date().toLocaleString()}},cs=G.lazy(()=>W(()=>import("./ProfitChart-B36zanQP.js"),__vite__mapDeps([7,1,5,2,3,4]))),ds=G.lazy(()=>W(()=>import("./CostEfficiencyChart-ijZ2r8gP.js"),__vite__mapDeps([8,1,5,2,3,4]))),us=G.lazy(()=>W(()=>import("./CategoryAnalysisChart-DzroCrKO.js"),__vite__mapDeps([9,1,2,3,4,5]))),fs=G.lazy(()=>W(()=>import("./MarketingCostChart-BeFf4d6u.js"),__vite__mapDeps([10,1,3,2,4,5]))),xs=G.lazy(()=>W(()=>import("./DeliveryHeatmap-DZRC1M8P.js"),__vite__mapDeps([11,1,5,2,3,4]))),ps=G.lazy(()=>W(()=>import("./MarketingTrendChart-BobABcLk.js"),__vite__mapDeps([12,1,3,2,4,5]))),hs=G.lazy(()=>W(()=>import("./ProfitSimulator-CDW3ji-D.js"),__vite__mapDeps([13,1,2,3,4]))),ms=G.lazy(()=>W(()=>import("./DataTable-CsLDQxOM.js"),__vite__mapDeps([14,1,2,3,4]))),gs=G.lazy(()=>W(()=>import("./CategoryTrendChart-DUhPJXnP.js"),__vite__mapDeps([15,1,2,3,4,5]))),bs=G.lazy(()=>W(()=>import("./TopProductsChart-DqwfP41s.js"),__vite__mapDeps([16,1,5,2,3,4]))),ys=G.lazy(()=>W(()=>import("./CategoryHealthTable-EILpD1c9.js"),__vite__mapDeps([17,1,2,3,4,5]))),vs=G.lazy(()=>W(()=>import("./DistanceAnalysisChart-WO_BHQhL.js"),__vite__mapDeps([18,1,5,2,3,4]))),ws=G.lazy(()=>W(()=>import("./DataManagement-B5gBlpRv.js"),__vite__mapDeps([0,1,2,3,4,5]))),js=G.lazy(()=>W(()=>import("./StoreComparisonView-zvBTf09c.js"),__vite__mapDeps([6,1,2,3,4,5]))),Q=({height:t=400})=>e.jsx("div",{className:"glass-panel rounded-2xl flex items-center justify-center animate-pulse",style:{height:t},children:e.jsx("div",{className:"text-slate-500 text-sm",children:"ÂõæË°®Âä†ËΩΩ‰∏≠..."})}),me=({onExit:t})=>e.jsx("div",{className:"absolute top-4 right-4 z-[70] animate-fade-in-up",children:e.jsxs("button",{onClick:l=>{l.stopPropagation(),t()},className:"group flex items-center gap-2 pl-2 pr-2 py-1.5 bg-slate-800/80 backdrop-blur-md text-white border border-white/20 rounded-lg hover:bg-slate-700 transition-all duration-200 shadow-lg",children:[e.jsx("span",{className:"text-[10px] font-mono font-bold tracking-wider text-slate-300 group-hover:text-white",children:"MINIMIZE"}),e.jsx(Ke,{size:14,className:"text-indigo-400 group-hover:text-indigo-300"})]})}),Ns=G.lazy(()=>W(()=>import("./Skeleton-BogUu1F4.js"),__vite__mapDeps([19,1])).then(t=>({default:t.DashboardSkeleton}))),Ss=()=>e.jsxs("div",{className:"min-h-screen bg-slate-950 p-8 grid grid-cols-12 gap-6 animate-pulse",children:[e.jsx("div",{className:"col-span-12 h-20 bg-white/5 rounded-xl"}),[...Array(6)].map((t,l)=>e.jsx("div",{className:"col-span-6 lg:col-span-2 h-32 bg-white/5 rounded-2xl"},l)),e.jsx("div",{className:"col-span-12 xl:col-span-8 h-[550px] bg-white/5 rounded-2xl"}),e.jsx("div",{className:"col-span-12 xl:col-span-4 h-[550px] bg-white/5 rounded-2xl"})]});function Cs({theme:t}){const[l,a]=n.useState(null),[s,r]=n.useState(null),[o,i]=n.useState(!1),[c,d]=n.useState([]),[g,S]=n.useState(!1),[h,y]=n.useState(null),[x,A]=n.useState(!1),[C,f]=n.useState(null),[v,P]=n.useState(null),[U,V]=n.useState(void 0),[j,H]=n.useState(null),[X,M]=n.useState(30),[Y,q]=n.useState(null),[Z,te]=n.useState("all"),{orderOverview:D,orderComparison:J,orderOverviewLoading:K,dateRange:u,selectedStore:w,selectedChannel:z}=be(),k=es(),O=n.useRef(null),p=n.useRef(null),T=n.useRef(null),N=n.useRef(null),L=n.useRef(null),$=n.useCallback(async()=>{if(!w){d([]);return}S(!0);try{const m={store_name:w};u.type!=="all"&&u.start&&u.end&&(m.start_date=u.start,m.end_date=u.end);const E=await ae.getMarketingStructure(m);E.success&&E.data.channels.length>0?d(E.data.channels):d([])}catch(m){console.error("Ëé∑ÂèñËê•ÈîÄÊàêÊú¨ÁªìÊûÑÊï∞ÊçÆÂ§±Ë¥•:",m),d([])}finally{S(!1)}},[w,u.type,u.start,u.end]);n.useEffect(()=>{$()},[$]);const I=n.useCallback(async()=>{if(console.log("üìà fetchMarketingTrend Ë∞ÉÁî®, selectedStore:",w),!w){console.log("üìà Êú™ÈÄâÊã©Èó®Â∫óÔºåË∑≥ËøáËê•ÈîÄË∂ãÂäøÊï∞ÊçÆÂä†ËΩΩ"),y(null);return}A(!0),f(null);try{const m={store_name:w};Z&&Z!=="all"&&(m.channel=Z),u.type!=="all"&&u.start&&u.end&&(m.start_date=u.start,m.end_date=u.end),console.log("üìà Ëê•ÈîÄË∂ãÂäøËØ∑Ê±ÇÂèÇÊï∞:",m);const E=await ae.getMarketingTrend(m);console.log("üìà Ëê•ÈîÄË∂ãÂäøAPIÂìçÂ∫î:",E),E.success&&E.data.dates.length>0?(console.log("üìà Ëê•ÈîÄË∂ãÂäøÊï∞ÊçÆÂä†ËΩΩÊàêÂäü, Êó•ÊúüÊï∞:",E.data.dates.length),y(E.data),f(null)):(console.log("üìà Ëê•ÈîÄË∂ãÂäøÊï∞ÊçÆ‰∏∫Á©∫"),y(null))}catch(m){console.error("üìà Ëé∑ÂèñËê•ÈîÄÊàêÊú¨Ë∂ãÂäøÊï∞ÊçÆÂ§±Ë¥•:",m),f("Êï∞ÊçÆÂä†ËΩΩÂ§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï")}finally{A(!1)}},[w,Z,u.type,u.start,u.end]);n.useEffect(()=>{I()},[I]),n.useEffect(()=>{const m=setTimeout(()=>{const E=is();a(E)},100);return()=>clearTimeout(m)},[u]),n.useEffect(()=>{s?document.body.classList.add("has-focus"):document.body.classList.remove("has-focus")},[s]),n.useEffect(()=>{const m=E=>{E.key==="Escape"&&r(null)};return window.addEventListener("keydown",m),()=>window.removeEventListener("keydown",m)},[]);const ee=n.useCallback((m,E,se)=>{if(se!==void 0&&M(se),m===null){P(null),V(void 0),H(null);return}if(j){H(null),P(m),V(E);return}if(v&&E!==void 0){if(v===m){P(null),V(void 0);return}const xe=v<m?v:m,Ze=v<m?m:v,et=v<m?U:E,tt=v<m?E:U;H({start:xe,end:Ze,startIndex:et,endIndex:tt}),P(null),V(void 0);return}P(m),V(E)},[v,U,j]),ce=n.useCallback((m,E,se,xe)=>{console.log("üìä Ë∑ùÁ¶ªÂå∫Èó¥ÈÄâ‰∏≠:",m,E,se,"-",xe,"km"),q(m===-1?null:{minDistance:se,maxDistance:xe})},[]),b=async m=>{i(!0),await new Promise(E=>setTimeout(E,1500)),i(!1),console.log("AI Command:",m)},_=m=>{if(s===m){r(null);return}r(m);const se={trend:O,efficiency:p,cost:T,profit:N}[m];se?.current&&setTimeout(()=>se.current?.scrollIntoView({behavior:"smooth",block:"center"}),100)},F=m=>s===m?"is-focused relative":"",B=n.useMemo(()=>l||null,[l]);return B?e.jsxs("div",{className:"flex flex-col gap-6 relative z-10 w-full transition-all duration-500",children:[e.jsxs("div",{className:`flex flex-col xl:flex-row justify-between items-start xl:items-center gap-4 animate-fade-in-up transition-opacity duration-500 ${s?"opacity-20 blur-sm pointer-events-none":"opacity-100"}`,children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white flex items-center gap-2 tracking-tight",children:"ËøêËê•ËØäÊñ≠‰∏≠ÂøÉ"}),e.jsxs("p",{className:"text-slate-400 text-xs mt-1 font-mono opacity-60 flex items-center gap-2",children:["SYSTEM: ONLINE",k&&e.jsxs("span",{className:"text-neon-yellow flex items-center gap-1",children:[e.jsx(We,{size:10})," LITE"]})]})]}),e.jsx("div",{className:"flex flex-col sm:flex-row items-center gap-4 w-full xl:w-auto",children:e.jsx("div",{className:"w-full sm:w-auto flex-1",children:e.jsx(Zt,{onCommand:b,isProcessing:o})})})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-6 w-full pb-12",children:[e.jsx("div",{className:"col-span-6 lg:col-span-2 animate-fade-in-up stagger-1",children:e.jsx(re,{title:"ËÆ¢ÂçïÊÄªÊï∞",value:D?D.total_orders.toLocaleString():"-",change:J?.changes?.order_count,subtext:"ÁéØÊØî",icon:e.jsx(Lt,{size:18}),iconColor:"indigo",theme:t,loading:K,compact:!0})}),e.jsx("div",{className:"col-span-6 lg:col-span-2 animate-fade-in-up stagger-2",children:e.jsx(re,{title:"ÂïÜÂìÅÂÆûÊî∂È¢ù",value:D?`¬•${D.total_actual_sales.toLocaleString()}`:"-",change:J?.changes?.total_sales,subtext:"ÁéØÊØî",icon:e.jsx(Re,{size:18}),iconColor:"cyan",theme:t,loading:K,compact:!0})}),e.jsx("div",{className:"col-span-6 lg:col-span-2 animate-fade-in-up stagger-3",children:e.jsx(re,{title:"ÊÄªÂà©Ê∂¶",value:D?`¬•${D.total_profit.toLocaleString()}`:"-",change:J?.changes?.total_profit,subtext:"ÁéØÊØî",icon:e.jsx(At,{size:18}),iconColor:"emerald",trendColor:(J?.changes?.total_profit??0)<0?"red":"green",theme:t,loading:K,compact:!0})}),e.jsx("div",{className:"col-span-6 lg:col-span-2 animate-fade-in-up stagger-4",children:e.jsx(re,{title:"Âπ≥ÂùáÂÆ¢Âçï‰ª∑",value:D?`¬•${D.avg_order_value.toFixed(1)}`:"-",change:J?.changes?.avg_order_value,subtext:"ÁéØÊØî",icon:e.jsx(Ge,{size:18}),iconColor:"amber",theme:t,loading:K,compact:!0})}),e.jsx("div",{className:"col-span-6 lg:col-span-2 animate-fade-in-up stagger-5",children:e.jsx(re,{title:"ÊÄªÂà©Ê∂¶Áéá",value:D?`${D.profit_rate.toFixed(1)}%`:"-",change:J?.changes?.profit_rate,subtext:"ÁéØÊØî(ÁôæÂàÜÁÇπ)",icon:e.jsx(Ee,{size:18}),iconColor:"violet",trendColor:(J?.changes?.profit_rate??0)<0?"red":"green",theme:t,loading:K,compact:!0,isPercentChange:!0})}),e.jsx("div",{className:"col-span-6 lg:col-span-2 animate-fade-in-up stagger-6",children:e.jsx(re,{title:"Âä®ÈîÄÂïÜÂìÅÊï∞",value:D?D.active_products.toLocaleString():"-",change:J?.changes?.active_products,subtext:"ÁéØÊØî",icon:e.jsx(Tt,{size:18}),iconColor:"rose",theme:t,loading:K,compact:!0})}),e.jsx("div",{className:"col-span-6 lg:col-span-3 animate-fade-in-up stagger-7",children:e.jsx(re,{title:"Ëê•‰∏öÈ¢ù(GMV)",value:D?.gmv?`¬•${D.gmv.toLocaleString()}`:"-",subtext:"ÂïÜÂìÅÂéü‰ª∑√óÈîÄÈáè+ÊâìÂåÖË¥π+ÈÖçÈÄÅË¥π",icon:e.jsx(Re,{size:18}),iconColor:"orange",theme:t,loading:K,compact:!0})}),e.jsx("div",{className:"col-span-6 lg:col-span-3 animate-fade-in-up stagger-8",children:e.jsx(re,{title:"Ëê•ÈîÄÊàêÊú¨Áéá",value:D?.marketing_cost_rate!==void 0?`${D.marketing_cost_rate.toFixed(2)}%`:"-",subtext:D?.marketing_cost?`Ëê•ÈîÄÊàêÊú¨: ¬•${D.marketing_cost.toLocaleString()}`:"Ëê•ÈîÄÊàêÊú¨/GMV",icon:e.jsx(Ee,{size:18}),iconColor:"pink",trendColor:(D?.marketing_cost_rate??0)>15?"red":"green",theme:t,loading:K,compact:!0})}),e.jsxs("div",{ref:O,className:`col-span-12 xl:col-span-8 h-[550px] animate-fade-in-up stagger-7 ${F("trend")}`,children:[s==="trend"&&e.jsx(me,{onExit:()=>r(null)}),e.jsx(Xt,{data:B.channels,theme:t,onDateSelect:ee,selectedDate:v,selectedDateRange:j?{start:j.start,end:j.end}:void 0})]}),e.jsx("div",{className:"col-span-12 xl:col-span-4 h-[550px] animate-fade-in-up stagger-8 z-30",children:e.jsx(Qt,{data:B,onLocate:_,activeFocus:s})}),(v||j)&&e.jsxs("div",{className:"col-span-12 xl:col-span-8 relative h-10 -mt-4 -mb-2 z-0 animate-fade-in-up",children:[v&&!j&&e.jsxs("div",{className:"absolute flex flex-col items-center text-indigo-400 transition-all duration-300",style:{left:U!==void 0?`calc(50px + ${(U+.5)/X*85}%)`:"50%",transform:"translateX(-50%)"},children:[e.jsx("div",{className:"h-6 w-0.5 bg-gradient-to-b from-indigo-500/0 via-indigo-500 to-indigo-500"}),e.jsxs("div",{className:"px-3 py-1 bg-indigo-500/10 border border-indigo-500/30 rounded-full text-[10px] font-mono flex items-center gap-2 whitespace-nowrap",children:[e.jsx(ze,{size:10})," ÁÇπÂáªÂè¶‰∏ÄÊó•ÊúüÂΩ¢ÊàêËåÉÂõ¥ | ",v?.slice(5)]})]}),j&&e.jsxs("div",{className:"absolute flex flex-col items-center text-emerald-400 transition-all duration-300",style:{left:`calc(50px + ${(j.startIndex+j.endIndex+1)/2/X*85}%)`,transform:"translateX(-50%)"},children:[e.jsx("div",{className:"h-6 w-0.5 bg-gradient-to-b from-emerald-500/0 via-emerald-500 to-emerald-500"}),e.jsxs("div",{className:"px-3 py-1 bg-emerald-500/10 border border-emerald-500/30 rounded-full text-[10px] font-mono flex items-center gap-2 whitespace-nowrap",children:[e.jsx(ze,{size:10})," Êó•ÊúüËåÉÂõ¥: ",j.start.slice(5)," ~ ",j.end.slice(5)]})]})]}),(v||j)&&e.jsx("div",{className:"hidden xl:block xl:col-span-4"}),e.jsxs("div",{ref:L,className:`col-span-12 grid grid-cols-12 gap-6 transition-all duration-500 ${v||j?"bg-indigo-900/5 p-4 rounded-3xl border border-indigo-500/10":""}`,children:[e.jsx("div",{className:"col-span-12 lg:col-span-6 h-[400px] animate-fade-in-up stagger-2",children:e.jsx(n.Suspense,{fallback:e.jsx(Q,{height:400}),children:e.jsx(gs,{selectedDate:v,selectedDateRange:j?{start:j.start,end:j.end}:void 0,theme:t})})}),e.jsx("div",{className:"col-span-12 lg:col-span-6 h-[400px] animate-fade-in-up stagger-2",children:e.jsx(n.Suspense,{fallback:e.jsx(Q,{height:400}),children:e.jsx(bs,{selectedDate:v,selectedDateRange:j?{start:j.start,end:j.end}:void 0,theme:t})})})]}),e.jsxs("div",{ref:p,className:`col-span-12 xl:col-span-6 h-[450px] animate-enter stagger-7 ${F("efficiency")}`,children:[s==="efficiency"&&e.jsx(me,{onExit:()=>r(null)}),e.jsx(n.Suspense,{fallback:e.jsx(Q,{height:450}),children:e.jsx(ds,{storeName:w||void 0,channel:z==="all"?void 0:z,theme:t,selectedDate:v,selectedDateRange:j?{start:j.start,end:j.end}:void 0})})]}),e.jsx("div",{className:"col-span-12 xl:col-span-6 h-[450px] animate-enter stagger-8",children:e.jsx(n.Suspense,{fallback:e.jsx(Q,{height:450}),children:e.jsx(vs,{storeName:w||void 0,channel:z==="all"?void 0:z,theme:t,selectedDate:v,selectedDateRange:j?{start:j.start,end:j.end}:void 0,onDistanceBandSelect:ce})})}),e.jsxs("div",{ref:T,className:`col-span-12 lg:col-span-6 h-[450px] animate-enter stagger-8 ${F("cost")}`,children:[s==="cost"&&e.jsx(me,{onExit:()=>r(null)}),e.jsx(n.Suspense,{fallback:e.jsx(Q,{height:450}),children:g?e.jsx("div",{className:"glass-panel rounded-2xl p-6 h-full flex items-center justify-center",children:e.jsx("div",{className:"text-slate-400 text-sm",children:"Âä†ËΩΩËê•ÈîÄÊàêÊú¨Êï∞ÊçÆ‰∏≠..."})}):e.jsx(cs,{data:c,theme:t})})]}),e.jsx("div",{className:"col-span-12 lg:col-span-6 h-[450px] animate-enter stagger-9",children:e.jsx(n.Suspense,{fallback:e.jsx(Q,{height:450}),children:e.jsx(ps,{data:h,theme:t,loading:x,error:C,selectedChannel:Z,onChannelChange:te})})}),e.jsx("div",{className:"col-span-12 h-[450px] animate-enter stagger-10",children:e.jsx(n.Suspense,{fallback:e.jsx(Q,{height:450}),children:e.jsx(xs,{theme:t,selectedDistanceBand:Y,storeName:w||void 0,selectedDate:v,selectedDateRange:j?{start:j.start,end:j.end}:void 0})})}),e.jsxs("div",{ref:N,className:`col-span-12 h-[800px] animate-enter stagger-1 ${F("profit")}`,children:[s==="profit"&&e.jsx(me,{onExit:()=>r(null)}),e.jsx(n.Suspense,{fallback:e.jsx(Q,{height:800}),children:e.jsx(us,{data:l.channels,theme:t})})]}),e.jsx("div",{className:"col-span-12 h-[500px] animate-enter stagger-2",children:e.jsx(n.Suspense,{fallback:e.jsx(Q,{height:500}),children:e.jsx(ys,{theme:t})})}),e.jsx("div",{className:"col-span-12 lg:col-span-6 h-[450px] animate-enter stagger-3",children:e.jsx(n.Suspense,{fallback:e.jsx(Q,{height:450}),children:e.jsx(fs,{data:B.channels,theme:t})})}),e.jsx("div",{className:"col-span-12 lg:col-span-6 h-[450px] animate-enter stagger-4",children:e.jsx(n.Suspense,{fallback:e.jsx(Q,{height:450}),children:e.jsx(hs,{data:B})})}),e.jsx("div",{className:`col-span-12 animate-enter stagger-5 ${s?"opacity-20 blur-sm pointer-events-none":"opacity-100"}`,children:e.jsx(n.Suspense,{fallback:e.jsx(Q,{height:400}),children:e.jsx(ms,{data:B.channels})})})]}),s&&e.jsx("div",{className:"fixed bottom-6 left-1/2 -translate-x-1/2 glass-panel text-white px-4 py-2 rounded-full shadow-2xl z-[100] animate-bounce",children:e.jsxs("p",{className:"text-xs font-mono font-bold tracking-widest flex items-center gap-2",children:[e.jsx(Ke,{size:12})," PRESS ESC TO EXIT"]})})]}):e.jsx(n.Suspense,{fallback:e.jsx(Ss,{}),children:e.jsx(Ns,{})})}function ks(){const[t,l]=n.useState("dark");return n.useEffect(()=>{t==="light"?document.body.classList.add("light-mode"):document.body.classList.remove("light-mode")},[t]),e.jsx(qt,{theme:t,onToggleTheme:()=>l(a=>a==="dark"?"light":"dark"),children:e.jsxs(at,{children:[e.jsx(ne,{path:"/",element:e.jsx(Cs,{theme:t})}),e.jsx(ne,{path:"/data",element:e.jsx(n.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:e.jsx("div",{className:"text-slate-400",children:"Âä†ËΩΩ‰∏≠..."})}),children:e.jsx(ws,{})})}),e.jsx(ne,{path:"/stores",element:e.jsx(n.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:e.jsx("div",{className:"text-slate-400",children:"Âä†ËΩΩ‰∏≠..."})}),children:e.jsx(js,{theme:t})})}),e.jsx(ne,{path:"/channels",element:e.jsx(je,{title:"Ê∏†ÈÅìÂàÜÊûê"})}),e.jsx(ne,{path:"/trends",element:e.jsx(je,{title:"Ë∂ãÂäøÊ¥ûÂØü"})}),e.jsx(ne,{path:"/settings",element:e.jsx(je,{title:"Á≥ªÁªüËÆæÁΩÆ"})})]})})}const je=({title:t})=>e.jsxs("div",{className:"flex flex-col items-center justify-center h-[60vh] text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üöß"}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:t}),e.jsx("p",{className:"text-slate-400",children:"ÂäüËÉΩÂºÄÂèë‰∏≠ÔºåÊï¨ËØ∑ÊúüÂæÖ..."})]});class _s extends G.Component{constructor(l){super(l),this.state={hasError:!1,error:null}}static getDerivedStateFromError(l){return{hasError:!0,error:l}}componentDidCatch(l,a){console.error("Uncaught error:",l,a)}render(){return this.state.hasError?e.jsxs("div",{style:{padding:"40px",color:"#f87171",backgroundColor:"#1e293b",height:"100vh",fontFamily:"monospace"},children:[e.jsx("h1",{style:{fontSize:"24px",marginBottom:"20px"},children:"‚ö†Ô∏è System Malfunction"}),e.jsx("p",{style:{color:"#cbd5e1"},children:"The dashboard encountered a critical error while rendering."}),e.jsx("pre",{style:{marginTop:"20px",padding:"20px",backgroundColor:"#0f172a",borderRadius:"8px",overflow:"auto"},children:this.state.error?.message}),e.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"20px",padding:"10px 20px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Reboot System"})]}):this.props.children}}const Qe=document.getElementById("root");if(!Qe)throw new Error("Could not find root element to mount to");const Ds=nt.createRoot(Qe);Ds.render(e.jsx(G.StrictMode,{children:e.jsx(ot,{children:e.jsx(Pt,{children:e.jsx(_s,{children:e.jsx(ks,{})})})})}));export{Jt as C,re as S,be as a,ke as b,Ae as d,ae as o,R as r,Yt as u};
