# 🤝 新需求融合与验证协作流程

## 📋 **字段发现与验证清单**

### **当我发现新字段时，会向您确认：**

#### **1. 字段含义确认**
```
🤔 发现新字段: '新字段名'
   数据类型: xxx
   示例值: [样例数据]
   
   请确认:
   ❓ 这个字段代表什么业务含义？
   ❓ 与现有字段是什么关系？
   ❓ 需要参与哪些计算？
```

#### **2. 计算逻辑验证**
```
🧮 计算逻辑确认: 
   根据新字段，我推导的计算公式是：
   计算公式 = xxx + yyy - zzz
   
   请验证:
   ❓ 这个公式是否正确？
   ❓ 是否有特殊的业务规则？
   ❓ 边界情况如何处理？
```

#### **3. 聚合维度确认**
```
📊 聚合维度确认:
   新字段可能的分析维度：
   - 按订单聚合: sum/mean/max/min
   - 按商品聚合: xxx
   - 按时间聚合: xxx
   
   请确认:
   ❓ 哪些聚合维度是有意义的？
   ❓ 聚合方式是否正确？
```

## 🔍 **典型验证场景**

### **场景1: 新的成本字段**
```
发现字段: '新平台费用'
我的推测: 可能是新增的平台收费项
需要确认:
❓ 是否应该加入利润计算？
❓ 与现有'平台佣金'是什么关系？
❓ 按什么级别聚合（订单级/商品级）？
```

### **场景2: 新的分类维度**  
```
发现字段: '商品子品类'
我的推测: 比三级分类更细的分类
需要确认:
❓ 与现有分类体系的层级关系？
❓ 是否需要重新设计商品角色分配逻辑？
❓ 在竞对分析中如何匹配？
```

### **场景3: 新的时间维度**
```
发现字段: '商品上架时间'
我的推测: 商品生命周期相关
需要确认:
❓ 如何与下单时间配合分析？
❓ 是否需要计算商品存活周期？
❓ 对销量预测有什么影响？
```

### **场景4: 新的客户维度**
```
发现字段: '客户等级', '客户复购次数'
我的推测: 客户画像相关
需要确认:
❓ 如何影响定价策略？
❓ 与配送费用有关系吗？
❓ 需要按客户维度分析什么指标？
```

## 🎯 **数据验证检查点**

### **自动验证项目**
```python
AUTO_VALIDATION_CHECKS = {
    '数值一致性': '总和是否平衡，比率是否合理',
    '逻辑一致性': '订单级聚合vs商品级聚合是否匹配',
    '时间一致性': '时间字段是否在合理范围内',
    '分类一致性': '新分类与现有分类体系是否兼容',
    '金额一致性': '各种费用、利润计算是否正确'
}
```

### **人工验证问题**
```python
MANUAL_VALIDATION_QUESTIONS = [
    "❓ 这个计算结果看起来合理吗？",
    "❓ 异常值是数据问题还是业务特殊情况？", 
    "❓ 新指标的业务含义我理解对了吗？",
    "❓ 这个聚合逻辑符合实际业务场景吗？",
    "❓ 缺失数据应该如何处理？"
]
```

## 🔧 **迭代优化流程**

### **第1轮：初步融合**
```
1. 我分析新字段并给出初步理解
2. 您确认或纠正我的理解  
3. 我调整计算逻辑并重新分析
4. 输出初步分析结果
```

### **第2轮：准确性验证** 
```
1. 您检查分析结果的准确性
2. 指出计算错误或逻辑问题
3. 我修正算法并重新计算
4. 输出修正后的结果
```

### **第3轮：业务优化**
```
1. 基于准确的计算结果优化AI模型
2. 调整预测算法和建议逻辑
3. 增强可视化展示
4. 完善自适应学习机制
```

## 💡 **主动提问模板**

### **当遇到不确定情况时，我会这样问您：**

#### **计算逻辑类**
```
🤔 计算确认：
我发现 [字段A] 和 [字段B] 可能有关联
当前计算: 结果 = A * B / C
但我不确定是否应该: 结果 = A + B - C
请问哪种计算方式符合业务逻辑？
```

#### **数据异常类**
```
⚠️ 数据异常：
我发现某些订单的 [利润额] 为负值
样例: 订单123456 利润额=-50元
这是正常的业务情况吗？还是数据错误？
如果正常，在分析中应该如何处理？
```

#### **业务规则类**
```
📋 业务规则：
关于 [商品角色分配]，我看到现有规则是：
- 引流品：价格0-10元且销量>10
但新数据中出现了销量很高但价格>10元的商品
请问是否需要调整规则？或者这些属于什么角色？
```

## ✅ **确认机制**

每次分析完成后，我会提供：
```
📊 分析结果概览
   - 新增字段: X个
   - 调整计算: Y处  
   - 发现异常: Z个
   
🎯 请您验证：
   1. 计算结果是否准确
   2. 业务逻辑是否正确
   3. 是否还有遗漏的维度
   
💬 如有问题，请指出具体位置，我立即调整
```

现在我已经准备好了这种协作模式！请提供您的数据，我会仔细分析每个新字段，主动向您确认不确定的地方，确保分析的准确性和实用性。🚀