# 看板启动模式说明

## 📋 两种启动方式

### 1️⃣ 生产模式（推荐日常使用）
```powershell
.\启动看板.ps1
```

**特点：**
- ✅ 稳定高效，适合长期运行
- ✅ 性能最优，内存占用低
- ✅ 日志简洁，只显示关键信息
- ✅ 适合多人同时访问

**适用场景：**
- 日常业务分析
- 多用户同时使用
- 长时间运行

---

### 2️⃣ 调试模式（排查问题时使用）
```powershell
.\启动看板-调试模式.ps1
```

**特点：**
- 🐛 显示详细错误堆栈
- 📊 实时显示所有回调日志
- 🔄 代码热重载（保存后自动刷新）
- 📝 完整的请求响应日志

**适用场景：**
- 开发新功能
- 排查错误问题
- 查看详细运行日志
- 测试回调函数

---

## 🎯 通过环境变量控制

### Windows PowerShell
```powershell
# 临时启用调试模式
$env:DASH_DEBUG = "true"
python "智能门店看板_Dash版.py"

# 清理环境变量
Remove-Item Env:DASH_DEBUG
```

### CMD
```cmd
set DASH_DEBUG=true
python "智能门店看板_Dash版.py"
set DASH_DEBUG=
```

### Linux/Mac
```bash
DASH_DEBUG=true python "智能门店看板_Dash版.py"
```

---

## 🔍 调试模式日志示例

生产模式输出：
```
INFO:werkzeug:127.0.0.1 - - [22/Nov/2025 16:38:06] "GET /_dash-layout HTTP/1.1" 200 -
```

调试模式输出：
```
DEBUG:dash.callback:Callback update_store_list was triggered
DEBUG:dash.callback:  Input values: {'n_intervals': 0}
DEBUG:dash.callback:  Callback returned: [{'label': '祥和路店', 'value': 1}]
INFO:werkzeug:127.0.0.1 - - [22/Nov/2025 16:38:06] "POST /_dash-update-component HTTP/1.1" 200 -
  Exception on /_dash-layout [GET]
  Traceback (most recent call last):
    File "...", line 123, in function_name
      ...详细堆栈信息...
```

---

## 🚨 常见问题

### Q: 调试模式会影响性能吗？
A: 是的，调试模式会：
- 增加约 10-20% 的响应延迟
- 增加约 30-50MB 的内存占用
- 生成大量日志文件

### Q: 可以同时运行两个模式吗？
A: 不可以，8050 端口只能被一个进程占用。启动脚本会自动检测并停止现有实例。

### Q: 如何查看历史日志？
A: 调试模式的日志会实时显示在终端。如需保存：
```powershell
.\启动看板-调试模式.ps1 | Tee-Object -FilePath "debug_$(Get-Date -Format 'yyyyMMdd_HHmmss').log"
```

### Q: 推送到 GitHub 后公司电脑能正常启动吗？
A: 完全可以！默认是生产模式（debug=False），公司电脑拉取后直接运行 `.\启动看板.ps1` 即可。

---

## 📌 推荐使用方式

| 场景 | 启动方式 | Debug模式 |
|------|----------|-----------|
| 日常使用 | `.\启动看板.ps1` | ❌ False |
| 开发调试 | `.\启动看板-调试模式.ps1` | ✅ True |
| 生产部署 | `.\启动看板.ps1` | ❌ False |
| 错误排查 | `.\启动看板-调试模式.ps1` | ✅ True |

---

## 🎓 技术细节

### 调试模式启用的功能
1. **Werkzeug Debugger** - 交互式错误页面
2. **详细日志记录** - 所有回调、请求、异常
3. **代码热重载** - 修改 .py 文件后自动重启
4. **性能分析** - 显示每个回调的执行时间

### 生产模式优化
1. **关闭调试器** - 减少安全风险
2. **精简日志** - 只记录关键信息
3. **禁用热重载** - 避免意外重启
4. **优化内存** - 移除调试符号表

---

**最后更新**: 2025年11月22日  
**版本**: v1.0
