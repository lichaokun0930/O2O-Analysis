# 启动自检说明

## 📋 两个版本

项目提供了两个版本的启动自检：

### 1. 简易启动自检（推荐用于启动脚本）⭐
**文件**: `简易启动自检.py`

**特点**:
- ✅ 快速（<2秒）
- ✅ 无复杂导入
- ✅ 避免dash模块冲突
- ✅ 检查最关键的3项

**检查项目**:
1. Python版本
2. Redis服务
3. 数据库连接

**使用场景**:
- 看板启动时自动运行
- 快速检查系统状态
- 避免导入冲突

**运行方式**:
```powershell
python 简易启动自检.py
```

---

### 2. 完整启动自检（用于详细诊断）
**文件**: `启动自检.py`

**特点**:
- ✅ 全面（7项检查）
- ✅ 详细信息
- ✅ 修复建议
- ⚠️ 可能有导入冲突

**检查项目**:
1. Python版本
2. 必需包
3. 数据库连接
4. Redis缓存（使用子进程）
5. 数据文件
6. 磁盘空间
7. 可用内存

**使用场景**:
- 手动详细诊断
- 排查复杂问题
- 获取完整系统信息

**运行方式**:
```powershell
python 启动自检.py
```

---

## 🔧 启动脚本配置

### 当前配置
`启动看板.ps1` 使用 **简易启动自检**

```powershell
# ========== V8.9: 启动自检 ==========
Write-Host "🔍 运行系统自检..." -ForegroundColor Yellow
$checkResult = & $pythonExe "简易启动自检.py" 2>&1
$checkExitCode = $LASTEXITCODE

if ($checkExitCode -eq 0) {
    Write-Host "✅ 系统自检通过" -ForegroundColor Green
} else {
    Write-Host "⚠️  系统自检发现问题" -ForegroundColor Yellow
}
```

### 为什么使用简易版？
1. **避免导入冲突**: 不会触发dash模块导入
2. **启动更快**: 只检查关键项目
3. **更稳定**: 减少潜在错误

---

## 📊 输出对比

### 简易版输出
```
============================================================
 简易启动自检
============================================================

[1/3] Python版本... ✅ Python 3.11.9
[2/3] Redis服务... ✅ Redis服务正常
[3/3] 数据库连接... ✅ 数据库连接正常

============================================================
 ✅ 所有检查通过
============================================================
```

### 完整版输出
```
================================================================================
 🔍 系统启动自检
================================================================================

[1/7] Python版本...      ✅ Python版本正常（3.11.9）
[2/7] 必需包...          ✅ 所有必需包已安装（6个）
[3/7] 数据库连接...      ✅ 数据库连接正常（93,728条订单）
[4/7] Redis缓存...       ✅ Redis缓存正常（11个键，命中率65.99%）
[5/7] 数据文件...        ✅ 数据文件正常（6个文件）
[6/7] 磁盘空间...        ✅ 磁盘空间充足（剩余620.2GB）
[7/7] 可用内存...        ✅ 可用内存充足（剩余34.6GB）

================================================================================
 📊 自检总结
================================================================================

   通过: 7/7
   ✅ 所有检查通过，系统正常
================================================================================
```

---

## 💡 使用建议

### 日常使用
- ✅ 启动看板时自动运行简易版
- ✅ 关注输出，确认系统正常

### 遇到问题时
- ✅ 手动运行完整版获取详细信息
  ```powershell
  python 启动自检.py
  ```
- ✅ 根据修复建议操作

### 开发调试时
- ✅ 使用完整版获取全面信息
- ✅ 使用诊断工具深入排查

---

## ❓ 常见问题

### Q: 为什么有两个版本？
**A**: 简易版用于快速检查，避免导入冲突；完整版用于详细诊断。

### Q: 启动时应该用哪个？
**A**: 简易版（已配置）。

### Q: 如何获取详细信息？
**A**: 手动运行 `python 启动自检.py`。

### Q: 简易版检查够用吗？
**A**: 够用。它检查了最关键的3项：Python、Redis、数据库。

### Q: 如果简易版失败怎么办？
**A**: 
1. 查看错误信息
2. 运行完整版获取详细信息
3. 使用诊断工具排查

---

## 🔍 故障排查

### 问题1: 简易自检失败
```
❌ Redis服务未启动
```

**解决**:
```powershell
Get-Service Memurai | Start-Service
```

### 问题2: 数据库连接失败
```
❌ 数据库连接失败
```

**解决**:
```powershell
.\启动数据库.ps1
```

### 问题3: 需要更多信息
```
⚠️  系统自检发现问题
```

**解决**:
```powershell
# 运行完整版
python 启动自检.py

# 或运行诊断工具
python 诊断今日必做性能.py
```

---

**推荐**: 日常使用简易版，遇到问题时使用完整版和诊断工具。
