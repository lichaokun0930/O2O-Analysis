# 📦 A/B电脑完整工具包 - 总览

## 🎯 核心理念

**A电脑**: 一条命令智能提交所有修改  
**B电脑**: 一条命令智能同步所有更新

---

## ⭐ 最简使用方式

### A电脑(开发机)
```powershell
# 修改了代码/数据库后,一条命令搞定!
.\A电脑_智能提交.ps1 -message "你的提交信息"
```

### B电脑(同步机)
```powershell
# 每天工作前/需要同步时,一条命令搞定!
.\B电脑_拉取代码.ps1
```

---

## 📚 完整脚本清单

### A电脑脚本(4个)

| 脚本 | 功能 | 推荐度 | 使用场景 |
|------|------|--------|---------|
| `A电脑_智能提交.ps1` | **智能提交所有修改** | ⭐⭐⭐⭐⭐ | 任何修改都用这个! |
| `A电脑_创建迁移.ps1` | 创建并应用迁移 | ⭐⭐ | 需要单独创建迁移时 |
| `A电脑_提交迁移.ps1` | 提交迁移到Git | ⭐⭐ | 迁移创建后单独提交 |
| `A电脑_提交所有修改.ps1` | 提交所有代码 | ⭐⭐⭐ | 纯代码修改(无数据库) |

### B电脑脚本(2个)

| 脚本 | 功能 | 推荐度 | 使用场景 |
|------|------|--------|---------|
| `B电脑_拉取代码.ps1` | **智能拉取所有更新** | ⭐⭐⭐⭐⭐ | 日常同步都用这个! |
| `B电脑_同步数据库.ps1` | 仅同步数据库 | ⭐⭐⭐ | 只需同步数据库时 |

---

## 📖 完整文档清单

| 文档 | 内容 | 适合 |
|------|------|------|
| `A电脑_智能提交使用指南.md` | 智能提交详细说明 | 新手必读 |
| `AB电脑操作快速参考.md` | 所有命令速查表 | 日常速查 |
| `数据库同步快速参考.md` | 数据库同步命令 | 数据库操作 |
| `A电脑操作指南.md` | A电脑完整手册 | 深入学习 |
| `两台电脑数据库同步方案.md` | 完整架构设计 | 理解原理 |

---

## 🚀 典型使用场景

### 场景1: A电脑修改了看板代码(无数据库修改)
```powershell
# A电脑
.\A电脑_智能提交.ps1 -message "优化客单价分析功能"

# B电脑(稍后同步)
.\B电脑_拉取代码.ps1
# → 自动检测无数据库修改,只清理缓存
```

### 场景2: A电脑添加了新字段(数据库+代码)
```powershell
# A电脑
# 1. 编辑 database/models.py 添加字段
# 2. 一条命令搞定!
.\A电脑_智能提交.ps1 -message "添加配送员字段"
# → 询问迁移描述: delivery_person
# → 打开notepad编辑SQL
# → 自动应用迁移、验证、提交GitHub

# B电脑(稍后同步)
.\B电脑_拉取代码.ps1
# → 自动检测数据库修改
# → 询问是否同步数据库: y
# → 自动同步迁移、验证、清理缓存
```

### 场景3: B电脑有本地修改时同步
```powershell
# B电脑
.\B电脑_拉取代码.ps1
# → 检测到本地修改
# → 提供选项: [1]暂存 [2]放弃 [3]取消
# → 选择后自动拉取并同步
```

---

## 🎓 新手快速上手

### 第一次使用(B电脑克隆后)
```powershell
# 1. 克隆代码
git clone https://github.com/lichaokun0930/O2O-Analysis.git

# 2. 进入目录
cd O2O数据分析/测算模型

# 3. 运行首次配置
.\setup_new_pc.ps1

# 4. 同步数据库
.\B电脑_同步数据库.ps1

# 5. 启动看板
.\启动看板.ps1
```

### 日常工作流程

**A电脑(开发):**
```powershell
# 1. 修改代码/数据库
# 2. 提交
.\A电脑_智能提交.ps1 -message "修改说明"
```

**B电脑(同步):**
```powershell
# 1. 每天开始工作前
.\B电脑_拉取代码.ps1

# 2. 重启看板
.\启动看板.ps1
```

---

## 🛠️ 高级功能

### A电脑手动分步操作
```powershell
# 1. 创建迁移(不提交)
.\A电脑_创建迁移.ps1 -description "field_name"

# 2. 单独提交迁移
.\A电脑_提交迁移.ps1 -filename "v2_field_name.sql" -message "添加字段"
# 可选择 [1]仅迁移 [2]所有修改
```

### B电脑手动步骤
```powershell
# 1. 拉取代码
git pull

# 2. 仅同步数据库
.\B电脑_同步数据库.ps1

# 3. 或手动同步
python database\migrations\sync_migrations.py
python 清理Redis缓存.py
```

---

## 📊 工作流程图

```
A电脑开发流程:
  修改代码/models.py
    ↓
  运行: .\A电脑_智能提交.ps1
    ↓
  [自动检测models.py修改]
    ↓ YES              ↓ NO
  询问迁移描述      直接提交代码
    ↓
  打开notepad编辑SQL
    ↓
  应用迁移到数据库
    ↓
  验证数据库结构
    ↓          ↙
  提交所有到GitHub
    ↓
  完成!

B电脑同步流程:
  运行: .\B电脑_拉取代码.ps1
    ↓
  [检测本地修改]
    ↓ 有             ↓ 无
  询问处理方式    直接拉取
    ↓          ↙
  git pull
    ↓
  [检测数据库修改]
    ↓ 有             ↓ 无
  询问是否同步    清理缓存
    ↓ YES
  自动同步数据库
    ↓
  清理Redis缓存
    ↓
  完成!
```

---

## 🔍 故障排查

### A电脑问题

**Q: 智能提交脚本检测不到models.py修改?**
```powershell
# A: 确认文件已修改
git status
# 应该看到: M database/models.py
```

**Q: 迁移应用失败?**
```powershell
# A: 检查SQL语法,修复后重新运行
# 修复 database/migrations/vX_xxx.sql
.\A电脑_智能提交.ps1 -message "重新提交"
```

### B电脑问题

**Q: 拉取代码冲突?**
```powershell
# A: 使用B电脑_拉取代码.ps1会自动处理
# 选择 [1]暂存本地修改 或 [2]放弃本地修改
```

**Q: 看板显示旧数据?**
```powershell
# A: 清理缓存并重启
python 清理Redis缓存.py
.\启动看板.ps1
```

---

## 💡 最佳实践

### A电脑
1. **提交频率**: 每完成一个功能立即提交,不要积累
2. **提交信息**: 清晰描述修改内容,如"添加配送员字段"、"优化利润计算"
3. **迁移描述**: 使用小写+下划线,如`delivery_person`
4. **测试后提交**: 本地验证功能正常后再提交

### B电脑
1. **及时同步**: 每天工作前先运行`.\B电脑_拉取代码.ps1`
2. **处理冲突**: 本地修改要么暂存要么放弃,不要积累
3. **验证功能**: 同步后启动看板验证关键功能
4. **清理缓存**: 同步后必须清理Redis缓存

---

## 📞 需要帮助?

- **新手**: 先看 `A电脑_智能提交使用指南.md`
- **速查**: 看 `AB电脑操作快速参考.md`
- **深入**: 看 `两台电脑数据库同步方案.md`
- **问题**: 看各文档的"故障排查"章节

---

## 🎉 总结

只需要记住两条命令:

**A电脑**: `.\A电脑_智能提交.ps1 -message "xxx"`  
**B电脑**: `.\B电脑_拉取代码.ps1`

一切自动完成! 🚀
