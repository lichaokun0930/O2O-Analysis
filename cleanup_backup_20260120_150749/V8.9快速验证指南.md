# V8.9 å¿«é€ŸéªŒè¯æŒ‡å—

## ğŸ¯ éªŒè¯ç›®æ ‡
ç¡®è®¤Redisç¼“å­˜ä¿®å¤åï¼Œä»Šæ—¥å¿…åšTabåŠ è½½é€Ÿåº¦ä»40ç§’+é™ä½åˆ°<5ç§’ï¼ˆé¦–æ¬¡ï¼‰å’Œ<1ç§’ï¼ˆäºŒæ¬¡ï¼‰

## âš¡ å¿«é€ŸéªŒè¯æ­¥éª¤

### æ­¥éª¤1: é‡å¯çœ‹æ¿
```powershell
cd O2O-Analysis
.\å¯åŠ¨çœ‹æ¿.ps1
```

**é¢„æœŸè¾“å‡º**ï¼š
```
âœ… Redisç¼“å­˜æ¨¡å—å·²åŠ è½½
âœ… Redisç¼“å­˜å·²å¯ç”¨ - æ”¯æŒå¤šç”¨æˆ·æ•°æ®å…±äº«
ğŸ“Š ç¼“å­˜é…ç½®: TTL=30åˆ†é’Ÿ, è‡ªåŠ¨è¿‡æœŸ
ğŸ“Š ç¼“å­˜ç»Ÿè®¡: {...}
```

**å¦‚æœçœ‹åˆ°**ï¼š
```
âš ï¸ Redisè¿æ¥å¤±è´¥ï¼Œå°†ä½¿ç”¨æœ¬åœ°ç¼“å­˜
```
è¯´æ˜MemuraiæœåŠ¡æœªå¯åŠ¨ï¼Œè¿è¡Œï¼š
```powershell
Get-Service Memurai | Start-Service
```

### æ­¥éª¤2: æµ‹è¯•ä»Šæ—¥å¿…åšTab

#### 2.1 é¦–æ¬¡åŠ è½½ï¼ˆæ— ç¼“å­˜ï¼‰
1. æ‰“å¼€æµè§ˆå™¨è®¿é—®çœ‹æ¿
2. é€‰æ‹©ä»»æ„é—¨åº—
3. ç‚¹å‡»"ä»Šæ—¥å¿…åš"Tab
4. **ç”¨ç§’è¡¨è®¡æ—¶**

**é¢„æœŸç»“æœ**ï¼š
- âœ… åŠ è½½æ—¶é—´ï¼š3-5ç§’ï¼ˆå–å†³äºæ•°æ®é‡ï¼‰
- âœ… é¡µé¢æ­£å¸¸æ˜¾ç¤º
- âœ… æ— é”™è¯¯æç¤º

**å¦‚æœè¶…è¿‡10ç§’**ï¼š
- æ£€æŸ¥æ•°æ®é‡ï¼ˆå•é—¨åº—è®¢å•æ•°ï¼‰
- è¿è¡Œè¯Šæ–­è„šæœ¬ï¼ˆè§æ­¥éª¤3ï¼‰

#### 2.2 äºŒæ¬¡åŠ è½½ï¼ˆæœ‰ç¼“å­˜ï¼‰
1. åˆ‡æ¢åˆ°"è®¢å•æ•°æ®æ¦‚è§ˆ"Tab
2. å†åˆ‡æ¢å›"ä»Šæ—¥å¿…åš"Tab
3. **ç”¨ç§’è¡¨è®¡æ—¶**

**é¢„æœŸç»“æœ**ï¼š
- âœ… åŠ è½½æ—¶é—´ï¼š<1ç§’
- âœ… æ•°æ®ä¸é¦–æ¬¡ä¸€è‡´
- âœ… æ— é‡æ–°è®¡ç®—

**å¦‚æœä»ç„¶å¾ˆæ…¢**ï¼š
- ç¼“å­˜æœªç”Ÿæ•ˆï¼Œè¿è¡Œè¯Šæ–­è„šæœ¬

### æ­¥éª¤3: è¿è¡Œè¯Šæ–­è„šæœ¬
```powershell
python è¯Šæ–­ä»Šæ—¥å¿…åšæ€§èƒ½.py
```

**é¢„æœŸè¾“å‡º**ï¼š
```
[1/6] æ£€æŸ¥Redisç¼“å­˜...
   âœ… Redisè¿æ¥: æ­£å¸¸
   âœ… Redisç¼“å­˜ç®¡ç†å™¨: å·²å¯ç”¨  # å…³é”®ï¼

[2/6] æ£€æŸ¥PostgreSQLæ•°æ®åº“...
   âœ… æ•°æ®åº“è¿æ¥: æ­£å¸¸
   âœ… ordersè¡¨ç´¢å¼•æ•°é‡: 32ä¸ª

[3/6] æ£€æŸ¥æ•°æ®é‡...
   âœ… è®¢å•æ€»æ•°: XX,XXXæ¡

[4/6] æ£€æŸ¥V8.6è®¢å•èšåˆä¼˜åŒ–...
   âœ… calculate_order_aggregationå‡½æ•°: å·²å¯¼å…¥

[5/6] æ£€æŸ¥V8.8-V8.9ä¼˜åŒ–...
   âœ… é˜²æŠ–å·¥å…·: å·²å¯¼å…¥
   âœ… åˆ†é¡µå·¥å…·: å·²å¯¼å…¥

[6/6] æ€§èƒ½å»ºè®®...
   âœ… æ‰€æœ‰æ£€æŸ¥é€šè¿‡ï¼Œç³»ç»Ÿé…ç½®æ­£å¸¸
```

**å¦‚æœçœ‹åˆ°é—®é¢˜**ï¼š
- âŒ Redisç¼“å­˜ç®¡ç†å™¨: æœªå¯ç”¨ â†’ é‡å¯çœ‹æ¿
- âŒ æ•°æ®åº“è¿æ¥å¤±è´¥ â†’ å¯åŠ¨PostgreSQL
- âŒ ç´¢å¼•æ•°é‡<32 â†’ é‡å»ºç´¢å¼•

### æ­¥éª¤4: æ€§èƒ½æµ‹è¯•ï¼ˆå¯é€‰ï¼‰
```powershell
python æµ‹è¯•ä»Šæ—¥å¿…åšå®é™…æ€§èƒ½.py
```

**é¢„æœŸè¾“å‡º**ï¼š
```
[4/5] æµ‹è¯•äºŒæ¬¡åŠ è½½ï¼ˆæœ‰ç¼“å­˜ï¼‰...
   âœ… ç¼“å­˜è¯»å–æˆåŠŸ
   â±ï¸  è€—æ—¶: 0.02ç§’
   ğŸš€ æ€§èƒ½æå‡: 5å€+

[5/5] æ€§èƒ½è¯„ä¼°...
   âœ… æ€§èƒ½æµ‹è¯•é€šè¿‡ï¼
```

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| åœºæ™¯ | ä¿®å¤å‰ | ä¿®å¤å | çŠ¶æ€ |
|------|--------|--------|------|
| é¦–æ¬¡åŠ è½½é—¨åº— | 40ç§’+ | 3-5ç§’ | âœ… 8å€æå‡ |
| åˆ‡æ¢å›æ¥ | 40ç§’+ | <1ç§’ | âœ… 40å€æå‡ |
| 30åˆ†é’Ÿå | 40ç§’+ | 3-5ç§’ | âœ… è‡ªåŠ¨åˆ·æ–° |

## ğŸ”§ å¸¸è§é—®é¢˜

### Q1: é¦–æ¬¡åŠ è½½ä»ç„¶éœ€è¦40ç§’+
**å¯èƒ½åŸå› **ï¼š
1. æ•°æ®é‡è¿‡å¤§ï¼ˆ>5ä¸‡è¡Œï¼‰
2. æ•°æ®åº“ç´¢å¼•ç¼ºå¤±
3. è®¡ç®—é€»è¾‘å¤æ‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
```powershell
# æ£€æŸ¥æ•°æ®é‡
python -c "from sqlalchemy import create_engine; engine = create_engine('postgresql+pg8000://postgres:postgres@localhost:5432/o2o_dashboard'); import pandas as pd; df = pd.read_sql('SELECT store_name, COUNT(*) as cnt FROM orders GROUP BY store_name ORDER BY cnt DESC LIMIT 10', engine); print(df)"

# æ£€æŸ¥ç´¢å¼•
python è¯Šæ–­ä»Šæ—¥å¿…åšæ€§èƒ½.py

# å¦‚æœç´¢å¼•<32ä¸ªï¼Œé‡å»ºç´¢å¼•
python database/create_indexes.py
```

### Q2: äºŒæ¬¡åŠ è½½ä»ç„¶å¾ˆæ…¢
**å¯èƒ½åŸå› **ï¼š
1. Redisç¼“å­˜æœªå¯ç”¨
2. ç¼“å­˜é”®ä¸åŒ¹é…
3. ç¼“å­˜è¿‡æœŸ

**è§£å†³æ–¹æ¡ˆ**ï¼š
```powershell
# æ£€æŸ¥RedisçŠ¶æ€
python è¯Šæ–­ä»Šæ—¥å¿…åšæ€§èƒ½.py

# æŸ¥çœ‹Redisç¼“å­˜é”®
python -c "from redis_cache_manager import REDIS_CACHE_MANAGER; print(REDIS_CACHE_MANAGER.client.keys('o2o_dashboard:*'))"

# æ¸…ç†ç¼“å­˜é‡è¯•
python -c "from redis_cache_manager import REDIS_CACHE_MANAGER; REDIS_CACHE_MANAGER.clear_pattern('o2o_dashboard:*')"
```

### Q3: Redisç¼“å­˜ç®¡ç†å™¨æœªå¯ç”¨
**å¯èƒ½åŸå› **ï¼š
1. MemuraiæœåŠ¡æœªå¯åŠ¨
2. Redisè¿æ¥è¶…æ—¶
3. ç«¯å£è¢«å ç”¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
```powershell
# æ£€æŸ¥MemuraiæœåŠ¡
Get-Service Memurai

# å¯åŠ¨Memurai
Get-Service Memurai | Start-Service

# æµ‹è¯•Redisè¿æ¥
python -c "import redis; r = redis.Redis(host='localhost', port=6379); print(r.ping())"

# å¦‚æœå¤±è´¥ï¼Œé‡å¯Memurai
Restart-Service Memurai
```

## âœ… éªŒè¯æ¸…å•

- [ ] çœ‹æ¿å¯åŠ¨æ—¥å¿—æ˜¾ç¤º"Redisç¼“å­˜å·²å¯ç”¨"
- [ ] è¯Šæ–­è„šæœ¬æ˜¾ç¤º"Redisç¼“å­˜ç®¡ç†å™¨: å·²å¯ç”¨"
- [ ] é¦–æ¬¡åŠ è½½ä»Šæ—¥å¿…åšTab <5ç§’
- [ ] äºŒæ¬¡åŠ è½½ä»Šæ—¥å¿…åšTab <1ç§’
- [ ] æ— é”™è¯¯æç¤º
- [ ] æ•°æ®æ˜¾ç¤ºæ­£å¸¸

## ğŸ“ åé¦ˆæ¨¡æ¿

å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

```
### ç¯å¢ƒä¿¡æ¯
- çœ‹æ¿ç‰ˆæœ¬: V8.9
- æ•°æ®é‡: [å•é—¨åº—è®¢å•æ•°]
- RedisçŠ¶æ€: [è¯Šæ–­è„šæœ¬è¾“å‡º]

### æ€§èƒ½æ•°æ®
- é¦–æ¬¡åŠ è½½: [Xç§’]
- äºŒæ¬¡åŠ è½½: [Xç§’]
- é¢„æœŸ: é¦–æ¬¡<5ç§’, äºŒæ¬¡<1ç§’

### å¯åŠ¨æ—¥å¿—
[ç²˜è´´çœ‹æ¿å¯åŠ¨æ—¶çš„Redisç›¸å…³æ—¥å¿—]

### è¯Šæ–­ç»“æœ
[ç²˜è´´è¯Šæ–­è„šæœ¬å®Œæ•´è¾“å‡º]

### æµè§ˆå™¨æ§åˆ¶å°
[ç²˜è´´æµè§ˆå™¨F12æ§åˆ¶å°çš„é”™è¯¯ä¿¡æ¯]
```

---

**éªŒè¯æ—¶é—´**: 2025-12-11
**ä¿®å¤ç‰ˆæœ¬**: V8.9
**é¢„è®¡éªŒè¯æ—¶é—´**: 5åˆ†é’Ÿ
