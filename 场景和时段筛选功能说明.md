# 场景和时段筛选功能说明

## 问题说明

您看到的"场景筛选"和"时段筛选"置灰是因为数据中缺少对应的字段。

## ✅ 已修复：时段自动生成

**修改内容**：
- 系统现在会自动从"下单时间"字段推断时段
- 无需手动添加"时段"字段

**时段分类规则**：
| 时段 | 时间范围 | 适用场景 |
|------|---------|---------|
| 早上 | 6:00-10:00 | 早餐、早点 |
| 上午 | 10:00-12:00 | 上午茶、早午餐 |
| 午餐 | 12:00-14:00 | 午餐高峰 |
| 下午 | 14:00-17:00 | 下午茶、零食 |
| 晚餐 | 17:00-20:00 | 晚餐高峰 |
| 夜间 | 20:00-23:00 | 夜宵、加班餐 |
| 深夜 | 23:00-6:00 | 深夜零食 |

**使用方法**：
1. 确保数据中有"下单时间"字段
2. 系统会自动添加"时段"字段
3. "时段筛选"下拉框将自动可用

---

## ⚠️ 场景筛选仍需手动添加

**为什么场景无法自动生成？**
- 场景是**业务定义**的概念（如：早餐、午餐、下午茶、聚餐等）
- 无法从订单数据自动推断
- 需要根据您的业务规则手动标注

### 方案1：在Excel中添加场景列（推荐）

在您的订单数据Excel中添加"场景"列：

| 订单ID | 下单时间 | 商品名称 | **场景** | ... |
|--------|---------|---------|---------|-----|
| 001 | 2025-10-16 07:30 | 豆浆 | **早餐** | ... |
| 002 | 2025-10-16 12:15 | 盖浇饭 | **午餐** | ... |
| 003 | 2025-10-16 15:00 | 奶茶 | **下午茶** | ... |
| 004 | 2025-10-16 19:00 | 汉堡 | **晚餐** | ... |
| 005 | 2025-10-16 22:00 | 炸鸡 | **夜宵** | ... |

**常见场景示例**：
- 正餐：早餐、午餐、晚餐
- 加餐：下午茶、夜宵、加班餐
- 用途：聚餐、外卖、堂食、自提
- 活动：促销、团购、会员专享

### 方案2：使用时段代替场景

如果您的场景就是基于时间的（如早餐=早上时段），可以：
1. 不使用"场景筛选"
2. 只使用"时段筛选"（已自动生成）
3. 时段筛选功能完全可以满足需求

---

## 🔍 使用示例

### 示例1：只使用时段筛选

```
对比周期：按日对比
下滑阈值：-20%
场景筛选：（留空或不选）
时段筛选：选择"晚餐(17-20点)"  ← 自动可用
```

**分析结果**：
- 只分析晚餐时段的销量下滑商品
- 排除其他时段的干扰

### 示例2：同时使用场景和时段

如果Excel中已添加场景字段：

```
对比周期：按周对比
下滑阈值：-20%
场景筛选：选择"外卖"
时段筛选：选择"午餐(12-14点)"
```

**分析结果**：
- 只分析"外卖"场景
- 且在"午餐时段"的商品
- 双重筛选，更精准

---

## 📝 修改记录

**2025-10-16 更新**：
- ✅ 新增：自动从"下单时间"推断"时段"字段
- ✅ 优化：如果缺少"场景"字段，显示友好提示
- ✅ 说明：时段筛选现在默认可用
- ℹ️ 说明：场景筛选仍需手动添加场景列

---

## 💡 常见问题

**Q1: 我不想使用场景筛选，可以隐藏吗？**
- A: 暂时无法隐藏，但可以忽略它（留空即表示"全部场景"）

**Q2: 时段分类不符合我的业务，可以自定义吗？**
- A: 可以！请联系开发者修改时段分类规则

**Q3: 场景可以自动从商品名称推断吗？**
- A: 技术上可以，但准确率可能不高。建议手动标注或提供业务规则

**Q4: 时段筛选还是置灰怎么办？**
- A: 检查数据中是否有"下单时间"字段，且格式正确（如：2025-10-16 12:30:00）

---

## 🎯 下一步

1. **立即测试**：重新运行看板，检查"时段筛选"是否已可用
2. **评估需求**：确定是否真的需要"场景"字段
3. **添加场景**（可选）：在Excel中添加"场景"列并重新加载数据
