# 六象限分类体系 V7.3 保守优化说明

## 📊 优化概述

**版本**：V7.3
**优化类型**：保守优化
**优化范围**：畅销商品 + 潜力商品
**优化时间**：2025-12-10

## 🎯 优化目标

1. **畅销商品**：更准确识别刚需基础品，避免与明星商品重叠
2. **潜力商品**：过滤低价低利润品，聚焦有推广价值的商品

## 📋 优化详情

### 优化1：🔥 畅销商品

#### 问题分析

**旧逻辑（V7.2）**：
```python
# 价格阈值：全店价格中位数
BESTSELLER_PRICE_THRESHOLD = product_data['商品实售价'].median()

# 销量阈值：70分位数
BESTSELLER_SALES_THRESHOLD = product_data['销量'].quantile(0.7)
```

**存在问题**：
1. **价格阈值过高**：如果门店主要销售高价商品，中位数可能20元，导致10元的包子被排除
2. **销量门槛与明星相同**：都是70分位数，导致畅销商品与明星商品竞争同一批商品
3. **识别不准确**：真正的刚需基础品（如包子、矿泉水）可能被遗漏

#### 新逻辑（V7.3）

```python
# 价格阈值：从中位数改为30分位数（更宽松）
BESTSELLER_PRICE_THRESHOLD = product_data['商品实售价'].quantile(0.3)

# 销量阈值：从70分位数改为80分位数（更严格）
BESTSELLER_SALES_THRESHOLD = product_data['销量'].quantile(0.8)
```

**优化效果**：
- ✅ **降低价格阈值**：从50分位数→30分位数，识别更多低价刚需品
- ✅ **提高销量门槛**：从70分位数→80分位数，确保是真正的畅销品
- ✅ **减少重叠**：与明星商品的销量门槛拉开差距（明星70分位数，畅销80分位数）

#### 判定条件对比

| 条件 | V7.2（旧） | V7.3（新） | 变化 |
|------|-----------|-----------|------|
| 价格阈值 | < 中位数（50分位数） | < 30分位数 | ⬇️ 更宽松 |
| 销量阈值 | ≥ 70分位数 | ≥ 80分位数 | ⬆️ 更严格 |
| 利润率 | ≥ 品类中位数 | ≥ 品类中位数 | 不变 |

#### 典型案例

**案例1：包子（猪肉大葱）**
```
实售价：3.5元
成本：1.8元
利润率：48.6%
销量：200件/月

V7.2判定：可能被排除（如果门店价格中位数<3.5元）
V7.3判定：✅ 🔥 畅销商品（价格在30分位数以下，销量在80分位数以上）
```

**案例2：矿泉水550ml**
```
实售价：2.5元
成本：1.5元
利润率：40%
销量：180件/月

V7.2判定：可能被排除（如果门店价格中位数<2.5元）
V7.3判定：✅ 🔥 畅销商品（低价刚需品，销量高）
```

---

### 优化2：💎 潜力商品

#### 问题分析

**旧逻辑（V7.2）**：
```python
# 只要高利润+低动销就算潜力
if high_profit and low_sales:
    return '💎 潜力商品'
```

**存在问题**：
1. **低动销定义过宽**：只要不满足"高动销"就算"低动销"，可能包含销量接近70分位数的商品
2. **包含低价低利润品**：一个1元商品利润率50%但只赚0.5元，推广价值不大
3. **缺少价值判断**：没有考虑单品利润额，可能浪费推广资源

#### 新逻辑（V7.3）

```python
# 低动销上限：销量中位数（明确的上限）
POTENTIAL_SALES_THRESHOLD = product_data['销量'].quantile(0.5)

# 价值门槛：单品利润额≥0.3元
POTENTIAL_MIN_UNIT_PROFIT = 0.3

# 判定条件
low_sales_explicit = sales_qty < POTENTIAL_SALES_THRESHOLD
has_potential_value = unit_profit >= POTENTIAL_MIN_UNIT_PROFIT

if high_profit and low_sales_explicit and has_potential_value:
    return '💎 潜力商品'
```

**优化效果**：
- ✅ **明确低动销上限**：销量<中位数（50分位数），更精准
- ✅ **增加价值门槛**：单品利润额≥0.3元，过滤低价低利润品
- ✅ **聚焦推广价值**：只推荐真正值得推广的商品

#### 判定条件对比

| 条件 | V7.2（旧） | V7.3（新） | 变化 |
|------|-----------|-----------|------|
| 利润率 | > 品类中位数 | > 品类中位数 | 不变 |
| 销量上限 | 不满足高动销即可 | < 中位数（50分位数） | ⬆️ 更明确 |
| 价值门槛 | 无 | 单品利润≥0.3元 | ✅ 新增 |

#### 典型案例

**案例1：进口红酒（有价值）**
```
实售价：128元
成本：45元
利润率：64.8%
销量：5件/月
单品利润：83元

V7.2判定：✅ 💎 潜力商品
V7.3判定：✅ 💎 潜力商品（销量<中位数，单品利润83元>0.3元）
```

**案例2：1元糖果（无价值）**
```
实售价：1元
成本：0.4元
利润率：60%
销量：8件/月
单品利润：0.6元

V7.2判定：✅ 💎 潜力商品（利润率高）
V7.3判定：❌ 不是潜力商品（虽然利润率高，但单品只赚0.6元，不值得推广）
→ 可能被归类为：🐌 低效商品
```

**案例3：高价零食（边界情况）**
```
实售价：5元
成本：3元
利润率：40%
销量：15件/月（接近中位数）
单品利润：2元

V7.2判定：✅ 💎 潜力商品（只要不是高动销）
V7.3判定：❌ 不是潜力商品（销量≥中位数，不算低动销）
→ 可能被归类为：⚡ 自然引流 或 🐌 低效商品
```

---

## 📊 预期效果

### 畅销商品

**优化前（V7.2）**：
- 识别数量：可能偏少（价格阈值过高）
- 典型商品：中等价位的高销商品
- 遗漏商品：低价刚需品（如包子、矿泉水）

**优化后（V7.3）**：
- 识别数量：预计增加20-30%
- 典型商品：真正的低价刚需品
- 覆盖范围：更全面（包子、矿泉水、面包等）

### 潜力商品

**优化前（V7.2）**：
- 识别数量：可能偏多（包含低价低利润品）
- 典型商品：所有高利润低销的商品
- 误判商品：1元糖果、小零食等

**优化后（V7.3）**：
- 识别数量：预计减少10-20%
- 典型商品：真正有推广价值的商品
- 过滤商品：低价低利润品（单品利润<0.3元）

---

## 🔍 验证方法

### 步骤1：查看控制台输出

启动看板后，查看控制台输出的阈值信息：

```
📊 V7.3动态阈值设置:
   明星-单品利润额门槛: ≥0.50元
   明星-总利润贡献门槛: ≥50.00元
   畅销-价格阈值: <5.20元 (30分位数)  ← 新增
   畅销-销量阈值: ≥85件 (80分位数)    ← 新增
   潜力-销量上限: <42件 (50分位数)    ← 新增
   潜力-单品利润门槛: ≥0.30元        ← 新增
```

### 步骤2：对比六象限分布

**优化前（V7.2）**：
```
🌟 明星商品: 218个
🔥 畅销商品: 50个   ← 可能偏少
💎 潜力商品: 180个  ← 可能偏多
🎯 策略引流: 30个
⚡ 自然引流: 120个
🐌 低效商品: 200个
```

**优化后（V7.3）预期**：
```
🌟 明星商品: 218个  (不变)
🔥 畅销商品: 65个   ← 增加15个（+30%）
💎 潜力商品: 160个  ← 减少20个（-11%）
🎯 策略引流: 30个   (不变)
⚡ 自然引流: 120个  (不变)
🐌 低效商品: 205个  ← 增加5个（吸收被过滤的潜力商品）
```

### 步骤3：检查具体商品

**检查畅销商品**：
- 查看是否包含包子、矿泉水等低价刚需品
- 价格应该在30分位数以下
- 销量应该在80分位数以上

**检查潜力商品**：
- 查看是否过滤了1元糖果等低价品
- 单品利润应该≥0.3元
- 销量应该<中位数

---

## 📝 操作指南更新

### 更新位置

1. **简短说明**（Tab标签附近）
   - 文件：`callbacks.py` 第15986行
   - 内容：添加V7.3优化标记

2. **详细说明**（操作指南折叠面板）
   - 文件：`callbacks.py` 第15400-15500行
   - 内容：更新畅销商品和潜力商品的判定条件

### 更新内容

**畅销商品**：
- ✅ 添加V7.3优化说明
- ✅ 标注价格阈值变化（中位数→30分位数）
- ✅ 标注销量阈值变化（70分位数→80分位数）

**潜力商品**：
- ✅ 添加V7.3优化说明
- ✅ 标注低动销上限（明确为中位数）
- ✅ 标注价值门槛（新增单品利润≥0.3元）

---

## 🎯 后续优化建议

### 如果效果良好

可以考虑进一步优化其他象限：

1. **⚡ 自然引流**
   - 增加利润率下限（要求>0，排除亏损品）
   - 增加价格维度（30-70分位数，排除极端低价）

2. **🐌 低效商品**
   - 明确低动销上限（30分位数，更严格）
   - 增加严重程度分级（待淘汰/待优化）

### 如果效果不理想

可以回滚或微调：

1. **畅销商品**
   - 价格阈值：30分位数→40分位数（稍微严格一点）
   - 销量阈值：80分位数→75分位数（稍微宽松一点）

2. **潜力商品**
   - 价值门槛：0.3元→0.2元（稍微宽松一点）
   - 销量上限：50分位数→40分位数（稍微严格一点）

---

## 📊 数据监控

### 关键指标

1. **畅销商品数量变化**
   - 目标：增加20-30%
   - 监控：是否包含低价刚需品

2. **潜力商品数量变化**
   - 目标：减少10-20%
   - 监控：是否过滤了低价低利润品

3. **六象限分布合理性**
   - 明星商品：15-25%
   - 畅销商品：8-12%（预期增加）
   - 潜力商品：15-20%（预期减少）
   - 策略引流：3-5%
   - 自然引流：10-15%
   - 低效商品：30-40%

### 异常情况

**如果畅销商品数量没有增加**：
- 检查价格阈值是否正确计算（30分位数）
- 检查是否有足够的低价商品
- 检查销量阈值是否过高（80分位数）

**如果潜力商品数量没有减少**：
- 检查价值门槛是否生效（单品利润≥0.3元）
- 检查是否有很多低价高利润率商品
- 检查销量上限是否正确（中位数）

---

**优化完成时间**：2025-12-10
**优化版本**：V7.3
**优化类型**：保守优化
**优化人员**：Kiro AI Assistant
