{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "21d5197d", "timestamp": "2026-02-11T16:16:40.296951"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:16:40.345970"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "3f8b3777", "timestamp": "2026-02-11T16:16:46.393476"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:16:49.206759"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "82477290", "timestamp": "2026-02-11T16:16:58.860592"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:16:59.283151"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "c1296783", "timestamp": "2026-02-11T16:17:12.007836"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:17:12.781705"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "a9a94825", "timestamp": "2026-02-11T16:17:21.286817"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:17:21.293330"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "718d7128", "timestamp": "2026-02-11T16:17:48.132376"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:17:48.630189"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "f440a9a9", "timestamp": "2026-02-11T16:17:56.296769"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:17:56.302639"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "3412d49b", "timestamp": "2026-02-11T16:17:57.705733"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:17:58.138541"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "40ffb460", "timestamp": "2026-02-11T16:18:11.418826"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:18:12.146554"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "f96c65c4", "timestamp": "2026-02-11T16:18:37.398273"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:18:37.747750"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "830cb4f3", "timestamp": "2026-02-11T16:18:43.505133"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:18:44.390391"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "6bacd240", "timestamp": "2026-02-11T16:18:45.387802"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:18:45.956762"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "34688ecc", "timestamp": "2026-02-11T16:18:53.833556"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:18:54.739208"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "819fa72a", "timestamp": "2026-02-11T16:18:55.820203"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:18:56.340972"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "channel=%E4%BA%AC%E4%B8%9C%E5%88%B0%E5%AE%B6&granularity=day&days=30"}, "trace_id": "70be99b8", "timestamp": "2026-02-11T16:19:08.850743"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "channel=%E4%BA%AC%E4%B8%9C%E5%88%B0%E5%AE%B6&granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:19:11.324553"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "1a98d2a7", "timestamp": "2026-02-11T16:19:11.680210"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:19:12.200465"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "98464f75", "timestamp": "2026-02-11T16:19:26.199027"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:19:30.353804"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "831691d9", "timestamp": "2026-02-11T16:19:46.456166"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:19:46.462270"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "e09900c1", "timestamp": "2026-02-11T16:19:47.539582"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:19:48.037313"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "60241d1c", "timestamp": "2026-02-11T16:19:49.514740"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:19:50.015574"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "f7f0180a", "timestamp": "2026-02-11T16:19:57.806102"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:19:57.814224"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "428bfb94", "timestamp": "2026-02-11T16:20:27.181659"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:20:27.544564"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "b9601f1b", "timestamp": "2026-02-11T16:20:41.014298"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:20:41.501648"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "92820c43", "timestamp": "2026-02-11T16:20:43.491132"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:20:43.498371"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "836298a6", "timestamp": "2026-02-11T16:21:17.142454"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:21:17.148541"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "7b25cbfb", "timestamp": "2026-02-11T16:21:19.051244"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:21:19.057480"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "e65c9342", "timestamp": "2026-02-11T16:21:24.876259"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:21:25.373828"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "e607cd53", "timestamp": "2026-02-11T16:21:28.084745"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:21:28.089258"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "fbef9e7d", "timestamp": "2026-02-11T16:21:33.430593"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:21:34.278980"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "b3f9348c", "timestamp": "2026-02-11T16:21:35.292314"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:21:35.895712"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "7122ac86", "timestamp": "2026-02-11T16:21:41.577276"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "2421aa04", "timestamp": "2026-02-11T16:21:54.093224"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:22:06.615738"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:22:06.643783"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "channel%5B%5D=%E7%BE%8E%E5%9B%A2%E9%97%AA%E8%B4%AD&granularity=day&days=30"}, "trace_id": "497f3766", "timestamp": "2026-02-11T16:22:38.818748"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "channel%5B%5D=%E7%BE%8E%E5%9B%A2%E9%97%AA%E8%B4%AD&granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:22:38.823488"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "7d0067a5", "timestamp": "2026-02-11T16:23:20.522775"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:23:21.273969"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "d700c831", "timestamp": "2026-02-11T16:24:01.529307"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "5c7136f7", "timestamp": "2026-02-11T16:24:01.881715"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "e9832fff", "timestamp": "2026-02-11T16:24:02.249059"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:24:02.634011"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:24:02.642526"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:24:02.650308"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "10921511", "timestamp": "2026-02-11T16:24:02.988027"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "7183e5db", "timestamp": "2026-02-11T16:24:03.333012"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:24:03.337004"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:24:03.344742"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "d6efafd4", "timestamp": "2026-02-11T16:24:03.681709"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "8580fae1", "timestamp": "2026-02-11T16:24:04.012312"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "1943b09e", "timestamp": "2026-02-11T16:24:04.367338"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "39cc29fb", "timestamp": "2026-02-11T16:24:04.713238"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:24:04.716783"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:24:04.724817"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:24:04.732447"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:24:04.740960"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "0e9e9208", "timestamp": "2026-02-11T16:24:21.114700"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:24:21.130935"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "7870e29e", "timestamp": "2026-02-11T16:24:49.622262"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:24:51.169619"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "7525922d", "timestamp": "2026-02-11T16:25:04.464295"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:25:04.989552"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "5173b682", "timestamp": "2026-02-11T16:25:18.724474"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:25:19.200518"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "store_name=%E5%85%B1%E6%A9%99%E4%B8%80%E7%AB%99%E5%BC%8F%E8%B6%85%E5%B8%82%EF%BC%88%E9%95%87%E6%B1%9F%E5%8F%A5%E5%AE%B9%E5%AE%9D%E5%8D%8E%E5%BA%97%EF%BC%89&granularity=day&days=30"}, "trace_id": "6862df59", "timestamp": "2026-02-11T16:26:38.180535"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "store_name=%E5%85%B1%E6%A9%99%E4%B8%80%E7%AB%99%E5%BC%8F%E8%B6%85%E5%B8%82%EF%BC%88%E9%95%87%E6%B1%9F%E5%8F%A5%E5%AE%B9%E5%AE%9D%E5%8D%8E%E5%BA%97%EF%BC%89&granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:26:38.184951"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "32557089", "timestamp": "2026-02-11T16:26:56.757979"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:26:56.763551"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "channel%5B%5D=%E4%BA%AC%E4%B8%9C%E5%88%B0%E5%AE%B6&granularity=day&days=30"}, "trace_id": "e810cf94", "timestamp": "2026-02-11T16:27:20.273871"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "channel%5B%5D=%E4%BA%AC%E4%B8%9C%E5%88%B0%E5%AE%B6&granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:27:20.800917"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "6157fac2", "timestamp": "2026-02-11T16:27:25.582565"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:27:26.101774"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "channel%5B%5D=%E4%BA%AC%E4%B8%9C%E5%88%B0%E5%AE%B6&granularity=day&days=30"}, "trace_id": "d4ae91e7", "timestamp": "2026-02-11T16:27:32.425582"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "channel%5B%5D=%E4%BA%AC%E4%B8%9C%E5%88%B0%E5%AE%B6&granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:27:32.430676"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "store_name=%E6%83%A0%E5%AE%9C%E9%80%89%E8%B6%85%E5%B8%82%EF%BC%88%E9%95%87%E6%B1%9F%E5%AE%9D%E9%BE%99%E5%B9%BF%E5%9C%BA%E5%BA%97%EF%BC%89&channel%5B%5D=%E4%BA%AC%E4%B8%9C%E5%88%B0%E5%AE%B6&granularity=day&days=30"}, "trace_id": "d1c44993", "timestamp": "2026-02-11T16:27:34.566343"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "store_name=%E6%83%A0%E5%AE%9C%E9%80%89%E8%B6%85%E5%B8%82%EF%BC%88%E9%95%87%E6%B1%9F%E5%AE%9D%E9%BE%99%E5%B9%BF%E5%9C%BA%E5%BA%97%EF%BC%89&channel%5B%5D=%E4%BA%AC%E4%B8%9C%E5%88%B0%E5%AE%B6&granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:27:34.649654"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "store_name=%E6%83%A0%E5%AE%9C%E9%80%89%E8%B6%85%E5%B8%82%EF%BC%88%E9%95%87%E6%B1%9F%E5%AE%9D%E9%BE%99%E5%B9%BF%E5%9C%BA%E5%BA%97%EF%BC%89&granularity=day&days=30"}, "trace_id": "80375c3f", "timestamp": "2026-02-11T16:27:37.565962"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "store_name=%E6%83%A0%E5%AE%9C%E9%80%89%E8%B6%85%E5%B8%82%EF%BC%88%E9%95%87%E6%B1%9F%E5%AE%9D%E9%BE%99%E5%B9%BF%E5%9C%BA%E5%BA%97%EF%BC%89&granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:27:39.663201"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "2488b56b", "timestamp": "2026-02-11T16:27:40.428745"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:27:40.434945"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "store_name=%E6%83%A0%E5%AE%9C%E9%80%89%E8%B6%85%E5%B8%82%EF%BC%88%E9%95%87%E6%B1%9F%E5%AE%9D%E9%BE%99%E5%B9%BF%E5%9C%BA%E5%BA%97%EF%BC%89&granularity=day&days=30"}, "trace_id": "57411366", "timestamp": "2026-02-11T16:27:45.870070"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "store_name=%E6%83%A0%E5%AE%9C%E9%80%89%E8%B6%85%E5%B8%82%EF%BC%88%E9%95%87%E6%B1%9F%E5%AE%9D%E9%BE%99%E5%B9%BF%E5%9C%BA%E5%BA%97%EF%BC%89&granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:27:45.898962"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "ac8184e5", "timestamp": "2026-02-11T16:27:48.360691"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:27:49.213052"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "2277228b", "timestamp": "2026-02-11T16:28:08.429981"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:28:09.533225"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "051eab0b", "timestamp": "2026-02-11T16:28:13.144447"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:28:16.372753"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "31b309c8", "timestamp": "2026-02-11T16:28:21.145938"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:28:21.883185"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "cffab77e", "timestamp": "2026-02-11T16:28:27.619248"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:28:28.937795"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "0e4bdb07", "timestamp": "2026-02-11T16:28:40.968951"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:28:42.622735"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "556d056e", "timestamp": "2026-02-11T16:28:44.091421"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:28:44.630028"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "9f7573e6", "timestamp": "2026-02-11T16:28:51.193297"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:28:51.199782"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "163a8720", "timestamp": "2026-02-11T16:28:53.189767"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:28:53.194766"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "58cbc2ba", "timestamp": "2026-02-11T16:29:00.394396"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:29:00.809316"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "54415f1e", "timestamp": "2026-02-11T16:29:02.961039"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:29:02.967167"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "3ae62cf6", "timestamp": "2026-02-11T16:29:08.133057"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "6a9b2eca", "timestamp": "2026-02-11T16:29:12.549999"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "037975ed", "timestamp": "2026-02-11T16:29:13.230198"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:29:14.733064"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:29:14.739584"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:29:14.748234"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "75cf2d90", "timestamp": "2026-02-11T16:29:15.220251"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:29:16.225844"}
{"error_id": "752679e64833", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "Traceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "client_ip": "127.0.0.1", "query_params": "granularity=day&days=30"}, "trace_id": "11d6c798", "timestamp": "2026-02-11T16:29:20.410536"}
{"error_id": "1ea3d6bcc0c1", "error_type": "KeyError", "message": "\"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"", "traceback": "  + Exception Group Traceback (most recent call last):\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 79, in collapse_excgroups\n  |     yield\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 192, in __call__\n  |     async with anyio.create_task_group() as task_group:\n  |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\anyio\\_backends\\_asyncio.py\", line 781, in __aexit__\n  |     raise BaseExceptionGroup(\n  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)\n  +-+---------------- 1 ----------------\n    | Traceback (most recent call last):\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    |     await self.app(scope, receive, _send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    |     await responder(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    |     await super().__call__(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    |     await self.app(scope, receive, self.send_with_compression)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    |     with recv_stream, send_stream, collapse_excgroups():\n    |   File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    |     self.gen.throw(typ, value, traceback)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    |     response = await self.dispatch_func(request, call_next)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    |     response = await call_next(request)\n    |                ^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    |     raise app_exc from app_exc.__cause__ or app_exc.__context__\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    |     await self.app(scope, receive_or_disconnect, send_no_error)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    |     await self.middleware_stack(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    |     await route.handle(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    |     await self.app(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    |     raise exc\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    |     await app(scope, receive, sender)\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    |     response = await f(request)\n    |                ^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    |     raw_response = await run_endpoint_function(\n    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    |     return await dependant.call(**values)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    |     daily_agg = order_df.groupby('period').agg({\n    |                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    |     result = op.agg()\n    |              ^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    |     return self.agg_dict_like()\n    |            ^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    |     return self.agg_or_apply_dict_like(op_name=\"agg\")\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    |     result_index, result_data = self.compute_dict_like(\n    |                                 ^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    |     func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    |   File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    |     raise KeyError(f\"Column(s) {list(cols)} do not exist\")\n    | KeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n    +------------------------------------\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 29, in __call__\n    await responder(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 130, in __call__\n    await super().__call__(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\gzip.py\", line 46, in __call__\n    await self.app(scope, receive, self.send_with_compression)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\rate_limit.py\", line 114, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 191, in __call__\n    with recv_stream, send_stream, collapse_excgroups():\n  File \"C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\\Lib\\contextlib.py\", line 158, in __exit__\n    self.gen.throw(typ, value, traceback)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_utils.py\", line 85, in collapse_excgroups\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 193, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\middleware\\observability.py\", line 54, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 168, in call_next\n    raise app_exc from app_exc.__cause__ or app_exc.__context__\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 144, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 63, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 18, in __call__\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 716, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 736, in app\n    await route.handle(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 290, in handle\n    await self.app(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 115, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 101, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 355, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 243, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\O2O-Analysis\\backend\\app\\api\\v1\\orders.py\", line 1161, in get_order_trend\n    daily_agg = order_df.groupby('period').agg({\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\groupby\\generic.py\", line 1432, in aggregate\n    result = op.agg()\n             ^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 190, in agg\n    return self.agg_dict_like()\n           ^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 423, in agg_dict_like\n    return self.agg_or_apply_dict_like(op_name=\"agg\")\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 1603, in agg_or_apply_dict_like\n    result_index, result_data = self.compute_dict_like(\n                                ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 462, in compute_dict_like\n    func = self.normalize_dictlike_arg(op_name, selected_obj, func)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Python\\订单数据看板（老版本）\\订单数据看板\\订单数据看板\\.venv\\Lib\\site-packages\\pandas\\core\\apply.py\", line 663, in normalize_dictlike_arg\n    raise KeyError(f\"Column(s) {list(cols)} do not exist\")\nKeyError: \"Column(s) ['商品全额', '实付金额', '配送费'] do not exist\"\n", "context": {"method": "GET", "path": "/api/v1/orders/trend", "query_params": "granularity=day&days=30"}, "trace_id": "--------", "timestamp": "2026-02-11T16:29:20.415252"}
