# 测算模型 - 可删除文件清单（严谨版）

**生成时间**: 2025-11-06  
**检查目录**: D:\Python1\O2O_Analysis\O2O数据分析\测算模型  
**评估方法**: 逐个分析文件实际用途和依赖关系

---

## 📋 分类标准

### ✅ 可安全删除
- 以 `test_` 开头的测试脚本（功能已验证通过）
- 以 `测试` 开头的中文测试脚本
- 以 `检查`、`验证` 开头的一次性验证脚本
- 以 `分析`、`对比`、`演示` 开头的临时分析脚本
- 以 `重新导入` 开头的一次性数据导入脚本
- 明确标注 `_备份`、`_旧版` 的文件

### ⚠️ 需要确认后删除
- 简化版/旧版程序（如果不再使用）
- 多余的启动脚本
- 历史开发文档和报告
- 示例和演示数据

### ❌ 绝对不能删除
- 核心业务处理器（`智能`、`引擎`、`系统` 等关键字）
- AI 分析模块
- 数据库模块（`database/` 目录）
- 后端服务（`backend/` 目录）
- 工具函数（`utils`、`cache`、`factory` 等）
- 配置文件
- 核心文档

---

## 🗑️ 可安全删除的文件（已验证）

### 1️⃣ 测试脚本（54个，~450 KB）

**验证通过的测试脚本 - 可删除**：

```python
# A. 数据库测试（8个）
✅ test_database_connection.py      # 数据库连接测试
✅ test_database_integration.py     # 数据库集成测试
✅ test_db_encoding.py               # 数据库编码测试
✅ test_with_pg8000.py               # pg8000驱动测试
✅ simple_db_test.py                 # 简单数据库测试
✅ quick_db_check.py                 # 快速数据库检查
✅ final_db_test.py                  # 最终数据库测试
✅ check_db_structure.py             # 数据库结构检查

# B. 功能测试（10个）
✅ test_backend_integration.py       # 后端集成测试
✅ test_comparison_modes.py          # 对比模式测试
✅ test_complete_flow.py             # 完整流程测试
✅ test_dashboard_flow.py            # 看板流程测试
✅ test_default_data.py              # 默认数据测试
✅ test_full_process.py              # 全流程测试
✅ test_marketing_cost_flow.py       # 营销成本流程测试（今天刚创建）
✅ test_marketing_data.py            # 营销数据测试
✅ test_p1_p2_p3.py                  # P1P2P3模式测试
✅ test_responsive.py                # 响应式测试

# C. 诊断测试（5个）
✅ test_diagnostic_engine.py         # 诊断引擎测试
✅ test_diagnostic_fields.py         # 诊断字段测试
✅ test_diagnostic_output.py         # 诊断输出测试
✅ test_diagnostic_output_detail.py  # 诊断详细输出测试
✅ test_real_error.py                # 真实错误测试

# D. 系统测试（2个）
✅ test_system.py                    # 系统测试
✅ 系统功能测试.py                   # 系统功能测试
✅ 系统完整测试.py                   # 系统完整测试

# E. 中文测试脚本（29个）
✅ 测试Tab4.2功能.py
✅ 测试Tab4_自动化.py
✅ 测试优先级1功能.py
✅ 测试上传数据字段.py
✅ 测试下滑原因分析.py
✅ 测试低频商品售罄.py
✅ 测试分sheet输出.py
✅ 测试分sheet输出_真实数据.py
✅ 测试单条导入.py
✅ 测试去重逻辑.py
✅ 测试可视化修复.py
✅ 测试商品分类集成.py
✅ 测试图表功能.py
✅ 测试场景推断.py
✅ 测试客单价分析.py
✅ 测试展示逻辑重构.py
✅ 测试库存售罄判定.py
✅ 测试所有对比模式.py
✅ 测试数据处理流程.py
✅ 测试数据源库存.py
✅ 测试日历选择器.py
✅ 测试日维度功能.py
✅ 测试真实数据诊断.py
✅ 测试销量下滑诊断新功能.py
✅ 测试按钮回调.py
✅ 测试BOM编码修复.py
✅ 测试CSV导出修复.py
✅ 测试Dash最小版本.py
✅ 测试NaT修复.py
✅ 测试Streamlit修改.py

# F. 快速测试（2个）
✅ 快速测试对比模式.py
✅ 快速诊断测试.py
✅ 最小化测试_日历选择器.py
```

---

### 2️⃣ 检查/验证脚本（32个，~250 KB）

**一次性验证脚本 - 可删除**：

```python
# A. 数据检查（17个）
✅ check_app_status.py               # 应用状态检查
✅ check_duplicate_columns.py        # 重复列检查
✅ check_existing_data.py            # 现有数据检查
✅ 检查Excel原始数据.py
✅ 检查Excel成本字段.py
✅ 检查利润计算.py
✅ 检查原始数据量.py
✅ 检查如皋店数据.py
✅ 检查字段.py
✅ 检查库存字段.py
✅ 检查成本字段.py
✅ 检查成本导入问题.py
✅ 检查数据字段.py
✅ 检查数据库原始数据.py
✅ 检查海门海亮店成本.py
✅ 检查看板库存显示.py
✅ 检查过滤数据.py

# B. 验证脚本（12个）
✅ verify_db_access.py               # 数据库访问验证
✅ 验证修复_正确版.py
✅ 验证修复影响.py
✅ 验证修复质量.py
✅ 验证分Sheet修改.py
✅ 验证利润计算.py
✅ 验证可视化功能.py
✅ 验证导入结果.py
✅ 验证库存数据.py
✅ 验证数据处理器整合.py
✅ 验证数据字段一致性.py
✅ 验证看板数据准确性.py

# C. 诊断脚本（3个）
✅ diagnose_data.py                  # 数据诊断
✅ diagnose_data_fields.py           # 数据字段诊断
✅ debug_date_filter.py              # 日期过滤调试
```

---

### 3️⃣ 临时分析脚本（15个，~120 KB）

**一次性分析脚本 - 可删除**：

```python
✅ analyze_git_diff.py               # Git差异分析
✅ 分析利润额.py                     # 利润分析
✅ 分析数据差异.py                   # 数据差异分析
✅ 分析配送费计算.py                 # 配送费分析
✅ 商品分类结构分析.py               # 分类结构分析
✅ 客单价与商品角色相关性分析.py     # 相关性分析
✅ 对比Excel和数据库数据.py          # 数据对比
✅ 对比利润公式.py                   # 公式对比
✅ 对比数据差异.py                   # 差异对比
✅ 按文档计算配送成本.py             # 配送成本计算验证
✅ 提取Streamlit数据.py              # Streamlit数据提取
✅ 提取Streamlit数据_最终正确版.py
✅ 提取Streamlit数据_正确版本.py
✅ 演示新表格结构.py                 # 表格演示
✅ 演示涨降价计算.py                 # 涨降价演示
```

---

### 4️⃣ 一次性修复/工具脚本（10个，~80 KB）

```python
✅ fix_combo_types.py                # 组合类型修复（已完成）
✅ tab5_echarts_补充修复.py          # Tab5 ECharts补充修复（已完成）
✅ 批量修复return_fig.py             # 批量修复（已完成）
✅ 恢复方案说明.py                   # 临时恢复脚本
✅ replace_main.py                   # 替换工具（一次性）
✅ 替换Tab4新UI.py                   # Tab4替换（已完成）
✅ 重构Tab4_安全版.py                # 重构脚本（已完成）
✅ 批量清理文件日志.py               # 清理工具
✅ 清理门店数据.py                   # 门店数据清理（一次性）
✅ 数据一致性验证脚本.py             # 一致性验证（已完成）
```

---

### 5️⃣ 一次性数据导入脚本（2个，~20 KB）

```python
✅ 重新导入Excel数据.py              # 一次性重导（已完成）
✅ 重新导入海门店数据.py             # 一次性重导特定门店（已完成）
```

**注意**: `智能导入门店数据.py` 是核心工具，**不能删除**！

---

### 6️⃣ 临时数据库操作脚本（3个，~30 KB）

```python
✅ create_database.py                # 数据库创建（如果已创建可删除）
✅ quick_migrate.py                  # 快速迁移（一次性工具）
✅ quick_setup.py                    # 快速设置（一次性工具）
```

**评估建议**: 如果数据库已稳定运行，这些可以删除

---

## ⚠️ 需要确认的文件

### 1️⃣ 旧版/简化版程序（需确认是否还在使用）

```python
⚠️ dashboard_integrated.py          # 集成版看板（如果只用Dash版可删）
⚠️ dashboard_with_source_switch.py  # 数据源切换版（功能已集成？）
⚠️ main_simplified.py               # 简化版主程序（如果不用）
⚠️ 智能门店看板_简化版.py           # 简化版看板（如果不用）
⚠️ 智能门店经营看板_可视化.py       # 旧版可视化（功能已集成到Dash版？）
⚠️ price_comparison_dashboard.py    # 比价看板（如果不用比价功能）
⚠️ mqpd.py                          # 需确认用途
⚠️ 多商品订单引导分析看板.py        # 独立看板（如果不用）
⚠️ 销量下滑诊断_增强版.py           # 增强版（功能已集成？）
⚠️ 订单分析增强模块.py              # 增强模块（功能已集成？）
⚠️ 订单概览计算公式详解.py          # 公式说明（是文档还是代码？）
```

**建议**: 逐个检查是否被主程序导入

---

### 2️⃣ 多余的启动脚本（建议只保留2-3个）

```powershell
⚠️ 启动看板.bat                     # 保留
⚠️ 启动看板-后台模式.bat             # 可删除（功能重复）
⚠️ 停止看板.bat                     # 保留
⚠️ 启动看板.ps1                     # 可删除（与.bat重复）
⚠️ 启动Dash看板.ps1                 # 保留（推荐）
⚠️ 启动看板_Python311.ps1           # 可删除（版本特定）
⚠️ 启动看板_新.ps1                  # 可删除（临时）
⚠️ 启动看板_显示日志.ps1            # 可删除（调试用）
⚠️ 启动看板_简易版.ps1              # 可删除（简化版）
⚠️ 启动P1_P2_P3.ps1                 # 如果不用P1P2P3模式可删
⚠️ 启动多商品分析看板.ps1           # 如果不用可删
```

**推荐保留**: `启动Dash看板.ps1`、`启动全栈服务.ps1`、`停止看板.bat`

---

### 3️⃣ 清理工具脚本（执行后可删除）

```powershell
⚠️ 清理过时文件.ps1                 # 可删除
⚠️ 清理过时文件_安全版.ps1          # 保留一个即可
```

---

### 4️⃣ 示例数据

```json
⚠️ demo_price_data.json              # 如果不需要演示可删
```

---

### 5️⃣ 过时的开发文档（建议归档而非删除）

**建议操作**: 移动到 `已归档文件_历史开发文档/` 文件夹

```markdown
# Tab开发文档（19个）
⚠️ Tab1-7开发启动报告.md
⚠️ Tab1订单概览开发完成报告.md
⚠️ Tab2_布局优化报告.md
⚠️ Tab2_重构完成报告.md
⚠️ Tab2_问题修复报告.md
⚠️ Tab2_饼图布局优化方案.md
⚠️ Tab2商品分析开发完成报告.md
⚠️ Tab4.1测试指南.md
⚠️ Tab4.1重新设计说明.md
⚠️ Tab4.2_客单价归因_完成报告.md
⚠️ Tab4.3-4.5-4.6_修复说明.md
⚠️ Tab4.3-4.6_问题诊断_完成报告.md
⚠️ Tab4_功能测试清单.md
⚠️ Tab4_快速测试指南.md
⚠️ Tab4重构优化清单.md
⚠️ Tab4重构方案.md
⚠️ Tab4重构进展报告.md
⚠️ Tab5_500错误诊断指南.md
⚠️ Tab5问题修复完成报告.md

# 修复报告（42个）
⚠️ NaT错误修复总结.md
⚠️ 修复完成报告.md
⚠️ 修复后测试指南.md
⚠️ 代码质量修复完成报告.md
⚠️ 代码质量修复报告.md
⚠️ 低频商品售罄判定修复完成报告.md
⚠️ 历史数据缓存优化修复报告.md
⚠️ 去重逻辑修复说明.md
⚠️ 去重逻辑紧急修复报告.md
⚠️ 可视化图表问题修复总结.md
⚠️ 售罄判定修复前后对比.md
⚠️ 售罄判定逻辑修复完成报告.md
⚠️ 售罄判定逻辑缺陷分析-28寸行李箱案例.md
⚠️ 售罄判定逻辑说明.md
⚠️ 售罄判定逻辑问题分析.md
⚠️ 商品排行JSON序列化错误修复.md
⚠️ 商品排行问题诊断报告.md
⚠️ 图表响应式配置完整修复报告.md
⚠️ 图表字段匹配修复说明.md
⚠️ 场景时段匹配修复说明.md
⚠️ 场景营销看板完整修复说明.md
⚠️ 场景营销看板恢复说明.md
⚠️ 场景营销问题诊断恢复说明.md
⚠️ 展示逻辑重构完成报告.md
⚠️ 展示逻辑重构方案.md
⚠️ 问题修复报告_页面滚动和数据显示.md
⚠️ 问题诊断列兼容性修复说明.md
⚠️ 问题诊断商品级别分析修复说明.md
⚠️ 问题诊断字段显示修复说明.md
⚠️ 问题诊断数值格式化修复说明.md

# Dash迁移文档（11个）
⚠️ Dash优化执行计划.md
⚠️ Dash性能优化方案.md
⚠️ Dash数据错误诊断报告.md
⚠️ Dash版100%集成_执行计划.md
⚠️ Dash版100%集成_时间评估.md
⚠️ Dash版功能扩展计划.md
⚠️ Dash版功能测试清单.md
⚠️ Dash版迁移完成报告.md
⚠️ Dash看板统一计算标准.md
⚠️ Streamlit vs Dash技术迁移总结报告.md
⚠️ Streamlit到Dash功能迁移路线图.md

# 其他历史文档（10个）
⚠️ Phase_1_2_安全优化完成报告.md
⚠️ 会话1_完成报告.md
⚠️ 会话1完整功能验收报告.md
⚠️ 开发完成总结.md
⚠️ 整体迁移进度报告.md
⚠️ 整合验证成功确认.md
⚠️ 方案A实施完成.md
⚠️ 模块整合评估报告.md
⚠️ 紧急修复_耗材数据剔除逻辑缺失.md
⚠️ 紧急问题分析_日历选择器无法显示.md
```

---

## ❌ 绝对不能删除的重要文件

### ⭐ 核心主程序

```python
✓ 智能门店看板_Dash版.py            # 主程序！
```

### ⭐ 核心数据处理器

```python
✓ 订单数据处理器.py                 # 核心处理器
✓ 真实数据处理器.py                 # 核心处理器
✓ 学习数据管理系统.py               # 学习系统
✓ 自适应学习引擎.py                 # 学习引擎
✓ 增量学习优化器.py                 # 优化器
✓ 智能导入门店数据.py               # 智能导入工具 ⭐
```

### ⭐ 智能引擎和分析模块

```python
✓ 商品场景智能打标引擎.py           # 场景打标引擎
✓ 场景营销智能决策引擎.py           # 决策引擎
✓ 问题诊断引擎.py                   # 诊断引擎
✓ scene_inference.py                # 场景推断
```

### ⭐ AI 模块

```python
✓ ai_analyzer.py                    # AI分析器
✓ ai_business_context.py            # 业务上下文
✓ ai_pandasai_integration.py        # PandasAI集成
✓ ai_rag_knowledge_base.py          # RAG知识库
✓ gemini_ai_助手.py                 # Gemini助手
```

### ⭐ 可视化和图表

```python
✓ echarts_factory.py                # ECharts工厂
✓ echarts_responsive_utils.py       # 响应式工具
✓ waterfall_chart.py                # 瀑布图
✓ tab5_extended_renders.py          # Tab5扩展渲染
```

### ⭐ 工具函数

```python
✓ cache_utils.py                    # 缓存工具
✓ monitor_logs.py                   # 日志监控
```

### ⭐ 数据库模块（整个目录）

```
✓ database/
  ✓ __init__.py
  ✓ connection.py                   # 数据库连接
  ✓ models.py                       # 数据模型
  ✓ migrate.py                      # 迁移工具
  ✓ data_source_manager.py          # 数据源管理器
  ✓ batch_import.py                 # 批量导入
  ✓ auto_upgrade.py                 # 自动升级
  ✓ add_marketing_fields.py         # 营销字段迁移
  ✓ migrate_orders.py               # 订单迁移
  ✓ upgrade_order_table.py          # 表升级
  ✓ simple_order_import.py          # 简单导入
  ✓ quiet_import.py                 # 静默导入
```

### ⭐ 后端服务（整个目录）

```
✓ backend/
  ✓ __init__.py
  ✓ main.py                         # 后端主程序
  ✓ api/
    ✓ __init__.py
    ✓ analysis.py                   # 分析API
    ✓ orders.py                     # 订单API
    ✓ products.py                   # 商品API
    ✓ scenes.py                     # 场景API
```

### ⭐ 核心标准和工具

```python
✓ DATABASE_FIRST_STANDARD.py        # 数据库优先标准
✓ 自定义导入示例.py                 # 导入示例（可能是文档）
```

### ⭐ 配置文件

```
✓ .env                              # 环境配置
✓ .env.example                      # 配置示例
✓ .env.template                     # 配置模板
✓ .gitignore                        # Git忽略
✓ requirements.txt                  # 依赖清单
```

### ⭐ 核心启动脚本

```powershell
✓ 启动Dash看板.ps1                  # 推荐启动方式
✓ 启动全栈服务.ps1                  # 全栈服务
✓ 启动全栈服务_自动.py              # 自动启动
✓ setup_database.ps1                # 数据库设置
```

### ⭐ 核心文档

```markdown
✓ README.md
✓ README_Dash版.md
✓ README_Dash版使用指南.md
✓ README_可视化看板.md
✓ README_文档索引.md
✓ 智能门店看板_Dash版使用指南.md
✓ 快速启动指南.md
✓ 业务逻辑最终确认.md              # 业务逻辑核心文档
✓ 业务逻辑核心知识库.md
✓ 数据结构统一标准.md              # 数据标准核心文档
✓ API_KEY_配置指南.md
✓ GLM-4.6接入指南.md
✓ 部署指南_PostgreSQL.md
✓ 云端看板部署与管理手册.md
✓ 部署清单.md
✓ 交付清单.md
✓ ECharts响应式功能说明.md
✓ 实现完成清单-ECharts响应式.md
✓ 依赖和环境说明.md

# 功能说明文档（重要参考）
✓ O2O场景营销定义文档.md
✓ 商品场景智能打标_快速启动指南.md
✓ 商品场景智能打标_集成指南.md
✓ 场景营销智能决策引擎_使用指南.md
✓ 多商品订单引导分析_使用指南.md
✓ 时段与场景业务设计文档.md
✓ 时段与场景自动生成快速参考.md

# 业务逻辑文档
✓ 涨价销量增和已下架判定说明.md
✓ 涨降价判定快速参考.md
✓ 判定类型快速参考.md
✓ 单价计算逻辑说明.md
✓ 配送费成本计算说明.md
✓ 流量品折扣逻辑说明.md
✓ 售罄判定逻辑说明.md

# 使用指南
✓ 客单价优化完整方案总结.md
✓ 客单价分析分Sheet输出使用说明.md
✓ 客单价归因分析优化总结.md
✓ 销量下滑可视化使用指南.md
✓ 销量下滑可视化功能说明.md
✓ 销量下滑诊断_周期对比与预计收入功能说明.md
✓ 销量下滑诊断_日维度功能说明.md
```

### ⭐ 数据目录

```
✓ 学习数据仓库/                    # 学习数据
✓ 智能模型仓库/                    # AI模型
✓ 知识库/                          # RAG知识库
✓ 实际数据/                        # 实际业务数据
✓ 门店数据/                        # 门店数据
✓ 竞对情报报告/                    # 竞品分析
✓ 测试报告/                        # 测试报告
✓ assets/                          # 静态资源
✓ image/                           # 图片资源
✓ backups/                         # 备份数据
✓ __pycache__/                     # Python缓存
```

---

## 🚀 推荐执行方案

### 方案A：保守清理（强烈推荐）

**只删除明确的测试/检查/验证脚本**

```powershell
cd "D:\Python1\O2O_Analysis\O2O数据分析\测算模型"

# 1. 删除test_开头的测试脚本
Remove-Item "test_*.py" -Force -ErrorAction SilentlyContinue

# 2. 删除中文测试脚本
Remove-Item "测试*.py" -Force -ErrorAction SilentlyContinue

# 3. 删除检查脚本
Remove-Item "检查*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "check_*.py" -Force -ErrorAction SilentlyContinue

# 4. 删除验证脚本
Remove-Item "验证*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "verify_*.py" -Force -ErrorAction SilentlyContinue

# 5. 删除诊断脚本
Remove-Item "diagnose_*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "debug_*.py" -Force -ErrorAction SilentlyContinue

# 6. 删除临时分析脚本
Remove-Item "分析*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "对比*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "演示*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "提取*.py" -Force -ErrorAction SilentlyContinue

# 7. 删除一次性工具
Remove-Item "重新导入*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "快速*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "最小化*.py" -Force -ErrorAction SilentlyContinue

Write-Host "✅ 保守清理完成！" -ForegroundColor Green
Write-Host "📊 预计删除 ~110个 文件，释放约 900 KB" -ForegroundColor Cyan
```

**预期效果**: 
- 删除约 110个 测试/检查/验证脚本
- 释放约 900 KB
- 保留所有核心功能和文档

---

### 方案B：完整清理（包含文档归档）

```powershell
cd "D:\Python1\O2O_Analysis\O2O数据分析\测算模型"

# 1. 创建归档目录
New-Item -ItemType Directory -Path "已归档文件_历史开发文档_20251106" -Force

# 2. 归档历史文档（不删除）
Move-Item "*开发报告*.md" "已归档文件_历史开发文档_20251106/" -Force -ErrorAction SilentlyContinue
Move-Item "*完成报告*.md" "已归档文件_历史开发文档_20251106/" -Force -ErrorAction SilentlyContinue
Move-Item "*修复*.md" "已归档文件_历史开发文档_20251106/" -Force -ErrorAction SilentlyContinue
Move-Item "*诊断*.md" "已归档文件_历史开发文档_20251106/" -Force -ErrorAction SilentlyContinue
Move-Item "*迁移*.md" "已归档文件_历史开发文档_20251106/" -Force -ErrorAction SilentlyContinue
Move-Item "Tab*.md" "已归档文件_历史开发文档_20251106/" -Force -ErrorAction SilentlyContinue
Move-Item "Dash*.md" "已归档文件_历史开发文档_20251106/" -Force -ErrorAction SilentlyContinue
Move-Item "Streamlit*.md" "已归档文件_历史开发文档_20251106/" -Force -ErrorAction SilentlyContinue

# 3. 删除脚本（同方案A）
Remove-Item "test_*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "测试*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "检查*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "check_*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "验证*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "verify_*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "diagnose_*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "debug_*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "分析*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "对比*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "演示*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "提取*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "重新导入*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "快速*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "最小化*.py" -Force -ErrorAction SilentlyContinue

# 4. 删除一次性修复工具
Remove-Item "fix_*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "批量*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "replace_*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "替换*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "重构*.py" -Force -ErrorAction SilentlyContinue
Remove-Item "恢复*.py" -Force -ErrorAction SilentlyContinue

# 5. 删除多余启动脚本
Remove-Item "启动看板_*.ps1" -Force -ErrorAction SilentlyContinue
Remove-Item "启动P1_P2_P3.ps1" -Force -ErrorAction SilentlyContinue
Remove-Item "启动多商品*.ps1" -Force -ErrorAction SilentlyContinue

Write-Host "✅ 完整清理完成！" -ForegroundColor Green
Write-Host "📁 文档已归档到: 已归档文件_历史开发文档_20251106/" -ForegroundColor Cyan
Write-Host "📊 预计删除 ~120个 文件，归档 ~80个 文档" -ForegroundColor Yellow
```

---

## ⚠️ 安全检查清单

### 删除前必做：

- [ ] **1. Git提交当前更改**
  ```powershell
  git status
  git add .
  git commit -m "清理前保存状态"
  ```

- [ ] **2. 创建完整备份**
  ```powershell
  Compress-Archive -Path "D:\Python1\O2O_Analysis\O2O数据分析\测算模型" `
                   -DestinationPath "D:\测算模型_清理前完整备份_20251106.zip" `
                   -CompressionLevel Optimal
  ```

- [ ] **3. 停止所有运行的看板**
  ```powershell
  Get-Process | Where-Object {$_.Path -like "*python*"} | Stop-Process -Force
  ```

- [ ] **4. 执行清理方案A**（保守）

- [ ] **5. 测试核心功能**
  ```powershell
  .\启动Dash看板.ps1
  # 测试所有Tab功能
  # 测试数据库加载
  # 测试AI分析
  ```

- [ ] **6. 如果测试通过，可选执行方案B**（归档文档）

- [ ] **7. Git提交清理后的代码**
  ```powershell
  git add .
  git commit -m "清理测试和验证脚本，归档历史文档"
  ```

---

## 📊 预期清理效果

### 方案A（保守清理）
- **删除文件**: ~110个
- **释放空间**: ~900 KB
- **保留**: 所有核心功能、文档
- **风险**: 极低

### 方案B（完整清理）
- **删除文件**: ~120个
- **归档文档**: ~80个
- **释放空间**: ~1.2 MB
- **保留**: 所有核心功能
- **风险**: 低（文档只是移动，未删除）

---

## 📋 特别注意

### ✓ 这些文件虽然名字像临时文件，但必须保留：

```python
✓ 智能导入门店数据.py              # 核心导入工具，不是临时脚本！
✓ 订单概览计算公式详解.py          # 需确认是代码还是文档
✓ 自定义导入示例.py                # 可能是导入模板，需确认
✓ DATABASE_FIRST_STANDARD.py       # 数据库优先标准，核心
```

### ✓ 这些文件需要手动确认用途：

```python
? mqpd.py                           # 缩写名称，无法判断用途
? 销量下滑诊断_增强版.py            # 是否已集成到主程序？
? 订单分析增强模块.py               # 是否已集成到主程序？
? 多商品订单引导分析看板.py         # 是否独立使用？
```

---

**需要我帮您执行清理吗？**

1. 🟢 执行方案A（保守清理 - 推荐）
2. 🟡 执行方案B（完整清理 + 文档归档）
3. 🔵 先手动确认可疑文件，再决定
4. ⚪ 我自己手动处理

**这个版本更严谨了吗？** 😊
