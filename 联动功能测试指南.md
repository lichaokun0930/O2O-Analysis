# 六象限与调价计算器联动功能 - 测试指南

> **测试时间**: 2025-12-10  
> **版本**: V3.0  
> **预计测试时间**: 15-20分钟

---

## 🎯 测试目标

验证六象限分析与智能调价计算器的联动功能是否正常工作。

---

## 📋 测试前准备

### 1. 启动看板

```powershell
# 在O2O-Analysis目录下执行
.\启动看板.ps1
```

### 2. 选择测试门店

建议使用：**祥和路店**（数据完整，商品数量适中）

### 3. 确认数据加载

等待数据加载完成，确保顶部显示：
```
✅ 数据已加载：祥和路店 | 全部数据 | 全部渠道
```

---

## 🧪 测试用例

### 测试用例1：从六象限跳转到调价计算器（主流程）

#### 步骤

1. **进入商品健康分析**
   - 点击顶部Tab：`Tab7: 今日必做`
   - 等待页面加载完成

2. **查看六象限分布**
   - 点击子Tab：`🎯 六象限分布`
   - 确认看到六象限进度条列表

3. **点击"调价"按钮**
   - 找到 `💎 潜力商品` 行
   - 点击右侧的 `[调价]` 按钮
   - **预期**: 自动跳转到 `Tab8: 智能调价计算器`

4. **验证面包屑导航**
   - 查看页面顶部是否显示：
     ```
     📍 来源：商品健康分析 > 💎 潜力商品 [← 返回]
     ```
   - **预期**: 显示正确的来源信息

5. **验证智能建议**
   - 查看是否显示智能建议卡片：
     ```
     💡 智能建议：降价促销
     潜力商品利润好但销量低，建议降价促销提升销量。
     建议降价幅度：5-15%，目标利润率：15%
     ```
   - **预期**: 显示黄色警告卡片

6. **验证调价场景自动选中**
   - 查看快捷场景按钮
   - **预期**: `🎯 促销引流` 按钮被选中（非outline状态）

7. **验证目标利润率自动填充**
   - 查看目标利润率输入框
   - **预期**: 显示 `15`

8. **点击"返回"按钮**
   - 点击面包屑导航中的 `[← 返回]` 按钮
   - **预期**: 返回到 `Tab7: 今日必做` 的六象限分布页面

#### 预期结果

✅ 所有步骤都按预期执行  
✅ 数据正确传递  
✅ 智能建议正确匹配  
✅ 返回功能正常

---

### 测试用例2：测试不同象限的智能建议

#### 步骤

依次点击不同象限的"调价"按钮，验证智能建议是否正确：

| 象限 | 预期场景 | 预期建议标题 | 预期目标利润率 | 预期卡片颜色 |
|------|---------|-------------|--------------|-------------|
| 🌟 明星商品 | 利润修复 | 测试性提价 | 25% | 绿色（success） |
| 💎 潜力商品 | 促销引流 | 降价促销 | 15% | 黄色（warning） |
| ⚡ 自然引流 | 利润修复 | 小幅提价 | 20% | 绿色（success） |
| 🐌 低效商品 | 滞销清仓 | 清仓降价 | 8% | 红色（danger） |
| 🔥 畅销商品 | 利润修复 | 谨慎提价 | 18% | 绿色（success） |
| 🎯 策略引流 | 亏损止血 | 监控效果 | 5% | 灰色（secondary） |

#### 验证方法

1. 点击象限的"调价"按钮
2. 查看智能建议卡片的标题、描述、颜色
3. 查看目标利润率是否自动填充正确
4. 点击"返回"按钮，返回六象限分析
5. 重复测试下一个象限

#### 预期结果

✅ 所有象限的智能建议都正确匹配  
✅ 目标利润率自动填充正确  
✅ 卡片颜色符合预期

---

### 测试用例3：在调价计算器中选择象限（补充流程）

#### 步骤

1. **直接进入调价计算器**
   - 点击顶部Tab：`Tab8: 智能调价计算器`
   - 点击子Tab：`🎭 智能调价`

2. **点击"选择象限"按钮**
   - 找到 `📊 六象限商品` 卡片
   - 点击 `[选择象限]` 按钮
   - **预期**: 显示下拉框

3. **查看下拉框选项**
   - 查看下拉框是否显示所有象限及商品数量
   - **预期**: 显示如下选项：
     ```
     🌟 明星商品 (218个)
     💎 潜力商品 (160个)
     ⚡ 自然引流 (120个)
     🐌 低效商品 (200个)
     🔥 畅销商品 (65个)
     🎯 策略引流 (30个)
     ```

4. **选择象限**
   - 从下拉框中选择 `💎 潜力商品 (160个)`
   - **预期**: 显示智能建议卡片

5. **验证智能建议**
   - 查看是否显示：
     ```
     💡 智能建议：降价促销
     潜力商品利润好但销量低，建议降价促销提升销量。
     ```
   - **预期**: 显示黄色警告卡片

6. **验证调价场景和目标利润率**
   - 查看快捷场景按钮是否选中 `🎯 促销引流`
   - 查看目标利润率是否为 `15`
   - **预期**: 都正确

#### 预期结果

✅ 下拉框正常显示  
✅ 选项显示商品数量  
✅ 选择后智能建议正确  
✅ 场景和利润率自动匹配

---

### 测试用例4：计算调价方案（完整流程）

#### 步骤

1. **从六象限跳转**
   - 进入 `Tab7: 今日必做` > `🎯 六象限分布`
   - 点击 `💎 潜力商品` 的 `[调价]` 按钮

2. **验证数据加载**
   - 确认智能建议显示：降价促销
   - 确认目标利润率：15%

3. **点击"计算调价方案"**
   - 点击 `[💰 计算调价方案]` 按钮
   - **预期**: 显示加载动画

4. **查看调价建议表格**
   - 等待计算完成
   - **预期**: 显示调价建议表格，包含：
     - 商品名称
     - 当前价格
     - 建议价格
     - 预估销量变化
     - 预估利润变化

5. **验证商品数量**
   - 查看表格中的商品数量
   - **预期**: 应该与六象限中的潜力商品数量一致（160个）

6. **验证调价方向**
   - 查看建议价格是否低于当前价格（降价）
   - **预期**: 大部分商品建议降价

#### 预期结果

✅ 调价方案计算成功  
✅ 表格数据完整  
✅ 商品数量一致  
✅ 调价方向正确

---

### 测试用例5：边界情况测试

#### 测试5.1：无商品的象限

**步骤**:
1. 找到商品数量为0的象限（如果有）
2. 查看"调价"按钮是否禁用
3. **预期**: 按钮禁用，无法点击

#### 测试5.2：切换门店后的数据一致性

**步骤**:
1. 在六象限分析中查看潜力商品数量（如160个）
2. 点击"调价"按钮跳转
3. 在调价计算器中，切换到其他门店
4. 返回六象限分析
5. 再次点击"调价"按钮
6. **预期**: 商品数量应该更新为新门店的数据

#### 测试5.3：切换渠道后的数据一致性

**步骤**:
1. 在六象限分析中选择"美团闪购"渠道
2. 查看潜力商品数量
3. 点击"调价"按钮跳转
4. **预期**: 调价计算器中的商品应该只包含美团闪购渠道的商品

---

## 🐛 常见问题排查

### 问题1：点击"调价"按钮没有反应

**可能原因**:
- 数据未加载完成
- 回调函数报错

**排查方法**:
1. 打开浏览器控制台（F12）
2. 查看Console是否有错误信息
3. 查看Network是否有请求失败

**解决方案**:
- 等待数据加载完成
- 刷新页面重试
- 查看后端日志

### 问题2：智能建议不显示

**可能原因**:
- pricing-source-context数据未传递
- 回调函数未触发

**排查方法**:
1. 打开浏览器控制台
2. 查看是否有 `[联动]` 开头的日志
3. 查看Store组件的数据是否正确

**解决方案**:
- 检查Store组件是否正确添加
- 检查回调函数是否正确注册

### 问题3：商品数量不一致

**可能原因**:
- 门店或渠道筛选不一致
- 数据未更新

**排查方法**:
1. 查看六象限分析的筛选条件（门店、渠道）
2. 查看调价计算器的筛选条件
3. 对比两者是否一致

**解决方案**:
- 确保跳转时传递了门店和渠道信息
- 在跳转回调中重新计算商品数据

### 问题4：返回按钮不工作

**可能原因**:
- 回调函数未注册
- 按钮ID不正确

**排查方法**:
1. 查看浏览器控制台是否有错误
2. 检查按钮ID是否为 `pricing-back-to-source`

**解决方案**:
- 检查回调函数 `back_to_source()` 是否正确注册
- 检查按钮ID是否正确

---

## ✅ 测试通过标准

### 功能完整性

- [ ] 所有象限的"调价"按钮都能正常工作
- [ ] 面包屑导航正确显示
- [ ] 智能建议正确匹配所有象限
- [ ] 调价场景自动选中
- [ ] 目标利润率自动填充
- [ ] 返回按钮正常工作
- [ ] 下拉框选择象限正常工作

### 数据准确性

- [ ] 商品数量与六象限一致
- [ ] 商品数据完整（名称、价格、成本等）
- [ ] 切换门店后数据更新
- [ ] 切换渠道后数据更新

### 用户体验

- [ ] 跳转流畅，无卡顿
- [ ] 智能建议清晰易懂
- [ ] 操作逻辑符合直觉
- [ ] 无明显bug或错误

---

## 📊 测试结果记录

### 测试环境

- **测试时间**: ___________
- **测试人员**: ___________
- **看板版本**: V3.0
- **浏览器**: ___________
- **测试门店**: ___________

### 测试结果

| 测试用例 | 状态 | 备注 |
|---------|------|------|
| 测试用例1：从六象限跳转 | ⬜ 通过 / ⬜ 失败 | |
| 测试用例2：不同象限智能建议 | ⬜ 通过 / ⬜ 失败 | |
| 测试用例3：下拉框选择象限 | ⬜ 通过 / ⬜ 失败 | |
| 测试用例4：计算调价方案 | ⬜ 通过 / ⬜ 失败 | |
| 测试用例5：边界情况 | ⬜ 通过 / ⬜ 失败 | |

### 发现的问题

1. ___________
2. ___________
3. ___________

### 改进建议

1. ___________
2. ___________
3. ___________

---

## 📝 测试总结

### 总体评价

⬜ 优秀 - 所有功能正常，用户体验良好  
⬜ 良好 - 主要功能正常，有小问题但不影响使用  
⬜ 一般 - 部分功能有问题，需要修复  
⬜ 较差 - 多个功能有问题，需要重新开发

### 是否可以发布

⬜ 可以发布  
⬜ 修复问题后发布  
⬜ 需要重新开发

---

**测试完成时间**: ___________  
**测试人员签名**: ___________

