# ç¯æ¯”æ•°æ®æ˜¾ç¤ºé—®é¢˜ä¿®å¤

## é—®é¢˜æè¿°

å®¢å•ä»·(aov)ã€å•å‡é…é€è´¹(avg_delivery_fee)ã€å•å‡è¥é”€è´¹(avg_marketing_cost) çš„ç¯æ¯”æ•°æ®åœ¨å‰ç«¯è¡¨æ ¼ä¸­ä¸æ˜¾ç¤ºã€‚

## æ ¹æœ¬åŸå› 

**TypeScriptç±»å‹å®šä¹‰ä¸å®Œæ•´**

`frontend-react/src/types/index.ts` ä¸­çš„ `StoreWeekOverWeekData` æ¥å£ç¼ºå°‘æ–°å¢çš„å­—æ®µå®šä¹‰ï¼š
- `aov`
- `avg_delivery_fee`
- `avg_marketing_cost`
- `delivery_cost_rate`
- `marketing_cost_rate`

è™½ç„¶åç«¯APIæ­£ç¡®è¿”å›äº†è¿™äº›å­—æ®µï¼Œä½†å‰ç«¯TypeScriptç±»å‹å®šä¹‰æ²¡æœ‰åŒ…å«å®ƒä»¬ï¼Œå¯¼è‡´æ•°æ®æ— æ³•æ­£ç¡®ä¼ é€’å’Œæ˜¾ç¤ºã€‚

## ä¿®å¤å†…å®¹

### 1. æ›´æ–°TypeScriptç±»å‹å®šä¹‰

**æ–‡ä»¶**: `frontend-react/src/types/index.ts`

```typescript
/** é—¨åº—ç¯æ¯”æ•°æ® */
export interface StoreWeekOverWeekData {
  store_name: string;
  current: {
    order_count: number;
    total_revenue: number;
    total_profit: number;
    profit_margin: number;
    aov: number;                      // âœ… æ–°å¢
    avg_delivery_fee: number;         // âœ… æ–°å¢
    avg_marketing_cost: number;       // âœ… æ–°å¢
    delivery_cost_rate: number;       // âœ… æ–°å¢
    marketing_cost_rate: number;      // âœ… æ–°å¢
  };
  changes: {
    order_count: number;
    revenue: number;
    profit: number;
    profit_margin: number;
    aov: number;                      // âœ… æ–°å¢
    avg_delivery_fee: number;         // âœ… æ–°å¢
    avg_marketing_cost: number;       // âœ… æ–°å¢
    delivery_cost_rate: number;       // âœ… æ–°å¢
    marketing_cost_rate: number;      // âœ… æ–°å¢
  };
}
```

### 2. æ·»åŠ è°ƒè¯•æ—¥å¿—

ä¸ºäº†ä¾¿äºæ’æŸ¥é—®é¢˜ï¼Œåœ¨ä»¥ä¸‹æ–‡ä»¶ä¸­æ·»åŠ äº†è°ƒè¯•æ—¥å¿—ï¼š

**æ–‡ä»¶**: `frontend-react/src/views/StoreComparisonView.tsx`
- åœ¨åˆå¹¶ç¯æ¯”æ•°æ®æ—¶æ‰“å°ç¬¬ä¸€ä¸ªé—¨åº—çš„æ•°æ®ç»“æ„
- éªŒè¯å­—æ®µæ˜¯å¦å­˜åœ¨

**æ–‡ä»¶**: `frontend-react/src/components/StoreComparisonTable.tsx`
- åœ¨è¡¨æ ¼ç»„ä»¶ä¸­æ‰“å°æ¥æ”¶åˆ°çš„ç¯æ¯”æ•°æ®
- æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„å­—æ®µå

### 3. ä¿®æ­£æµ‹è¯•è„šæœ¬ç«¯å£

**æ–‡ä»¶**: `test_week_over_week_response.py`
- å°†APIç«¯å£ä» 8000 æ”¹ä¸º 8080ï¼ˆæ­£ç¡®çš„åç«¯ç«¯å£ï¼‰

## éªŒè¯æ­¥éª¤

### 1. å‰ç«¯ç¼–è¯‘éªŒè¯

```bash
cd frontend-react
npm run build
```

âœ… ç¼–è¯‘æˆåŠŸï¼Œæ— TypeScripté”™è¯¯

### 2. åç«¯APIéªŒè¯

åç«¯ä»£ç å·²ç»æ­£ç¡®è¿”å›æ‰€æœ‰9ä¸ªæŒ‡æ ‡çš„ç¯æ¯”æ•°æ®ï¼š
- order_count
- revenue
- profit
- profit_margin
- aov âœ…
- avg_delivery_fee âœ…
- avg_marketing_cost âœ…
- delivery_cost_rate
- marketing_cost_rate

### 3. å‰ç«¯æ˜¾ç¤ºéªŒè¯

å¯åŠ¨å‰ç«¯åï¼Œåœ¨æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹è°ƒè¯•æ—¥å¿—ï¼š
```
ğŸ” [ç¯æ¯”æ•°æ®] ç¬¬ä¸€ä¸ªé—¨åº—çš„ç¯æ¯”æ•°æ®: {...}
ğŸ” [è¡¨æ ¼] ç¬¬ä¸€ä¸ªé—¨åº—çš„ç¯æ¯”æ•°æ®: {...}
```

ç¡®è®¤ `aov`, `avg_delivery_fee`, `avg_marketing_cost` å­—æ®µå­˜åœ¨ä¸”æœ‰å€¼ã€‚

## æ•°æ®æµç¨‹

```
åç«¯API (store_comparison.py)
  â†“ è¿”å›å®Œæ•´çš„ç¯æ¯”æ•°æ®ï¼ˆåŒ…å«æ‰€æœ‰9ä¸ªæŒ‡æ ‡ï¼‰
APIå®¢æˆ·ç«¯ (storeComparison.ts)
  â†“ æ¥æ”¶å“åº”
StoreComparisonView
  â†“ åˆå¹¶æ•°æ®: weekOverWeek: weekOverWeek?.changes
StoreComparisonTable
  â†“ æ¸²æŸ“: store.weekOverWeek?.aov
æµè§ˆå™¨æ˜¾ç¤º âœ…
```

## ç›¸å…³æ–‡ä»¶

- âœ… `frontend-react/src/types/index.ts` - ç±»å‹å®šä¹‰å·²ä¿®å¤
- âœ… `frontend-react/src/views/StoreComparisonView.tsx` - æ·»åŠ è°ƒè¯•æ—¥å¿—
- âœ… `frontend-react/src/components/StoreComparisonTable.tsx` - æ·»åŠ è°ƒè¯•æ—¥å¿—
- âœ… `test_week_over_week_response.py` - ç«¯å£å·²ä¿®æ­£
- âœ… `backend/app/api/v1/store_comparison.py` - åç«¯é€»è¾‘æ­£ç¡®ï¼ˆæ— éœ€ä¿®æ”¹ï¼‰

## ä¸‹ä¸€æ­¥

1. **å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨**
   ```bash
   cd frontend-react
   npm run dev
   ```

2. **è®¿é—®å…¨é‡é—¨åº—å¯¹æ¯”é¡µé¢**
   - æ‰“å¼€æµè§ˆå™¨: http://localhost:5173
   - ç‚¹å‡»å·¦ä¾§å¯¼èˆª "å…¨é‡é—¨åº—å¯¹æ¯”"

3. **æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°**
   - æŸ¥çœ‹è°ƒè¯•æ—¥å¿—ç¡®è®¤æ•°æ®æ­£ç¡®ä¼ é€’
   - éªŒè¯è¡¨æ ¼ä¸­æ˜¾ç¤ºç¯æ¯”æ•°æ®

4. **ç§»é™¤è°ƒè¯•æ—¥å¿—ï¼ˆå¯é€‰ï¼‰**
   - ç¡®è®¤é—®é¢˜è§£å†³åï¼Œå¯ä»¥åˆ é™¤æ·»åŠ çš„ `console.log` è¯­å¥

## æ€»ç»“

é—®é¢˜çš„æ ¹æœ¬åŸå› æ˜¯TypeScriptç±»å‹å®šä¹‰ä¸å®Œæ•´ï¼Œå¯¼è‡´æ–°å¢çš„ç¯æ¯”å­—æ®µæ— æ³•æ­£ç¡®ä¼ é€’ã€‚é€šè¿‡æ›´æ–° `StoreWeekOverWeekData` æ¥å£ï¼Œæ·»åŠ ç¼ºå¤±çš„å­—æ®µå®šä¹‰ï¼Œé—®é¢˜å·²è§£å†³ã€‚

å‰ç«¯ç¼–è¯‘æˆåŠŸï¼Œç±»å‹æ£€æŸ¥é€šè¿‡ã€‚åç«¯APIå·²éªŒè¯è¿”å›æ­£ç¡®æ•°æ®ã€‚ç°åœ¨ç¯æ¯”æ•°æ®åº”è¯¥èƒ½å¤Ÿæ­£å¸¸æ˜¾ç¤ºåœ¨è¡¨æ ¼ä¸­ã€‚
