# 🚀 商品场景智能打标 - 快速启动指南

## 📌 3分钟快速上手

### 方式1: 独立分析 (测试/研究)

```bash
# 1. 准备数据
# 确保有订单数据文件(Excel格式)
# 必需字段: 商品名称, 日期/下单时间

# 2. 运行智能打标
python 测试商品智能打标.py

# 3. 查看结果
# - 测试_商品智能打标结果_订单数据.xlsx (打标后的订单)
# - 测试_商品场景画像.xlsx (商品场景画像)

# 4. 运行深度分析
python 分析打标结果.py
```

**预期输出**:
```
✅ 为 1,000 条订单打上 7 个维度标签
✅ 生成 569 个商品的场景画像
✅ 识别 11 种消费场景
✅ 识别 7 种购买驱动
✅ 导出 Excel 分析报告
```

---

### 方式2: 集成到Dash看板

#### Step 1: 导入打标引擎

在 `智能门店看板_Dash版.py` 顶部添加:

```python
from 商品场景智能打标引擎 import ProductSceneTagger
```

#### Step 2: 修改数据加载函数

找到 `load_data_with_cache()` 函数,在数据处理完成后添加:

```python
def load_data_with_cache():
    """加载数据并缓存"""
    global df_global
    
    # ... 原有数据加载逻辑 ...
    
    # ✅ 新增: 商品场景智能打标
    print("\n🎯 执行商品场景智能打标...")
    tagger = ProductSceneTagger()
    df_global = tagger.tag_product_scenes(df_global)
    print(f"   ✅ 打标完成! 添加了 7 个场景维度标签")
    print(f"      - 基础场景: {df_global['场景'].nunique()} 种")
    print(f"      - 季节场景: {df_global['季节场景'].nunique()} 种")
    print(f"      - 购买驱动: {df_global['购买驱动'].nunique()} 种")
    
    return df_global
```

#### Step 3: 在Tab 5中新增子Tab

在 `Tab 5: 时段场景营销分析` 的 `dbc.Tabs` 中添加:

```python
dbc.Tab(label="🏷️ 商品场景画像", tab_id="product-scene-profile", children=[
    html.Div(id='product-scene-profile-content')
])
```

#### Step 4: 添加回调函数

```python
@app.callback(
    Output('product-scene-profile-content', 'children'),
    Input('tab-5-subtabs', 'active_tab')
)
def render_product_scene_profile(active_tab):
    """渲染商品场景画像"""
    if active_tab != 'product-scene-profile' or df_global is None:
        return html.Div()
    
    # 生成商品场景画像
    tagger = ProductSceneTagger()
    product_profiles = tagger.generate_product_scene_profile(df_global)
    
    # 购买驱动分布
    driver_stats = df_global['购买驱动'].value_counts()
    driver_chart = go.Figure(data=[
        go.Bar(x=driver_stats.index, y=driver_stats.values)
    ])
    
    return html.Div([
        dbc.Row([
            dbc.Col([
                dbc.Card([
                    dbc.CardHeader("📊 商品场景适配性排行"),
                    dbc.CardBody([
                        dash_table.DataTable(
                            columns=[
                                {'name': '商品名称', 'id': '商品名称'},
                                {'name': '总订单量', 'id': '总订单量'},
                                {'name': '场景覆盖数', 'id': '场景覆盖数'},
                                {'name': '场景适配度', 'id': '场景适配度'},
                                {'name': '购买驱动', 'id': '购买驱动'}
                            ],
                            data=product_profiles.head(50).to_dict('records'),
                            sort_action='native',
                            filter_action='native',
                            page_size=20,
                            style_table={'overflowX': 'auto'}
                        )
                    ])
                ])
            ], width=12)
        ]),
        
        html.Br(),
        
        dbc.Row([
            dbc.Col([
                dbc.Card([
                    dbc.CardHeader("💡 购买驱动分布"),
                    dbc.CardBody([
                        dcc.Graph(figure=driver_chart)
                    ])
                ])
            ], width=6),
            
            dbc.Col([
                dbc.Card([
                    dbc.CardHeader("🌸 季节场景分布"),
                    dbc.CardBody([
                        dcc.Graph(figure=go.Figure(data=[
                            go.Pie(
                                labels=df_global['季节场景'].value_counts().index,
                                values=df_global['季节场景'].value_counts().values
                            )
                        ]))
                    ])
                ])
            ], width=6)
        ])
    ])
```

#### Step 5: 重启看板

```bash
python 智能门店看板_Dash版.py
```

**预期效果**:
- ✅ 数据加载时自动打标
- ✅ Tab 5 新增"商品场景画像"子Tab
- ✅ 显示商品适配性排行、购买驱动分布等

---

## 🎯 核心功能速查

### 1. 场景维度 (5个)

| 维度 | 示例 | 用途 |
|------|------|------|
| 基础场景 | 早餐/午餐/下午茶/夜宵 | 时段营销 |
| 季节场景 | 春/夏/秋/冬季场景 | 库存优化 |
| 节假日场景 | 春节/双11/周末 | 促销策划 |
| 天气场景 | 晴天/雨天/高温/低温 | 即时推送 |
| 特殊场景 | 开学季/考试季/减肥季 | 精准营销 |

### 2. 购买驱动 (8种)

| 驱动类型 | 营销策略 |
|---------|---------|
| 价格驱动 | 满减活动、限时秒杀 |
| 场景驱动 | 场景推荐、套餐组合 |
| 品质驱动 | 品牌背书、会员专享 |
| 便利驱动 | 极速达、应急套餐 |
| 健康驱动 | 健康标签、营养成分 |
| 社交驱动 | 礼盒包装、社交分享 |
| 尝鲜驱动 | 新品首发、限量销售 |
| 囤货驱动 | 组合优惠、满额包邮 |

### 3. 商品标签 (7个)

```python
# 订单数据新增字段:
- 场景: 基础时段场景
- 季节场景: 季节维度
- 节假日场景: 节假日维度
- 天气场景: 天气维度
- 特殊场景: 特殊时段
- 购买驱动: 主要驱动类型
- 决策因素: 下单决策因素

# 商品画像字段:
- 商品名称
- 总订单量
- 场景覆盖数
- 主要场景
- 主要季节/节假日/天气
- 购买驱动
- 决策因素
- 场景适配度 (0-100%)
```

---

## 💡 实战案例

### Case 1: 下午茶时段推送

**场景**: 14-16点精准推送

```python
# 筛选下午茶场景商品
afternoon_tea = df_global[df_global['场景'] == '下午茶']
top_products = afternoon_tea['商品名称'].value_counts().head(10)

# 推送策略
for product in top_products.index:
    print(f"☕ 推荐: {product}")
    print(f"   话术: 下午茶时光,{product}提提神~")
    print(f"   优惠: 第二件半价")
```

### Case 2: 季节库存优化

**场景**: 根据季节调整库存

```python
# 识别当前季节热销商品
current_season = '秋季场景'
season_products = df_global[df_global['季节场景'] == current_season]
hot_products = season_products.groupby('商品名称').size().nlargest(20)

print(f"🍂 {current_season}热销商品Top 20:")
print(hot_products)

# 库存建议
print("\n📦 库存建议:")
print("  ✓ 增加: 热饮、保湿商品、补品")
print("  ✓ 减少: 冷饮、防晒商品")
print("  ✓ 准备: 冬季保暖商品备货")
```

### Case 3: 驱动定制营销

**场景**: 根据购买驱动定制话术

```python
# 识别价格驱动型商品
price_driven = df_global[df_global['购买驱动'] == '价格驱动']
products = price_driven['商品名称'].unique()[:10]

print("💰 价格驱动型商品营销话术:")
for product in products:
    print(f"  {product}:")
    print(f"    话术: 限时特惠!满99减20,买2送1")
    print(f"    渠道: 满减活动、秒杀专区")
```

---

## 📊 常见问题

### Q1: 打标速度慢怎么办?

**A**: 
- 小数据集(<10000): 实时打标即可
- 大数据集(>10000): 建议后台异步打标,缓存结果
- 超大数据集(>100000): 分批处理,多进程加速

### Q2: 如何提高准确率?

**A**:
1. 完善商品名称 (使用标准化命名)
2. 补充商品分类信息
3. 对重要商品手动校正场景标签
4. 自定义场景关键词规则

### Q3: 可以自定义场景吗?

**A**: 可以! 在 `SceneDimensions` 类中修改:

```python
SEASON_SCENES = {
    '自定义季节': {
        '时间范围': 'X-Y月',
        '商品关键词': ['关键词1', '关键词2'],
        '特点': '场景描述'
    }
}
```

### Q4: 如何集成到现有系统?

**A**: 3种方式:
1. 独立使用: 定期运行,导出Excel
2. 函数调用: 在代码中调用 `smart_tag_products(df)`
3. 完整集成: 集成到Dash看板数据流

---

## 🎁 额外资源

### 文件清单

```
核心引擎:
├─ 商品场景智能打标引擎.py (750行核心代码)
├─ scene_inference.py (原有场景推断模块)
└─ 智能门店看板_Dash版.py (Dash看板主程序)

测试脚本:
├─ 测试商品智能打标.py (真实数据测试)
└─ 分析打标结果.py (深度分析)

文档指南:
├─ 商品场景智能打标_集成指南.md (完整文档)
├─ 商品场景智能打标_测试验证报告.md (测试报告)
└─ 商品场景智能打标_快速启动指南.md (本文档)

输出文件:
├─ 测试_商品智能打标结果_订单数据.xlsx
└─ 测试_商品场景画像.xlsx
```

### 代码示例

**最小可用示例**:
```python
from 商品场景智能打标引擎 import smart_tag_products
import pandas as pd

df = pd.read_excel('订单数据.xlsx')
tagged_df, profiles = smart_tag_products(df)
print(profiles.head(20))
```

**完整示例**:
```python
from 商品场景智能打标引擎 import ProductSceneTagger, SceneMarketingAdvisor

# 1. 初始化
tagger = ProductSceneTagger()
advisor = SceneMarketingAdvisor()

# 2. 加载数据
df = pd.read_excel('订单数据.xlsx')

# 3. 打标
tagged_df = tagger.tag_product_scenes(df)

# 4. 生成画像
profiles = tagger.generate_product_scene_profile(tagged_df)

# 5. 生成建议
advice = profiles.apply(advisor.generate_marketing_advice, axis=1)

# 6. 导出
tagged_df.to_excel('打标结果.xlsx', index=False)
profiles.to_excel('商品画像.xlsx', index=False)
```

---

## ✅ 检查清单

使用前请确认:

- [ ] 已安装所需Python包 (pandas, numpy)
- [ ] 订单数据包含必需字段 (商品名称, 日期)
- [ ] 数据格式正确 (Excel或CSV)
- [ ] 已阅读集成指南
- [ ] 已运行测试脚本验证

集成到Dash前请确认:

- [ ] Dash看板正常运行
- [ ] 已备份 `智能门店看板_Dash版.py`
- [ ] 已测试打标引擎
- [ ] 已规划新增Tab结构
- [ ] 已设计回调函数

---

## 🚀 立即开始

### 步骤1: 运行测试 (已完成✅)

```bash
python 测试商品智能打标.py
```

### 步骤2: 查看结果

打开生成的Excel文件:
- `测试_商品智能打标结果_订单数据.xlsx`
- `测试_商品场景画像.xlsx`

### 步骤3: 深度分析

```bash
python 分析打标结果.py
```

### 步骤4: 集成到看板

按照上面"方式2"的步骤集成到Dash看板

### 步骤5: 实际应用

根据场景画像,实施:
- 时段精准推送
- 驱动定制营销
- 季节库存优化
- 商品组合推荐

---

**开发者**: AI Assistant  
**版本**: 1.0.0  
**更新时间**: 2025-10-26

🎉 **祝使用愉快!如有问题,请参考集成指南或测试验证报告。**
