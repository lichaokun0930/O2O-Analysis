# Tab 4 问题诊断 - 快速测试指南

## 🚀 开始测试

### 1. 确认应用已启动
```powershell
# 检查端口
netstat -ano | findstr :8050

# 如果未启动，运行：
python 智能门店看板_Dash版.py
```

### 2. 打开浏览器
访问: **http://localhost:8050**

---

## ✅ 快速测试步骤（5分钟）

### 第1步: 找到"问题诊断"Tab
在顶部找到并点击 **"问题诊断"** Tab（或类似的Tab）

### 第2步: 测试Tab 4.1 销量下滑诊断
1. ✅ 点击 **Tab 4.1: 销量下滑诊断**
2. ✅ 看到10个图表区域（饼图、柱状图、瀑布图等）
3. ✅ 点击 **"开始诊断"** 按钮
4. ✅ 查看是否有数据显示或提示信息
5. ✅ 尝试滚动页面，查看所有图表
6. ✅ 鼠标悬停在图表上，检查工具栏是否出现
7. ✅ 点击 **"导出Excel"** 按钮（如果有数据）

**预期结果**: 
- 所有图表正常显示
- 工具栏可用（缩放、平移、下载PNG）
- Excel导出成功（4个Sheet）

---

### 第3步: 测试Tab 4.2 客单价归因
1. ✅ 点击 **Tab 4.2: 客单价归因**
2. ✅ 点击 **"展开/收起"** 按钮，查看说明卡片
3. ✅ 选择 **分析粒度**: 按周分析
4. ✅ 调整 **客单价下滑阈值**: -5%
5. ✅ 选择 **分析模式**: 批量分析
6. ✅ 点击 **"开始归因"** 按钮
7. ✅ 查看三个子Tab的数据表格：
   - 📊 客单价变化
   - 📉 下滑商品分析
   - 📈 上涨商品分析
8. ✅ 点击 **"导出Excel"** 和 **"导出CSV"** 按钮

**预期结果**:
- 说明卡片可正常展开/收起
- 数据表格显示（有模拟数据）
- Excel包含3个Sheet
- CSV文件中文正常

---

### 第4步: 测试Tab 4.3 负毛利预警
1. ✅ 点击 **Tab 4.3: 负毛利预警**
2. ✅ 点击 **"立即检测"** 按钮
3. ✅ 查看结果提示和数据表格
4. ✅ 测试表格的排序和筛选功能
5. ✅ 点击 **"导出CSV"** 按钮

**预期结果**:
- 显示负毛利商品列表或"未发现负毛利商品"提示
- 表格条件格式正确（红色/橙色高亮）
- CSV导出成功

---

### 第5步: 测试Tab 4.4 高配送费诊断
1. ✅ 点击 **Tab 4.4: 高配送费诊断**
2. ✅ 拖动 **配送费占比阈值** 滑块（10%-50%）
3. ✅ 点击 **"开始诊断"** 按钮
4. ✅ 查看数据表格
5. ✅ 点击 **"导出CSV"** 按钮

**预期结果**:
- 滑块可正常拖动，值实时显示
- 显示高配送费地址列表或"无异常订单"提示
- CSV导出成功

---

### 第6步: 测试Tab 4.5 角色失衡诊断
1. ✅ 点击 **Tab 4.5: 角色失衡诊断**
2. ✅ 点击 **"开始检测"** 按钮
3. ✅ 查看数据表格
4. ✅ 点击 **"导出CSV"** 按钮

**预期结果**:
- 显示场景角色失衡列表或"角色配比合理"提示
- CSV导出成功

---

### 第7步: 测试Tab 4.6 异常波动预警
1. ✅ 点击 **Tab 4.6: 异常波动预警**
2. ✅ 拖动 **波动阈值** 滑块（30%-100%）
3. ✅ 点击 **"开始预警"** 按钮
4. ✅ 查看数据表格（爆单/滞销高亮）
5. ✅ 点击 **"导出CSV"** 按钮

**预期结果**:
- 滑块可正常拖动
- 显示异常波动商品列表或"未发现异常"提示
- 表格条件格式正确（绿色/红色高亮）
- CSV导出成功

---

## 🎯 关键检查点

### UI显示
- [ ] 所有Tab标签正常显示
- [ ] Emoji图标正常显示（🚨🚚⚖️📊等）
- [ ] 中文字符无乱码
- [ ] 卡片布局整齐
- [ ] 按钮样式统一

### 交互功能
- [ ] Tab切换无页面跳转（这是核心！）
- [ ] 按钮点击响应快速
- [ ] 滑块拖动流畅
- [ ] 表格排序正常
- [ ] 表格筛选正常
- [ ] 表格分页正常

### 数据展示
- [ ] 图表正常显示（Tab 4.1）
- [ ] 数据表格正常显示（Tab 4.2-4.6）
- [ ] 条件格式高亮正确
- [ ] 统计信息准确

### 导出功能
- [ ] Excel导出成功（Tab 4.1, 4.2）
- [ ] CSV导出成功（Tab 4.2-4.6）
- [ ] 文件名包含时间戳
- [ ] 中文编码正确（Excel可打开）

---

## ⚠️ 常见问题排查

### 问题1: 页面显示空白
**原因**: 应用未启动或端口被占用  
**解决**: 重新启动应用或更换端口

### 问题2: 点击按钮无反应
**原因**: 可能是诊断引擎未加载或方法不存在  
**解决**: 查看浏览器控制台（F12）和Python终端的错误信息

### 问题3: 图表不显示
**原因**: Plotly库加载失败或数据为空  
**解决**: 检查网络连接，确认数据已加载

### 问题4: CSV导出中文乱码
**原因**: 编码问题  
**解决**: 已使用UTF-8 BOM编码，用Excel 2016+打开应正常

### 问题5: Tab切换后页面跳转
**原因**: 这不应该发生（这是迁移Dash的主要原因）  
**解决**: 如果发生，需要检查代码，可能是某个链接或表单提交导致

---

## 📊 测试数据说明

### 真实数据 vs 模拟数据

如果诊断引擎返回空数据，系统会自动生成**模拟数据**用于演示：

**Tab 4.1**: 模拟下滑商品数据（约50条）  
**Tab 4.2**: 模拟客单价变化数据（3个周期对比）  
**Tab 4.3-4.6**: 取决于诊断引擎实现

这是正常的！主要测试**UI和交互功能**是否正常。

---

## ✅ 测试通过标准

### 最低标准（可发布）
- ✅ 所有Tab可以切换，无页面跳转
- ✅ 所有按钮可以点击
- ✅ 所有参数可以调整
- ✅ 数据表格可以正常显示（即使是模拟数据）
- ✅ 导出功能可以正常工作
- ✅ 无明显的UI错误或崩溃

### 推荐标准（完美体验）
- ✅ 所有功能流畅无卡顿
- ✅ 图表加载快速（< 2秒）
- ✅ 工具栏交互自然
- ✅ 错误提示友好明确
- ✅ 响应式设计完美适配
- ✅ 真实数据可正常加载和分析

---

## 📝 测试反馈模板

```
测试时间: 2025-10-17
测试人员: ______
浏览器: Edge/Chrome/Firefox
测试环境: Windows + Python 3.13

【通过的功能】
✅ Tab切换流畅无跳转
✅ Tab 4.1 图表显示正常
✅ Tab 4.2 数据表格正常
✅ ...

【发现的问题】
❌ Tab 4.3 点击按钮无反应
❌ Tab 4.5 表格数据为空
❌ ...

【整体评价】
□ 完美，可以发布
□ 良好，修复小问题后可发布
□ 一般，需要修复主要问题
□ 较差，需要大量修改

【建议】
1. 
2. 
3. 
```

---

## 🎉 测试完成后

### 如果测试通过
1. ✅ 填写测试报告
2. ✅ 标记为"可发布"
3. ✅ 继续开发其他Tab（Tab 1-3, 5-6）

### 如果发现问题
1. 📝 记录详细的问题描述
2. 🐛 创建问题清单
3. 🔧 优先修复高优先级问题
4. 🧪 修复后重新测试

---

**预计测试时间**: 5-10分钟（快速测试）  
**完整测试时间**: 30-60分钟（详细测试）

**测试目标**: 验证Tab 4模块100%可用！🚀
